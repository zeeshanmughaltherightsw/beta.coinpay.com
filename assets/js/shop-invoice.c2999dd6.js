(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["shop-invoice"],{de56:function(e,t,o){"use strict";o.r(t);o("99af"),o("b64b"),o("b0c0");var n=o("f2bf"),c={class:"text-center mb-3"},r={class:"font-bold"},a={class:"font-bold"},i={class:"w-full lg:w-3/5 mx-auto"},l={class:"mb-4"},s={class:"text-3xl font-bold text-blue-500 text-center"},d=["href"],b=Object(n["createElementVNode"])("span",{class:"mr-2"},"Click to Redirect",-1),m={key:0},p={class:"mt-4"},u={class:"flex justify-center flex-wrap items-stretch w-full mb-4 relative"},O={class:"flex -mr-px"},j={class:"mb-4"},v={class:"text-3xl font-bold text-blue-500 text-center"},f=["href"],h=Object(n["createElementVNode"])("span",{class:"mr-2"},"Click to Redirect",-1),g={key:0},N={class:"mt-4"},k={key:0,class:"text-center mb-3"},y={class:"flex justify-center flex-wrap items-stretch w-full mb-4 relative"},V={class:"flex -mr-px"},E={class:"mb-4"},x={class:"text-3xl font-bold text-blue-500 text-center"},C=["href"],w=Object(n["createElementVNode"])("span",{class:"mr-2"},"Click to Redirect",-1),q={key:0},B={class:"text-center"},S={key:0,class:"card mt-4"},T={class:"body"},D={class:"scrollbar scrollbar-thin scrollbar-thumb-gray-400 scrollbar-track-gray-200 dark:scrollbar-track-gray-900 dark:scrollbar-thumb-gray-600"},I={class:"table-sm mb-2"},R=Object(n["createElementVNode"])("th",null,"Item",-1),L={key:0},P=Object(n["createElementVNode"])("th",null,"Price",-1),A=Object(n["createElementVNode"])("th",null,"Quantity",-1),_=Object(n["createElementVNode"])("th",null,"Subtotal",-1),M={class:"flex items-center"},U=["src","onClick"],K={key:0},z={key:0},Q=["colspan"],F={colspan:"1"},H={key:1},J=["colspan"],Z={class:"text-red-500"},W={colspan:"1"},G={class:"text-red-500"},X=["colspan"],Y=Object(n["createElementVNode"])("span",{class:"font-bold"},"Total:",-1),$=[Y],ee={colspan:"1"},te={class:"font-bold"},oe={class:"text-center"},ne=Object(n["createTextVNode"])("Invoice Page ");function ce(e,t,o,Y,ce,re){var ae=Object(n["resolveComponent"])("icon"),ie=Object(n["resolveComponent"])("QRCodeVue3"),le=Object(n["resolveComponent"])("Tab"),se=Object(n["resolveComponent"])("TabSet"),de=Object(n["resolveComponent"])("router-link"),be=Object(n["resolveComponent"])("centered-layout");return Object(n["openBlock"])(),Object(n["createBlock"])(be,null,{default:Object(n["withCtx"])((function(){return[e.invoice&&!Y.isInvoiceComplete?(Object(n["openBlock"])(),Object(n["createElementBlock"])(n["Fragment"],{key:0},[Object(n["createElementVNode"])("div",c,[Object(n["createElementVNode"])("p",null,Object(n["toDisplayString"])(Y.translate("pos.invoice.message")),1),Object(n["createElementVNode"])("p",null,[Object(n["createElementVNode"])("span",r,Object(n["toDisplayString"])(Y.translate("pos.invoice.merchant")),1),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.invoice.ShopTitle),1)]),Object(n["createElementVNode"])("p",null,[Object(n["createElementVNode"])("span",a,Object(n["toDisplayString"])(Y.translate("pos.invoice.invoice_number")),1),Object(n["createTextVNode"])("  "+Object(n["toDisplayString"])(e.invoice.TransactionID),1)])]),Object(n["createElementVNode"])("div",i,[Object(n["createVNode"])(se,null,{default:Object(n["withCtx"])((function(){return[Object(n["createVNode"])(le,{name:Y.translate("invoice.address_only")},{default:Object(n["withCtx"])((function(){return[Object(n["createElementVNode"])("div",l,[Object(n["createElementVNode"])("p",s,Object(n["toDisplayString"])(e.timer),1),Y.isPaid?(Object(n["openBlock"])(),Object(n["createElementBlock"])("a",{key:0,href:e.invoice.RedirectTargetURL,class:"mt-3 text-blue-500 hover:underline inline-flex items-center"},[b,Object(n["createVNode"])(ae,{name:"arrow-right",classes:"w-5 h-5"})],8,d)):Object(n["createCommentVNode"])("",!0)]),Y.isPaid||Y.isExpired?Object(n["createCommentVNode"])("",!0):(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",m,[Object(n["createVNode"])(ie,{imgclass:"mx-auto",width:Y.qrOptions.width,height:Y.qrOptions.height,"qr-options":Y.qrOptions.qrOptions,"background-options":Y.qrOptions.backgroundOptions,"dots-options":Y.qrOptions.dotsOptions,"corners-dot-options":Y.qrOptions.cornersDotOptions,"corners-square-options":Y.qrOptions.cornersSquareOptions,value:e.invoice.coinAddress},null,8,["width","height","qr-options","background-options","dots-options","corners-dot-options","corners-square-options","value"]),Object(n["createElementVNode"])("div",p,[Object(n["createElementVNode"])("div",u,[Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=function(t){return e.invoice.coinAddress=t}),readonly:"",class:"form-input w-2/3 rounded-r-none"},null,512),[[n["vModelText"],e.invoice.coinAddress]]),Object(n["createElementVNode"])("div",O,[Object(n["createElementVNode"])("span",{onClick:t[1]||(t[1]=function(t){return Y.copyToClipboard(e.invoice.coinAddress)}),class:"hover:bg-gray-200 dark:hover:bg-gray-700 cursor-pointer flex items-center leading-normal rounded rounded-l-none border border-l-0 border-gray-300 dark:border-gray-600 px-3 whitespace-no-wrap text-sm"},[Object(n["createVNode"])(ae,{name:"clipboard",classes:"w-5 h-5"})])])])])]))]})),_:1},8,["name"]),Object(n["createVNode"])(le,{name:Y.translate("invoice.full_crypto_link"),selected:!0},{default:Object(n["withCtx"])((function(){return[Object(n["createElementVNode"])("div",j,[Object(n["createElementVNode"])("p",v,Object(n["toDisplayString"])(e.timer),1),Y.isPaid?(Object(n["openBlock"])(),Object(n["createElementBlock"])("a",{key:0,href:e.invoice.RedirectTargetURL,class:"mt-3 text-blue-500 hover:underline inline-flex items-center"},[h,Object(n["createVNode"])(ae,{name:"arrow-right",classes:"w-5 h-5"})],8,f)):Object(n["createCommentVNode"])("",!0)]),Y.isPaid||Y.isExpired?Object(n["createCommentVNode"])("",!0):(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",g,[Object(n["createVNode"])(ie,{imgclass:"mx-auto",width:Y.qrOptions.width,height:Y.qrOptions.height,"qr-options":Y.qrOptions.qrOptions,"background-options":Y.qrOptions.backgroundOptions,"dots-options":Y.qrOptions.dotsOptions,"corners-dot-options":Y.qrOptions.cornersDotOptions,"corners-square-options":Y.qrOptions.cornersSquareOptions,value:Y.qrLink},null,8,["width","height","qr-options","background-options","dots-options","corners-dot-options","corners-square-options","value"]),Object(n["createElementVNode"])("div",N,[e.invoice.Tag?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",k,"Memo/Tag: "+Object(n["toDisplayString"])(e.invoice.Tag),1)):Object(n["createCommentVNode"])("",!0),Object(n["createElementVNode"])("div",y,[Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=function(t){return e.invoice.coinAddress=t}),readonly:"",class:"form-input w-2/3 rounded-r-none"},null,512),[[n["vModelText"],e.invoice.coinAddress]]),Object(n["createElementVNode"])("div",V,[Object(n["createElementVNode"])("span",{onClick:t[3]||(t[3]=function(t){return Y.copyToClipboard(e.invoice.coinAddress)}),class:"hover:bg-gray-200 dark:hover:bg-gray-700 cursor-pointer flex items-center leading-normal rounded rounded-l-none border border-l-0 border-gray-300 dark:border-gray-600 px-3 whitespace-no-wrap text-sm"},[Object(n["createVNode"])(ae,{name:"clipboard",classes:"w-5 h-5"})])])])])]))]})),_:1},8,["name"]),Object(n["createVNode"])(le,{name:Y.translate("invoice.tzero")},{default:Object(n["withCtx"])((function(){return[Object(n["createElementVNode"])("div",E,[Object(n["createElementVNode"])("p",x,Object(n["toDisplayString"])(e.timer),1),Y.isPaid?(Object(n["openBlock"])(),Object(n["createElementBlock"])("a",{key:0,href:e.invoice.RedirectTargetURL,class:"mt-3 text-blue-500 hover:underline inline-flex items-center"},[w,Object(n["createVNode"])(ae,{name:"arrow-right",classes:"w-5 h-5"})],8,C)):Object(n["createCommentVNode"])("",!0)]),Y.isPaid||Y.isExpired?Object(n["createCommentVNode"])("",!0):(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",q,[Object(n["createVNode"])(ie,{imgclass:"mx-auto",width:Y.qrOptions.width,height:Y.qrOptions.height,"qr-options":Y.qrOptions.qrOptions,"background-options":Y.qrOptions.backgroundOptions,"dots-options":Y.qrOptions.dotsOptions,"corners-dot-options":Y.qrOptions.cornersDotOptions,"corners-square-options":Y.qrOptions.cornersSquareOptions,value:e.invoice.TZERO},null,8,["width","height","qr-options","background-options","dots-options","corners-dot-options","corners-square-options","value"])]))]})),_:1},8,["name"])]})),_:1}),Object(n["createElementVNode"])("p",B,Object(n["toDisplayString"])("".concat(Y.translate("pos.invoice.amount"),": ").concat(e.invoice.Amount," ").concat(e.invoice.LongName)),1),e.order.items.length>0?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",S,[Object(n["createElementVNode"])("div",T,[Object(n["createElementVNode"])("div",D,[Object(n["createElementVNode"])("table",I,[Object(n["createElementVNode"])("thead",null,[Object(n["createElementVNode"])("tr",null,[R,6===Object.keys(e.order.items[0]).length?(Object(n["openBlock"])(),Object(n["createElementBlock"])("th",L,"SKU")):Object(n["createCommentVNode"])("",!0),P,A,_])]),Object(n["createElementVNode"])("tbody",null,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.order.items,(function(t,o){return Object(n["openBlock"])(),Object(n["createElementBlock"])("tr",{key:o},[Object(n["createElementVNode"])("td",null,[Object(n["createElementVNode"])("div",M,[t.url?(Object(n["openBlock"])(),Object(n["createElementBlock"])("img",{key:0,src:t.url,alt:"",class:"w-12 h-12 rounded-full overflow-hidden mr-2 cursor-pointer",onClick:function(e){return Y.fancyBox(t.url)}},null,8,U)):Object(n["createCommentVNode"])("",!0),Object(n["createElementVNode"])("p",null,Object(n["toDisplayString"])(t.name),1)])]),6===Object.keys(e.order.items[0]).length?(Object(n["openBlock"])(),Object(n["createElementBlock"])("td",K,Object(n["toDisplayString"])(t.sku),1)):Object(n["createCommentVNode"])("",!0),Object(n["createElementVNode"])("td",null,Object(n["toDisplayString"])(Y.formatPrice(t.price,Y.currency)),1),Object(n["createElementVNode"])("td",null,Object(n["toDisplayString"])("x "+t.qty),1),Object(n["createElementVNode"])("td",null,Object(n["toDisplayString"])(Y.formatPrice(t.price*t.qty,Y.currency)),1)])})),128)),e.order.shipping?(Object(n["openBlock"])(),Object(n["createElementBlock"])("tr",z,[Object(n["createElementVNode"])("td",{colspan:6===Object.keys(e.order.items[0]).length?4:3,class:"text-right"},Object(n["toDisplayString"])(Y.translate("invoice.shipping_cost"))+": ",9,Q),Object(n["createElementVNode"])("td",F,Object(n["toDisplayString"])(e.order.shipping.method+" "+Y.formatPrice(e.order.shipping.cost,Y.currency)),1)])):Object(n["createCommentVNode"])("",!0),e.order.coupon?(Object(n["openBlock"])(),Object(n["createElementBlock"])("tr",H,[Object(n["createElementVNode"])("td",{colspan:6===Object.keys(e.order.items[0]).length?4:3,class:"text-right"},[Object(n["createElementVNode"])("span",Z,Object(n["toDisplayString"])(Y.translate("invoice.discount"))+":",1)],8,J),Object(n["createElementVNode"])("td",W,[Object(n["createElementVNode"])("span",G,"-"+Object(n["toDisplayString"])(Y.formatPrice(e.order.coupon.discount,Y.currency)),1)])])):Object(n["createCommentVNode"])("",!0),Object(n["createElementVNode"])("tr",null,[Object(n["createElementVNode"])("td",{colspan:6===Object.keys(e.order.items[0]).length?4:3,class:"text-right"},$,8,X),Object(n["createElementVNode"])("td",ee,[Object(n["createElementVNode"])("span",te,Object(n["toDisplayString"])(Y.cartTotal),1)])])])])])])])):Object(n["createCommentVNode"])("",!0),Object(n["createElementVNode"])("div",oe,[Object(n["createVNode"])(de,{to:{name:"invoice",params:{confirmCode:e.invoice.Security}},tag:"a",class:"btn btn-primary"},{default:Object(n["withCtx"])((function(){return[ne]})),_:1},8,["to"])])])],64)):Object(n["createCommentVNode"])("",!0)]})),_:1})}var re=o("5530"),ae=(o("d81d"),o("a9e3"),o("498a"),o("4de4"),o("d3b7"),o("ac1f"),o("1276"),o("9e55")),ie=o("cdae"),le=o("6c02"),se=o("5502"),de=o("8923"),be=o("bad0"),me=o("f51a"),pe=o("61c6"),ue=o.n(pe),Oe=o("3fbe"),je=o("2e13"),ve=o("2ef0"),fe=o("1d5e"),he={name:"ShopInvoice",components:{CenteredLayout:ae["a"],TabSet:be["a"],Tab:me["a"],Icon:ie["a"],QRCodeVue3:ue.a},setup:function(){var e=Object(n["inject"])("translate"),t=Object(n["inject"])("http"),o=Object(le["d"])(),c=Object(le["e"])(),r=Object(se["b"])(),a=Object(Oe["a"])(),i=a.qrOptions,l=Object(je["a"])(),s=l.copyToClipboard,d=l.formatPrice,b=l.fancyBox,m=Object(n["reactive"])({confirmCode:null,invoice:null,order:{items:[],shipping:null,coupon:null},interval:null,transactionInterval:null,timer:null,loader:"",socket:null,isClosedSocket:!1}),p=Object(n["computed"])((function(){return!!m.invoice&&-1!==["paid","underpaid","complete"].indexOf(m.invoice.Status.toLowerCase())})),u=Object(n["computed"])((function(){return m.invoice&&("paid"===m.invoice.Status.toLowerCase()||"underpaid"===m.invoice.Status.toLowerCase())})),O=Object(n["computed"])((function(){return m.invoice&&"expired"===m.invoice.Status.toLowerCase()})),j=Object(n["computed"])((function(){return m.invoice.CoinName.toLowerCase()+":"+m.invoice.coinAddress+"?amount="+m.invoice.Amount})),v=Object(n["computed"])((function(){return m.invoice?m.invoice.inputCurrency:"EUR"})),f=Object(n["computed"])((function(){var e=0;return m.order.items.length>0&&m.order.items.map((function(t){e+=Number(t.qty)*Number(t.price)})),m.order.shipping&&(e+=Number(m.order.shipping.cost)),m.order.coupon&&(e-=Number(m.order.coupon.discount)),d(e,v.value)})),h="https://app.cointopay.com",g=function(e){var t=decodeURIComponent(e.CustomerReferenceNr),o=document.createElement("div");o.innerHTML=t;var n=o.innerHTML.trim();m.order={items:[],shipping:null,coupon:null},n&&(n=n.split(":::").filter(Boolean),n.map((function(e){e=e.split("|").filter(Boolean),6===e.length?m.order.items.push({id:e[0],sku:e[1],name:e[2],url:e[3],price:Number(e[4]),qty:Number(e[5])}):5===e.length?m.order.items.push({id:e[0],name:e[1],url:e[2],price:Number(e[3]),qty:Number(e[4])}):2===e.length?m.order.shipping={method:e[0],cost:e[1]}:3===e.length&&(m.order.coupon={code:e[0],value:e[1],discount:e[2]})})))},N=function(e){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"main";m.loader=o;var n={Call:"Transactiondetail",MerchantID:0,APIKey:"_",ConfirmCode:e,output:"json"};t.get("".concat(h,"/v2REAPI"),{params:n}).then((function(e){if(m.loader="",200===e.status&&"failed"!==e.data.result){m.invoice=e.data.data,g(m.invoice),r.commit(de["K"],m.invoice);var t=m.invoice.Status.toLowerCase();-1!==["paid","underpaid","expired"].indexOf(t)&&(m.timer=m.invoice.Status,m.transactionInterval&&clearInterval(m.transactionInterval),m.interval&&(clearInterval(m.interval),m.timer=t)),-1!==["waiting","awaiting-fiat"].indexOf(t)&&y()}})).catch((function(e){m.loader="",console.log(e)}))},k=function(){if(Object.keys(o.params).length>0){var e=o.params.confirmCode;N(e),m.transactionInterval&&clearInterval(m.transactionInterval),m.transactionInterval=setInterval((function(){N(e,!1)}),6e4)}else c.push({name:"shop"})},y=function(){if(!m.timer){var e=fe.tz(m.invoice.CreatedOn,"Europe/Amsterdam").add(Number(m.invoice.ExpiryTime),"minutes");m.interval=setInterval((function(){var t=fe().tz("Europe/Amsterdam").valueOf(),o=e.valueOf()-t,n=Math.floor(o/864e5),c=Math.floor(o%864e5/36e5),r=Math.floor(o%36e5/6e4),a=Math.floor(o%6e4/1e3);m.timer="".concat(n,"d ").concat(c,"h ").concat(r,"m ").concat(a,"s"),o<0&&(clearInterval(m.interval),m.timer="Expired",N(m.invoice.ConfirmCode,""))}),1e3)}},V=function e(){m.socket=new WebSocket("wss://wss.cointopay.com/transactions"),m.socket.onmessage=function(e){if(e&&e.data){var t=e.data.split(":");if(m.invoice){var o=ve["cloneDeep"](m.invoice);"TZERO"===t[0]&&o&&Number(o.TransactionID)===Number(t[1])&&(m.interval&&clearInterval(m.interval),o.Status=t[2].toLowerCase(),r.commit(de["K"],o))}}},m.socket.onclose=function(t){m.isClosedSocket||e()}};return Object(n["onBeforeMount"])((function(){k(),V()})),Object(n["onBeforeUnmount"])((function(){m.transactionInterval&&clearInterval(m.transactionInterval),m.interval&&clearInterval(m.interval),null!==m.socket&&(m.isClosedSocket=!0,m.socket.close())})),Object(re["a"])(Object(re["a"])({translate:e},Object(n["toRefs"])(m)),{},{currency:v,isInvoiceComplete:p,copyToClipboard:s,qrOptions:i,isPaid:u,isExpired:O,qrLink:j,formatPrice:d,cartTotal:f,fancyBox:b})}},ge=o("6b0d"),Ne=o.n(ge);const ke=Ne()(he,[["render",ce]]);t["default"]=ke}}]);
//# sourceMappingURL=shop-invoice.c2999dd6.js.map