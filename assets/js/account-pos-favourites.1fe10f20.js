(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["account-pos-favourites"],{"63bf":function(e,t,c){"use strict";c("bf53")},a926:function(e,t,c){"use strict";c.r(t);var o=c("f2bf");const a=e=>(Object(o["pushScopeId"])("data-v-231d94e3"),e=e(),Object(o["popScopeId"])(),e),r={class:"card"},l=a(()=>Object(o["createElementVNode"])("hr",{class:"border-gray-300 dark:border-gray-600"},null,-1)),n={class:"body"},s={class:"flex items-center justify-end mb-3 flex-col lg:flex-row"},d=a(()=>Object(o["createElementVNode"])("option",{value:""},"Select Category",-1)),i=["value"],u={class:"relative mb-3 lg:mb-0 ml-0 lg:ml-3 w-full lg:w-auto"},m={key:0,class:"mx-auto mb-3 w-40"},b={class:"w-full scrollbar scrollbar-thin scrollbar-thumb-gray-400 scrollbar-track-gray-200 dark:scrollbar-track-gray-900 dark:scrollbar-thumb-gray-600"},j={class:"table-sm mb-2"},O=a(()=>Object(o["createElementVNode"])("th",null,"Category",-1)),p=a(()=>Object(o["createElementVNode"])("th",null,"Image",-1)),y={class:"flex items-center"},g=a(()=>Object(o["createElementVNode"])("th",{class:"whitespace-nowrap"},"SKU / EAN / Barcode / QR",-1)),k=a(()=>Object(o["createElementVNode"])("th",null,"Quantity",-1)),f={class:"flex items-center"},v=a(()=>Object(o["createElementVNode"])("th",null,"Actions",-1)),N=["onClick"],C={class:"w-12 h-12 rounded-full overflow-hidden"},V=["src","onClick"],h=["onClick"],E={class:"break-all"},w=["onClick"],B=["onClick"],x=["onClick"],I={class:"flex items-center space-x-1"},S=["onClick"],D=["onClick"],P={key:1},F={colspan:"7",class:"text-center"};function M(e,t,c,a,M,T){const L=Object(o["resolveComponent"])("nav-tabs"),A=Object(o["resolveComponent"])("icon"),K=Object(o["resolveComponent"])("StreamBarcodeReader"),U=Object(o["resolveComponent"])("pagination"),_=Object(o["resolveComponent"])("pos-layout"),R=Object(o["resolveComponent"])("add-to-cart-modal");return Object(o["openBlock"])(),Object(o["createElementBlock"])(o["Fragment"],null,[Object(o["createVNode"])(_,null,{content:Object(o["withCtx"])(()=>[Object(o["createElementVNode"])("div",r,[Object(o["createVNode"])(L),l,Object(o["createElementVNode"])("div",n,[Object(o["createElementVNode"])("div",s,[Object(o["createElementVNode"])("span",{class:"hover:text-blue-500 mb-3 lg:mb-0 ml-0 lg:ml-3 cursor-pointer w-full lg:w-auto",onClick:t[0]||(t[0]=t=>e.isBarcodeScanner=!e.isBarcodeScanner)},[Object(o["createVNode"])(A,{name:"barcode"})]),Object(o["withDirectives"])(Object(o["createElementVNode"])("select",{"aria-label":"Select Category",class:"form-select w-full mb-3 lg:mb-0 ml-0 lg:ml-3 w-full lg:w-72","onUpdate:modelValue":t[1]||(t[1]=t=>e.categoryId=t)},[d,(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(a.categories,(e,t)=>(Object(o["openBlock"])(),Object(o["createElementBlock"])("option",{key:t,value:e.id},Object(o["toDisplayString"])(e.name),9,i))),128))],512),[[o["vModelSelect"],e.categoryId]]),Object(o["createElementVNode"])("div",u,[Object(o["createVNode"])(A,{classes:"absolute w-5 h-5 top-3 left-3 dark:text-gray-300",name:"search"}),Object(o["withDirectives"])(Object(o["createElementVNode"])("input",{"onUpdate:modelValue":t[2]||(t[2]=t=>e.keyword=t),"aria-label":"Search...",class:"form-input px-10 w-full lg:w-auto",type:"text"},null,512),[[o["vModelText"],e.keyword]]),""!==e.keyword?(Object(o["openBlock"])(),Object(o["createElementBlock"])("span",{key:0,class:"absolute top-3 right-3 dark:text-gray-400 cursor-pointer",onClick:t[3]||(t[3]=t=>e.keyword="")},[Object(o["createVNode"])(A,{classes:"w-5 h-5",name:"close"})])):Object(o["createCommentVNode"])("",!0)])]),e.isBarcodeScanner?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",m,[Object(o["createVNode"])(K,{onDecode:a.onDecode,onError:a.onError},null,8,["onDecode","onError"])])):Object(o["createCommentVNode"])("",!0),Object(o["createElementVNode"])("div",b,[Object(o["createElementVNode"])("table",j,[Object(o["createElementVNode"])("thead",null,[Object(o["createElementVNode"])("tr",null,[O,p,Object(o["createElementVNode"])("th",{onClick:t[4]||(t[4]=e=>a.sort("itemName")),class:"cursor-pointer",style:{"max-width":"150px"}},[Object(o["createElementVNode"])("div",y,[Object(o["createTextVNode"])(" Name "),"itemName"===e.sortKey?(Object(o["openBlock"])(),Object(o["createElementBlock"])("span",{key:0,class:Object(o["normalizeClass"])("ml-4 transform transition-all "+("asc"===e.order?"rotate-180":""))},[Object(o["createVNode"])(A,{name:"sort",classes:"w-4 h-4"})],2)):Object(o["createCommentVNode"])("",!0)])]),g,k,Object(o["createElementVNode"])("th",{onClick:t[5]||(t[5]=e=>a.sort("price")),class:"cursor-pointer"},[Object(o["createElementVNode"])("div",f,[Object(o["createTextVNode"])(" Price "),"price"===e.sortKey?(Object(o["openBlock"])(),Object(o["createElementBlock"])("span",{key:0,class:Object(o["normalizeClass"])("ml-4 transform transition-all "+("asc"===e.order?"rotate-180":""))},[Object(o["createVNode"])(A,{name:"sort",classes:"w-4 h-4"})],2)):Object(o["createCommentVNode"])("",!0)])]),v])]),Object(o["createElementVNode"])("tbody",null,[a.filteredFavourites.length>0?(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],{key:0},Object(o["renderList"])(a.paginatedFavourites,(t,c)=>(Object(o["openBlock"])(),Object(o["createElementBlock"])("tr",{key:c},[Object(o["createElementVNode"])("td",null,[Object(o["createElementVNode"])("div",{onClick:c=>e.categoryId=t.categoryID,class:"cursor-pointer flex items-center"},[Object(o["createElementVNode"])("div",{style:Object(o["normalizeStyle"])("background: #"+a.getCategoryColorCode(t.categoryID)),class:"inline-block w-5 h-5 rounded-full mr-3"},null,4),Object(o["createTextVNode"])(" "+Object(o["toDisplayString"])(a.getCategoryName(t.categoryID)),1)],8,N)]),Object(o["createElementVNode"])("td",null,[Object(o["createElementVNode"])("div",C,[Object(o["createElementVNode"])("img",{src:t.imageUri,alt:"",class:"w-12 h-12 object-cover",onClick:e=>a.fancyBox(t.imageUri)},null,8,V)])]),Object(o["createElementVNode"])("td",{onClick:e=>a.launchAddToCartModal(t),class:"cursor-pointer whitespace-normal",style:{width:"150px"}},[Object(o["createElementVNode"])("p",E,Object(o["toDisplayString"])(t.itemName),1)],8,h),Object(o["createElementVNode"])("td",{onClick:e=>a.launchAddToCartModal(t),class:"cursor-pointer"},Object(o["toDisplayString"])(t.sku),9,w),Object(o["createElementVNode"])("td",{onClick:e=>a.launchAddToCartModal(t),class:"cursor-pointer"},Object(o["toDisplayString"])(t.stock),9,B),Object(o["createElementVNode"])("td",{onClick:e=>a.launchAddToCartModal(t),class:"cursor-pointer"},Object(o["toDisplayString"])(`${t.price} ${a.currency}`),9,x),Object(o["createElementVNode"])("td",null,[Object(o["createElementVNode"])("div",I,[Object(o["createElementVNode"])("button",{onClick:e=>a.launchAddToCartModal(t),class:"hover:text-blue-500",type:"button"},[Object(o["createVNode"])(A,{name:"shopping-cart"})],8,S),Object(o["createElementVNode"])("button",{onClick:e=>a.markFavourite(t,c)},[Object(o["createVNode"])(A,{name:"heart",classes:"w-6 h-6 hover:text-red-500 "+(a.isFavourite(t)?"text-red-500":"")},null,8,["classes"])],8,D)])])]))),128)):(Object(o["openBlock"])(),Object(o["createElementBlock"])("tr",P,[Object(o["createElementVNode"])("td",F,Object(o["toDisplayString"])(a.translate("address_book.empty")),1)]))])])]),a.filteredFavourites.length>0?(Object(o["openBlock"])(),Object(o["createBlock"])(U,{key:1,meta:e.meta,onPage:a.updatePage},null,8,["meta","onPage"])):Object(o["createCommentVNode"])("",!0)])])]),_:1}),Object(o["createVNode"])(R)],64)}c("14d9");var T=c("66c3"),L=c("edc4"),A=c("cdae"),K=c("d529"),U=c("19ee"),_=c("f337"),R=c("5502"),q=c("2ef0"),z=c("8923"),J=c("6605"),Q=c("2e13"),$={name:"Favourites",components:{NavTabs:L["a"],"pos-layout":T["a"],Icon:A["a"],Pagination:K["a"],StreamBarcodeReader:_["a"],AddToCartModal:U["a"]},setup(){const e=Object(o["inject"])("translate"),t=Object(o["inject"])("toast"),c=Object(o["inject"])("emitter"),a=Object(R["b"])(),r=Object(J["d"])(),{fancyBox:l}=Object(Q["a"])(),n=Object(o["reactive"])({employee:null,keyword:"",categoryId:"",sortKey:null,order:"asc",meta:{currentPage:1,totalPages:0,limit:25,offset:0},isBarcodeScanner:!1}),s=Object(o["computed"])(()=>a.state.accountInfo),d=Object(o["computed"])(()=>a.state.altCoins),i=Object(o["computed"])(()=>a.state.pos),u=Object(o["computed"])(()=>{if(n.keyword||n.categoryId){const e=n.keyword.trim().toLowerCase();return i.value.favourites.filter(t=>n.categoryId&&e?t.categoryID===n.categoryId&&(q["includes"](t.itemName.toLowerCase(),e)||q["includes"](t.sku.toLowerCase(),e)||q["includes"](t.description.toLowerCase(),e)||Number(t.price)===Number(e)):n.categoryId?t.categoryID===n.categoryId:e?q["includes"](t.itemName.toLowerCase(),e)||q["includes"](t.sku.toLowerCase(),e)||q["includes"](t.description.toLowerCase(),e)||Number(t.price)===Number(e):void 0)}return i.value.favourites}),m=Object(o["computed"])(()=>{if(u.value&&u.value.length>0){let e=q["cloneDeep"](u.value);return e=e.map(e=>({...e,price:Number.parseFloat(e.price)})),e=q["orderBy"](e,n.sortKey,n.order),e.slice(n.meta.offset,n.meta.currentPage*n.meta.limit)}return u.value}),b=Object(o["computed"])(()=>{let e="EUR";if(s.value){e=s.value.PayoutCurrencyShortName;const t=q["find"](d.value,{ShortName:s.value.PayoutCurrencyShortName});t&&(e=t.LongName)}return e});Object(o["watch"])(()=>n.keyword,(e,t)=>{n.meta={...n.meta,currentPage:1,totalPages:Math.ceil(u.value.length/n.meta.limit),offset:0}});const j=e=>{e===n.sortKey&&(n.order="asc"===n.order?"desc":"asc"),n.sortKey=e},O=e=>{const t=q["find"](i.value.categories,{id:e});return t?t.name:""},p=e=>{const t=q["find"](i.value.categories,{id:e});return t?t.categoryColourCode:""},y=e=>e.sku?-1!==q["findIndex"](i.value.favourites,{sku:e.sku}):!!e.id&&-1!==q["findIndex"](i.value.favourites,{id:e.id}),g=e=>{n.meta={...n.meta,currentPage:e,offset:(e-1)*n.meta.limit}},k=e=>{const c=q["cloneDeep"](i.value.favourites);let o=-1;e.sku?o=q["findIndex"](c,{sku:e.sku}):e.id&&(o=q["findIndex"](c,{id:e.id})),-1===o?(c.push(e),t.success("Product marked favourite successfully")):(c.splice(o,1),t.success("Product unmarked favourite successfully"));const r=q["cloneDeep"](i.value);r.favourites=c,a.commit(z["S"],r)},f=e=>{n.keyword=e,n.isBarcodeScanner=!1;const t=q["find"](i.value.favourites,{sku:e});t&&N(t)},v=e=>{console.log(e)},N=e=>{Number(e.stock)>0?c.emit("addToCartModal",{product:e,currency:b.value,employee:n.employee}):t.warning("Product out of stock")};return Object(o["onBeforeMount"])(()=>{n.employee=q["find"](i.value.users,{isLoggedIn:"true"}),n.meta={...n.meta,currentPage:1,totalPages:Math.ceil(u.value.length/n.meta.limit),offset:0}}),Object(o["onMounted"])(()=>{Object.keys(r.query).length>0&&"undefined"!==typeof r.query.category_id&&(n.categoryId=r.query.category_id)}),{translate:e,...Object(o["toRefs"])(n),filteredFavourites:u,paginatedFavourites:m,categories:i.value.categories,sort:j,updatePage:g,getCategoryName:O,getCategoryColorCode:p,isFavourite:y,currency:b,markFavourite:k,onDecode:f,onError:v,launchAddToCartModal:N,fancyBox:l}}},G=(c("63bf"),c("6b0d")),H=c.n(G);const W=H()($,[["render",M],["__scopeId","data-v-231d94e3"]]);t["default"]=W},bf53:function(e,t,c){}}]);
//# sourceMappingURL=account-pos-favourites.1fe10f20.js.map