(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["shop-detail"],{"0fa5":function(e,t,a){"use strict";a.r(t);var c=a("f2bf");const o={class:"mb-3 flex items-center justify-between flex-col lg:flex-row"},r={key:0,class:"flex items-center"},l=["src"],n={key:0},s={key:1},d={class:"flex items-center justify-between flex-col lg:flex-row"},i=Object(c["createElementVNode"])("option",{value:""},"Filter Products",-1),m=["value"],g={class:"relative w-full lg:w-auto"},u={class:"grid grid-cols-4 gap-2 xl:gap-3"},b=["src"],p={class:"text-center py-1 font-semibold"},y={class:"text-center font-semibold mb-3"},h={class:"flex items-center justify-center mb-3"},j={key:0},O=Object(c["createElementVNode"])("hr",{class:"border-gray-300 dark:border-gray-600"},null,-1),k=Object(c["createElementVNode"])("div",{class:"w-full rounded shadow px-4 py-3 bg-yellow-500 mb-4 text-yellow-900 font-semibold mt-3"}," No products found ",-1),f=[O,k],v={key:1,class:"flex items-center justify-center mt-3"},w=["disabled"],P={class:"mr-2"},N=["disabled"];function B(e,t,a,O,k,B){const C=Object(c["resolveComponent"])("product-skeleton"),x=Object(c["resolveComponent"])("router-link"),E=Object(c["resolveComponent"])("icon"),V=Object(c["resolveComponent"])("star-rating"),S=Object(c["resolveComponent"])("centered-layout");return Object(c["openBlock"])(),Object(c["createBlock"])(S,null,{default:Object(c["withCtx"])(()=>[e.isProcessing?(Object(c["openBlock"])(),Object(c["createBlock"])(C,{key:0,counter:8})):(Object(c["openBlock"])(),Object(c["createElementBlock"])(c["Fragment"],{key:1},[Object(c["createElementVNode"])("div",o,[e.selectedShop?(Object(c["openBlock"])(),Object(c["createElementBlock"])("p",r,[Object(c["createVNode"])(x,{to:{name:"shop-detail",params:{id:O.shopId}},tag:"a",class:"flex items-center mr-2"},{default:Object(c["withCtx"])(()=>[O.isAvatar(e.selectedShop.Avatar)?(Object(c["openBlock"])(),Object(c["createElementBlock"])("img",{key:0,src:e.selectedShop.Avatar,alt:"",class:"w-8 h-8 rounded-full mr-2"},null,8,l)):Object(c["createCommentVNode"])("",!0),Object(c["createElementVNode"])("span",{onClick:t[0]||(t[0]=t=>e.category="")},Object(c["toDisplayString"])(e.selectedShop.ShopTitle),1)]),_:1},8,["to"]),O.selectedCategory?(Object(c["openBlock"])(),Object(c["createElementBlock"])("span",n," > Category > "+Object(c["toDisplayString"])(O.selectedCategory.name),1)):(Object(c["openBlock"])(),Object(c["createElementBlock"])("span",s," > Category > all"))])):Object(c["createCommentVNode"])("",!0),Object(c["createElementVNode"])("div",d,[Object(c["withDirectives"])(Object(c["createElementVNode"])("select",{"onUpdate:modelValue":t[1]||(t[1]=t=>e.category=t),"aria-label":"Filter",class:"form-select w-full lg:w-auto mr-0 lg:mr-3 mb-3 lg:mb-0"},[i,(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(O.productCategories,(e,t)=>(Object(c["openBlock"])(),Object(c["createElementBlock"])("option",{key:t,value:e.id},Object(c["toDisplayString"])(e.name),9,m))),128))],512),[[c["vModelSelect"],e.category]]),Object(c["createElementVNode"])("div",g,[Object(c["createVNode"])(E,{classes:"absolute w-5 h-5 top-3 left-3 dark:text-gray-300",name:"search"}),Object(c["withDirectives"])(Object(c["createElementVNode"])("input",{"onUpdate:modelValue":t[2]||(t[2]=t=>e.keyword=t),"aria-label":"Search...",placeholder:"Search...",class:"form-input px-10 w-full lg:w-auto",type:"text"},null,512),[[c["vModelText"],e.keyword]]),""!==e.keyword?(Object(c["openBlock"])(),Object(c["createElementBlock"])("span",{key:0,class:"absolute top-3 right-3 dark:text-gray-400 cursor-pointer",onClick:t[3]||(t[3]=t=>e.keyword="")},[Object(c["createVNode"])(E,{classes:"w-5 h-5",name:"close"})])):Object(c["createCommentVNode"])("",!0)])])]),Object(c["createElementVNode"])("div",u,[(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(O.paginatedProducts,(e,t)=>(Object(c["openBlock"])(),Object(c["createElementBlock"])("div",{key:t,class:"h-72 shadow bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-900 rounded col-span-4 md:col-span-2 lg:col-span-1 p-4"},[Object(c["createVNode"])(x,{to:{name:"product-detail",params:{shopId:O.shopId,id:e.id}},tag:"a"},{default:Object(c["withCtx"])(()=>[Object(c["createElementVNode"])("img",{src:e.imageUri,alt:"",class:"w-32 h-32 mx-auto object-contain"},null,8,b)]),_:2},1032,["to"]),Object(c["createElementVNode"])("h5",p,Object(c["toDisplayString"])(e.itemName),1),Object(c["createElementVNode"])("p",y,Object(c["toDisplayString"])(O.formatPrice(e.price,O.currency)),1),Object(c["createElementVNode"])("div",h,[Object(c["createVNode"])(V,{increment:.1,"max-rating":5,rating:O.getProductRatings(e.sku),"read-only":!0,"show-rating":!0,"star-size":20,"active-color":"#ffd200","inactive-color":"#d0d0d0"},null,8,["increment","rating"])])]))),128))]),O.shopId&&e.shop&&0===O.paginatedProducts.length?(Object(c["openBlock"])(),Object(c["createElementBlock"])("div",j,f)):Object(c["createCommentVNode"])("",!0),e.meta.totalPages>1?(Object(c["openBlock"])(),Object(c["createElementBlock"])("div",v,[Object(c["createElementVNode"])("button",{disabled:1===e.meta.currentPage,onClick:t[4]||(t[4]=e=>O.paginate("prev")),class:"btn btn-default mr-2"},[Object(c["createVNode"])(E,{name:"chevron-left"})],8,w),Object(c["createElementVNode"])("span",P,Object(c["toDisplayString"])(`${e.meta.currentPage} of ${e.meta.totalPages}`),1),Object(c["createElementVNode"])("button",{disabled:e.meta.currentPage===e.meta.totalPages,onClick:t[5]||(t[5]=e=>O.paginate("next")),class:"btn btn-default"},[Object(c["createVNode"])(E,{name:"chevron-right"})],8,N)])):Object(c["createCommentVNode"])("",!0)],64))]),_:1})}a("14d9");var C=a("9e55"),x=a("24f4"),E=a("cdae"),V=a("5502"),S=a("8923"),I=a("6605"),D=a("2ef0"),L=a("2e13"),F=a("5b3d"),M=a.n(F),R={name:"Shop",components:{CenteredLayout:C["a"],ProductSkeleton:x["a"],StarRating:M.a,Icon:E["a"]},setup(){const e=Object(c["inject"])("toast"),t=Object(V["b"])(),a=Object(I["d"])(),o=Object(I["e"])(),{saveNotification:r,formatPrice:l,copyToClipboard:n}=Object(L["a"])(),s=Object(c["reactive"])({shop:null,category:"",keyword:"",selectedShop:null,meta:{currentPage:1,totalPages:0,limit:12,offset:0},ratings:[],isProcessing:!1}),d=Object(c["computed"])(()=>t.state.shopId),i=Object(c["computed"])(()=>t.state.shopsList),m=Object(c["computed"])(()=>t.state.productsFilters),g=Object(c["computed"])(()=>t.state.altCoins),u=Object(c["computed"])(()=>{let e="EUR";if(s.shop){e=s.selectedShop.PayoutCurrencyShortName;const t=D["find"](g.value,{ShortName:e});t&&(e=t.LongName)}return e}),b=Object(c["computed"])(()=>{let e=D["cloneDeep"](s.shop.categories);return"nothing found"!=e&&e.length>0&&(e=e.filter((e,t,a)=>t===a.findIndex(t=>t.id===e.id))),s.shop.products.length>0&&"nothing found"!=e?e.filter(e=>-1!==D["findIndex"](s.shop.products,{categoryID:e.id})):[]}),p=Object(c["computed"])(()=>s.shop?s.shop.products.filter(e=>{const t=s.keyword.trim().toLowerCase();return s.category&&t?e.categoryID===s.category&&(D["includes"](e.itemName.toLowerCase(),t)||D["includes"](e.sku.toLowerCase(),t)||D["includes"](e.description.toLowerCase(),t))&&Number(e.stock)>0:s.category?e.categoryID===s.category&&Number(e.stock)>0:t?(D["includes"](e.itemName.toLowerCase(),t)||D["includes"](e.sku.toLowerCase(),t)||D["includes"](e.description.toLowerCase(),t))&&Number(e.stock)>0:Number(e.stock)>0}):[]),y=Object(c["computed"])(()=>p.value.length>0?p.value.slice(s.meta.offset,s.meta.currentPage*s.meta.limit):p.value),h=Object(c["computed"])(()=>s.category?D["find"](s.shop.categories,{id:s.category}):null);Object(c["watch"])(()=>d.value,(e,t)=>{e&&(s.selectedShop=D["find"](i.value,{ID:e.toString()}))}),Object(c["watch"])(()=>s.keyword,(e,t)=>{s.meta={...s.meta,currentPage:1,totalPages:p.value?Math.ceil(p.value.length/s.meta.limit):0,offset:0},v({currentPage:1,keyword:e,category:s.category})}),Object(c["watch"])(()=>s.category,(e,t)=>{s.meta={...s.meta,currentPage:1,totalPages:p.value?Math.ceil(p.value.length/s.meta.limit):0,offset:0},v({currentPage:1,keyword:s.keyword,category:e})});const j=e=>D["startsWith"](e,"https://cointopay.com/M_Images"),O=()=>{s.isProcessing=!0,t.dispatch(S["m"],{shopId:d.value}).then(t=>{if(s.isProcessing=!1,"nothing found"===t.products)e.warning("Store for this merchant is not enabled"),r("Store for this merchant is not enabled"),o.push({name:"shop"});else{s.shop=t;const e=s.shop.products?Math.ceil(s.shop.products.length/s.meta.limit):0;if(Object.keys(a.query).length>0&&"undefined"!==typeof a.query.page){const t=a.query.page;t>0&&t<=e&&v({currentPage:t,keyword:s.keyword,category:s.category})}s.meta={currentPage:m.value?m.value.currentPage:1,totalPages:s.shop.products?e:0,limit:12,offset:m.value?(m.value.currentPage-1)*s.meta.limit:0}}}).catch(e=>{s.isProcessing=!1,console.log(e)})},k=e=>{t.dispatch(S["j"],e).then(e=>{s.ratings=e})},f=()=>{t.commit(S["ab"],{categories:[],products:[]})},v=(e=null)=>{e||(e={currentPage:s.meta.currentPage,keyword:s.keyword,category:s.category}),t.commit(S["U"],e)},w=e=>{let t=0,a=0;return s.ratings.map(c=>{c.SKU===e&&(a+=1,t=Number(t)+Number(c.ReviewStars))}),a>0?t/a:0},P=e=>{let t=s.meta.currentPage;t="next"===e?s.meta.currentPage<s.meta.totalPages?s.meta.currentPage+1:s.meta.totalPages:s.meta.currentPage>0?s.meta.currentPage-1:s.meta.totalPages,s.meta={...s.meta,currentPage:t,offset:(t-1)*s.meta.limit},o.push({name:"shop-detail",params:{id:d.value},query:{page:t}}),v(),n(window.location.href,!1)};return Object(c["onBeforeMount"])(()=>{s.isProcessing=!0,d.value&&(s.selectedShop=D["find"](i.value,{ID:d.value})),t.dispatch(S["l"]).then(()=>{Object.keys(a.params).length>0?("undefined"!==typeof a.params.id?(t.commit(S["bb"],a.params.id),v()):t.commit(S["bb"],null),a.params.categoryId&&(s.category=a.params.categoryId),setTimeout(()=>{d.value&&s.selectedShop?(O(),k(d.value)):(e.warning("Store for this merchant is not enabled"),t.commit(S["bb"],null),o.push({name:"shop"}))},50)):(v({currentPage:1,keyword:"",category:""}),t.commit(S["bb"],null),f())}).catch(e=>{console.log(e)})}),{...Object(c["toRefs"])(s),currency:u,shopId:d,isAvatar:j,selectedCategory:h,productCategories:b,paginatedProducts:y,formatPrice:l,getProductRatings:w,paginate:P}}},U=a("6b0d"),q=a.n(U);const A=q()(R,[["render",B]]);t["default"]=A},"24f4":function(e,t,a){"use strict";var c=a("f2bf");const o={class:"grid grid-cols-4 gap-2 xl:gap-3"},r=Object(c["createStaticVNode"])('<div class="bg-gray-200 dark:bg-gray-500 rounded w-32 h-32 mx-auto"></div><div class="mt-3 h-2 bg-gray-200 dark:bg-gray-500 rounded"></div><div class="mt-3 h-2 bg-gray-200 dark:bg-gray-500 rounded w-2/5 mx-auto"></div><div class="flex items-center justify-center mt-3"><div class="w-8 h-8 bg-gray-200 dark:bg-gray-500 rounded mr-3"></div><div class="w-8 h-8 bg-gray-200 dark:bg-gray-500 rounded mr-3"></div><div class="w-8 h-8 bg-gray-200 dark:bg-gray-500 rounded mr-3"></div><div class="w-8 h-8 bg-gray-200 dark:bg-gray-500 rounded mr-3"></div></div>',4),l=[r];function n(e,t,a,r,n,s){return Object(c["openBlock"])(),Object(c["createElementBlock"])("div",o,[(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(a.counter,e=>(Object(c["openBlock"])(),Object(c["createElementBlock"])("div",{key:e,class:"animate-pulse h-72 shadow bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-900 rounded col-span-4 md:col-span-2 lg:col-span-1 p-4"},l))),128))])}var s={name:"Product",props:["counter"]},d=a("6b0d"),i=a.n(d);const m=i()(s,[["render",n]]);t["a"]=m}}]);
//# sourceMappingURL=shop-detail.380bfac7.js.map