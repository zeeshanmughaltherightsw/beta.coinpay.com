(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["shop-detail"],{"0fa5":function(e,t,c){"use strict";c.r(t);c("b0c0"),c("99af");var a=c("f2bf"),r={class:"mb-3 flex items-center justify-between flex-col lg:flex-row"},o={key:0,class:"flex items-center"},n=["src"],l={key:0},s={key:1},i={class:"flex items-center justify-between flex-col lg:flex-row"},d=Object(a["createElementVNode"])("option",{value:""},"Filter Products",-1),u=["value"],m={class:"relative w-full lg:w-auto"},g={class:"grid grid-cols-4 gap-2 xl:gap-3"},b=["src"],p={class:"text-center py-1 font-semibold"},f={class:"text-center font-semibold mb-3"},j={class:"flex items-center justify-center mb-3"},y={key:0},h=Object(a["createElementVNode"])("hr",{class:"border-gray-300 dark:border-gray-600"},null,-1),O=Object(a["createElementVNode"])("div",{class:"w-full rounded shadow px-4 py-3 bg-yellow-500 mb-4 text-yellow-900 font-semibold mt-3"}," No products found ",-1),v=[h,O],k={key:1,class:"flex items-center justify-center mt-3"},w=["disabled"],P={class:"mr-2"},N=["disabled"];function x(e,t,c,h,O,x){var B=Object(a["resolveComponent"])("product-skeleton"),C=Object(a["resolveComponent"])("router-link"),E=Object(a["resolveComponent"])("icon"),V=Object(a["resolveComponent"])("star-rating"),S=Object(a["resolveComponent"])("centered-layout");return Object(a["openBlock"])(),Object(a["createBlock"])(S,null,{default:Object(a["withCtx"])((function(){return[e.isProcessing?(Object(a["openBlock"])(),Object(a["createBlock"])(B,{key:0,counter:8})):(Object(a["openBlock"])(),Object(a["createElementBlock"])(a["Fragment"],{key:1},[Object(a["createElementVNode"])("div",r,[e.selectedShop?(Object(a["openBlock"])(),Object(a["createElementBlock"])("p",o,[Object(a["createVNode"])(C,{to:{name:"shop-detail",params:{id:h.shopId}},tag:"a",class:"flex items-center mr-2"},{default:Object(a["withCtx"])((function(){return[h.isAvatar(e.selectedShop.Avatar)?(Object(a["openBlock"])(),Object(a["createElementBlock"])("img",{key:0,src:e.selectedShop.Avatar,alt:"",class:"w-8 h-8 rounded-full mr-2"},null,8,n)):Object(a["createCommentVNode"])("",!0),Object(a["createElementVNode"])("span",{onClick:t[0]||(t[0]=function(t){return e.category=""})},Object(a["toDisplayString"])(e.selectedShop.ShopTitle),1)]})),_:1},8,["to"]),h.selectedCategory?(Object(a["openBlock"])(),Object(a["createElementBlock"])("span",l," > Category > "+Object(a["toDisplayString"])(h.selectedCategory.name),1)):(Object(a["openBlock"])(),Object(a["createElementBlock"])("span",s," > Category > all"))])):Object(a["createCommentVNode"])("",!0),Object(a["createElementVNode"])("div",i,[Object(a["withDirectives"])(Object(a["createElementVNode"])("select",{"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.category=t}),"aria-label":"Filter",class:"form-select w-full lg:w-auto mr-0 lg:mr-3 mb-3 lg:mb-0"},[d,(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(h.productCategories,(function(e,t){return Object(a["openBlock"])(),Object(a["createElementBlock"])("option",{key:t,value:e.id},Object(a["toDisplayString"])(e.name),9,u)})),128))],512),[[a["vModelSelect"],e.category]]),Object(a["createElementVNode"])("div",m,[Object(a["createVNode"])(E,{classes:"absolute w-5 h-5 top-3 left-3 dark:text-gray-300",name:"search"}),Object(a["withDirectives"])(Object(a["createElementVNode"])("input",{"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.keyword=t}),"aria-label":"Search...",placeholder:"Search...",class:"form-input px-10 w-full lg:w-auto",type:"text"},null,512),[[a["vModelText"],e.keyword]]),""!==e.keyword?(Object(a["openBlock"])(),Object(a["createElementBlock"])("span",{key:0,class:"absolute top-3 right-3 dark:text-gray-400 cursor-pointer",onClick:t[3]||(t[3]=function(t){return e.keyword=""})},[Object(a["createVNode"])(E,{classes:"w-5 h-5",name:"close"})])):Object(a["createCommentVNode"])("",!0)])])]),Object(a["createElementVNode"])("div",g,[(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(h.paginatedProducts,(function(e,t){return Object(a["openBlock"])(),Object(a["createElementBlock"])("div",{key:t,class:"h-72 shadow bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-900 rounded col-span-4 md:col-span-2 lg:col-span-1 p-4"},[Object(a["createVNode"])(C,{to:{name:"product-detail",params:{shopId:h.shopId,id:e.id}},tag:"a"},{default:Object(a["withCtx"])((function(){return[Object(a["createElementVNode"])("img",{src:e.imageUri,alt:"",class:"w-32 h-32 mx-auto object-contain"},null,8,b)]})),_:2},1032,["to"]),Object(a["createElementVNode"])("h5",p,Object(a["toDisplayString"])(e.itemName),1),Object(a["createElementVNode"])("p",f,Object(a["toDisplayString"])(h.formatPrice(e.price,h.currency)),1),Object(a["createElementVNode"])("div",j,[Object(a["createVNode"])(V,{increment:.1,"max-rating":5,rating:h.getProductRatings(e.sku),"read-only":!0,"show-rating":!0,"star-size":20,"active-color":"#ffd200","inactive-color":"#d0d0d0"},null,8,["increment","rating"])])])})),128))]),h.shopId&&e.shop&&0===h.paginatedProducts.length?(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",y,v)):Object(a["createCommentVNode"])("",!0),e.meta.totalPages>1?(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",k,[Object(a["createElementVNode"])("button",{disabled:1===e.meta.currentPage,onClick:t[4]||(t[4]=function(e){return h.paginate("prev")}),class:"btn btn-default mr-2"},[Object(a["createVNode"])(E,{name:"chevron-left"})],8,w),Object(a["createElementVNode"])("span",P,Object(a["toDisplayString"])("".concat(e.meta.currentPage," of ").concat(e.meta.totalPages)),1),Object(a["createElementVNode"])("button",{disabled:e.meta.currentPage===e.meta.totalPages,onClick:t[5]||(t[5]=function(e){return h.paginate("next")}),class:"btn btn-default"},[Object(a["createVNode"])(E,{name:"chevron-right"})],8,N)])):Object(a["createCommentVNode"])("",!0)],64))]})),_:1})}var B=c("5530"),C=(c("4de4"),c("d3b7"),c("c740"),c("498a"),c("a4d3"),c("e01a"),c("a9e3"),c("fb6a"),c("25f0"),c("b64b"),c("d81d"),c("9e55")),E=c("24f4"),V=c("cdae"),S=c("5502"),I=c("8923"),D=c("6c02"),L=c("2ef0"),F=c("2e13"),M=c("5b3d"),A=c.n(M),R={name:"Shop",components:{CenteredLayout:C["a"],ProductSkeleton:E["a"],StarRating:A.a,Icon:V["a"]},setup:function(){var e=Object(a["inject"])("toast"),t=Object(S["b"])(),c=Object(D["d"])(),r=Object(D["e"])(),o=Object(F["a"])(),n=o.saveNotification,l=o.formatPrice,s=o.copyToClipboard,i=Object(a["reactive"])({shop:null,category:"",keyword:"",selectedShop:null,meta:{currentPage:1,totalPages:0,limit:12,offset:0},ratings:[],isProcessing:!1}),d=Object(a["computed"])((function(){return t.state.shopId})),u=Object(a["computed"])((function(){return t.state.shopsList})),m=Object(a["computed"])((function(){return t.state.productsFilters})),g=Object(a["computed"])((function(){return t.state.altCoins})),b=Object(a["computed"])((function(){var e="EUR";if(i.shop){e=i.shop.PayoutCurrencyShortName;var t=L["find"](g.value,{ShortName:e});t&&(e=t.LongName)}return e})),p=Object(a["computed"])((function(){var e=L["cloneDeep"](i.shop.categories);return"nothing found"!=e&&e.length>0&&(e=e.filter((function(e,t,c){return t===c.findIndex((function(t){return t.id===e.id}))}))),i.shop.products.length>0&&"nothing found"!=e?e.filter((function(e){return-1!==L["findIndex"](i.shop.products,{categoryID:e.id})})):[]})),f=Object(a["computed"])((function(){return i.shop?i.shop.products.filter((function(e){var t=i.keyword.trim().toLowerCase();return i.category&&t?e.categoryID===i.category&&(L["includes"](e.itemName.toLowerCase(),t)||L["includes"](e.sku.toLowerCase(),t)||L["includes"](e.description.toLowerCase(),t))&&Number(e.stock)>0:i.category?e.categoryID===i.category&&Number(e.stock)>0:t?(L["includes"](e.itemName.toLowerCase(),t)||L["includes"](e.sku.toLowerCase(),t)||L["includes"](e.description.toLowerCase(),t))&&Number(e.stock)>0:Number(e.stock)>0})):[]})),j=Object(a["computed"])((function(){return f.value.length>0?f.value.slice(i.meta.offset,i.meta.currentPage*i.meta.limit):f.value})),y=Object(a["computed"])((function(){return i.category?L["find"](i.shop.categories,{id:i.category}):null}));Object(a["watch"])((function(){return d.value}),(function(e,t){e&&(i.selectedShop=L["find"](u.value,{ID:e.toString()}))})),Object(a["watch"])((function(){return i.keyword}),(function(e,t){i.meta=Object(B["a"])(Object(B["a"])({},i.meta),{},{currentPage:1,totalPages:f.value?Math.ceil(f.value.length/i.meta.limit):0,offset:0}),w({currentPage:1,keyword:e,category:i.category})})),Object(a["watch"])((function(){return i.category}),(function(e,t){i.meta=Object(B["a"])(Object(B["a"])({},i.meta),{},{currentPage:1,totalPages:f.value?Math.ceil(f.value.length/i.meta.limit):0,offset:0}),w({currentPage:1,keyword:i.keyword,category:e})}));var h=function(e){return L["startsWith"](e,"https://cointopay.com/M_Images")},O=function(){i.isProcessing=!0,t.dispatch(I["m"],{shopId:d.value}).then((function(t){if(i.isProcessing=!1,"nothing found"===t.products)e.warning("Store for this merchant is not enabled"),n("Store for this merchant is not enabled"),r.push({name:"shop"});else{i.shop=t;var a=i.shop.products?Math.ceil(i.shop.products.length/i.meta.limit):0;if(Object.keys(c.query).length>0&&"undefined"!==typeof c.query.page){var o=c.query.page;o>0&&o<=a&&w({currentPage:o,keyword:i.keyword,category:i.category})}i.meta={currentPage:m.value?m.value.currentPage:1,totalPages:i.shop.products?a:0,limit:12,offset:m.value?(m.value.currentPage-1)*i.meta.limit:0}}})).catch((function(e){i.isProcessing=!1,console.log(e)}))},v=function(e){t.dispatch(I["j"],e).then((function(e){i.ratings=e}))},k=function(){t.commit(I["ab"],{categories:[],products:[]})},w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e||(e={currentPage:i.meta.currentPage,keyword:i.keyword,category:i.category}),t.commit(I["U"],e)},P=function(e){var t=0,c=0;return i.ratings.map((function(a){a.SKU===e&&(c+=1,t=Number(t)+Number(a.ReviewStars))})),c>0?t/c:0},N=function(e){var t=i.meta.currentPage;t="next"===e?i.meta.currentPage<i.meta.totalPages?i.meta.currentPage+1:i.meta.totalPages:i.meta.currentPage>0?i.meta.currentPage-1:i.meta.totalPages,i.meta=Object(B["a"])(Object(B["a"])({},i.meta),{},{currentPage:t,offset:(t-1)*i.meta.limit}),r.push({name:"shop-detail",params:{id:d.value},query:{page:t}}),w(),s(window.location.href,!1)};return Object(a["onBeforeMount"])((function(){i.isProcessing=!0,d.value&&(i.selectedShop=L["find"](u.value,{ID:d.value})),t.dispatch(I["l"]).then((function(){Object.keys(c.params).length>0?("undefined"!==typeof c.params.id?(t.commit(I["bb"],c.params.id),w()):t.commit(I["bb"],null),c.params.categoryId&&(i.category=c.params.categoryId),setTimeout((function(){d.value&&i.selectedShop?(O(),v(d.value)):(e.warning("Store for this merchant is not enabled"),t.commit(I["bb"],null),r.push({name:"shop"}))}),50)):(w({currentPage:1,keyword:"",category:""}),t.commit(I["bb"],null),k())})).catch((function(e){console.log(e)}))})),Object(B["a"])(Object(B["a"])({},Object(a["toRefs"])(i)),{},{currency:b,shopId:d,isAvatar:h,selectedCategory:y,productCategories:p,paginatedProducts:j,formatPrice:l,getProductRatings:P,paginate:N})}},U=c("6b0d"),q=c.n(U);const T=q()(R,[["render",x]]);t["default"]=T},"24f4":function(e,t,c){"use strict";var a=c("f2bf"),r={class:"grid grid-cols-4 gap-2 xl:gap-3"},o=Object(a["createStaticVNode"])('<div class="bg-gray-200 dark:bg-gray-500 rounded w-32 h-32 mx-auto"></div><div class="mt-3 h-2 bg-gray-200 dark:bg-gray-500 rounded"></div><div class="mt-3 h-2 bg-gray-200 dark:bg-gray-500 rounded w-2/5 mx-auto"></div><div class="flex items-center justify-center mt-3"><div class="w-8 h-8 bg-gray-200 dark:bg-gray-500 rounded mr-3"></div><div class="w-8 h-8 bg-gray-200 dark:bg-gray-500 rounded mr-3"></div><div class="w-8 h-8 bg-gray-200 dark:bg-gray-500 rounded mr-3"></div><div class="w-8 h-8 bg-gray-200 dark:bg-gray-500 rounded mr-3"></div></div>',4),n=[o];function l(e,t,c,o,l,s){return Object(a["openBlock"])(),Object(a["createElementBlock"])("div",r,[(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(c.counter,(function(e){return Object(a["openBlock"])(),Object(a["createElementBlock"])("div",{key:e,class:"animate-pulse h-72 shadow bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-900 rounded col-span-4 md:col-span-2 lg:col-span-1 p-4"},n)})),128))])}var s={name:"Product",props:["counter"]},i=c("6b0d"),d=c.n(i);const u=d()(s,[["render",l]]);t["a"]=u},c740:function(e,t,c){"use strict";var a=c("23e7"),r=c("b727").findIndex,o=c("44d2"),n="findIndex",l=!0;n in[]&&Array(1)[n]((function(){l=!1})),a({target:"Array",proto:!0,forced:l},{findIndex:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}}),o(n)}}]);
//# sourceMappingURL=shop-detail.55b337e2.js.map