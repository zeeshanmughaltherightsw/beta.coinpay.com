(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["account-pos-recipients"],{"313c":function(e,t,c){"use strict";c("914c")},"441e":function(e,t,c){"use strict";c.r(t);var a=c("f2bf");const r=e=>(Object(a["pushScopeId"])("data-v-3f640c0a"),e=e(),Object(a["popScopeId"])(),e),o={class:"card"},l={class:"body"},n={class:"flex items-center justify-end mb-3"},s={class:"relative w-full md:w-2/5"},i={class:"w-full scrollbar scrollbar-thin scrollbar-thumb-gray-400 scrollbar-track-gray-200 dark:scrollbar-track-gray-900 dark:scrollbar-thumb-gray-600"},d={class:"table-sm mb-2"},b=r(()=>Object(a["createElementVNode"])("th",{class:"whitespace-nowrap"},"Receipt ID",-1)),m=r(()=>Object(a["createElementVNode"])("th",{class:"whitespace-nowrap"},"Transaction ID",-1)),p=r(()=>Object(a["createElementVNode"])("th",null,"Actions",-1)),j=["onClick"],O=["onClick"],u={key:0},g=r(()=>Object(a["createElementVNode"])("td",{colspan:"7"},"No receipt available",-1)),E=[g];function N(e,t,c,r,g,N){const h=Object(a["resolveComponent"])("icon"),k=Object(a["resolveComponent"])("pagination"),y=Object(a["resolveComponent"])("pos-layout"),V=Object(a["resolveComponent"])("receipt-detail-modal");return Object(a["openBlock"])(),Object(a["createElementBlock"])(a["Fragment"],null,[Object(a["createVNode"])(y,null,{content:Object(a["withCtx"])(()=>[Object(a["createElementVNode"])("div",o,[Object(a["createElementVNode"])("div",l,[Object(a["createElementVNode"])("div",n,[Object(a["createElementVNode"])("div",s,[Object(a["createVNode"])(h,{classes:"absolute w-5 h-5 top-3 left-3 dark:text-gray-300",name:"search"}),Object(a["withDirectives"])(Object(a["createElementVNode"])("input",{"onUpdate:modelValue":t[0]||(t[0]=t=>e.keyword=t),"aria-label":"Search...",class:"form-input px-10 w-full",type:"text"},null,512),[[a["vModelText"],e.keyword]]),""!==e.keyword?(Object(a["openBlock"])(),Object(a["createElementBlock"])("span",{key:0,class:"absolute top-3 right-3 dark:text-gray-400 cursor-pointer",onClick:t[1]||(t[1]=t=>e.keyword="")},[Object(a["createVNode"])(h,{classes:"w-5 h-5",name:"close"})])):Object(a["createCommentVNode"])("",!0)])]),Object(a["createElementVNode"])("div",i,[Object(a["createElementVNode"])("table",d,[Object(a["createElementVNode"])("thead",null,[Object(a["createElementVNode"])("tr",null,[b,m,Object(a["createElementVNode"])("th",{onClick:t[2]||(t[2]=e=>r.sort("TICKETNUMBER")),class:"cursor-pointer whitespace-nowrap"},[Object(a["createTextVNode"])(" Ticket Number "),"TICKETNUMBER"===e.sortKey?(Object(a["openBlock"])(),Object(a["createElementBlock"])("span",{key:0,class:Object(a["normalizeClass"])("ml-4 transform transition-all "+("asc"===e.order?"rotate-180":""))},[Object(a["createVNode"])(h,{name:"sort",class:"w-4 h-4"})],2)):Object(a["createCommentVNode"])("",!0)]),Object(a["createElementVNode"])("th",{onClick:t[3]||(t[3]=e=>r.sort("CASHIER")),class:"pointer whitespace-nowrap"},[Object(a["createTextVNode"])(" Cashier "),"CASHIER"===e.sortKey?(Object(a["openBlock"])(),Object(a["createElementBlock"])("span",{key:0,class:Object(a["normalizeClass"])("ml-4 transform transition-all "+("asc"===e.order?"rotate-180":""))},[Object(a["createVNode"])(h,{name:"sort",class:"w-4 h-4"})],2)):Object(a["createCommentVNode"])("",!0)]),Object(a["createElementVNode"])("th",{onClick:t[4]||(t[4]=e=>r.sort("DATE")),class:"cursor-pointer whitespace-nowrap"},[Object(a["createTextVNode"])(" Date "),"DATE"===e.sortKey?(Object(a["openBlock"])(),Object(a["createElementBlock"])("span",{key:0,class:Object(a["normalizeClass"])("ml-4 transform transition-all "+("asc"===e.order?"rotate-180":""))},[Object(a["createVNode"])(h,{name:"sort",class:"w-4 h-4"})],2)):Object(a["createCommentVNode"])("",!0)]),Object(a["createElementVNode"])("th",{onClick:t[5]||(t[5]=e=>r.sort("TOTAL")),class:"cursor-pointer whitespace-nowrap"},[Object(a["createTextVNode"])(" Total Amount "),"TOTAL"===e.sortKey?(Object(a["openBlock"])(),Object(a["createElementBlock"])("span",{key:0,class:Object(a["normalizeClass"])("ml-4 transform transition-all "+("asc"===e.order?"rotate-180":""))},[Object(a["createVNode"])(h,{name:"sort",class:"w-4 h-4"})],2)):Object(a["createCommentVNode"])("",!0)]),p])]),Object(a["createElementVNode"])("tbody",null,[(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(r.paginatedReceipts,(e,t)=>(Object(a["openBlock"])(),Object(a["createElementBlock"])("tr",{key:t,onClick:t=>r.launchReceiptDetailModal(e),class:"cursor-pointer"},[Object(a["createElementVNode"])("td",null,Object(a["toDisplayString"])(e.ID),1),Object(a["createElementVNode"])("td",null,Object(a["toDisplayString"])(e.TRANSACTION_ID),1),Object(a["createElementVNode"])("td",null,"#"+Object(a["toDisplayString"])(e.TICKETNUMBER),1),Object(a["createElementVNode"])("td",null,Object(a["toDisplayString"])(e.CASHIER),1),Object(a["createElementVNode"])("td",null,Object(a["toDisplayString"])(r.formatDT(e.DATE)),1),Object(a["createElementVNode"])("td",null,Object(a["toDisplayString"])(`${e.TOTAL.replace("Total Price: ","").replace(e.CURRENCY,"")} ${e.CURRENCY}`),1),Object(a["createElementVNode"])("td",null,[Object(a["createElementVNode"])("button",{onClick:t=>r.launchReceiptDetailModal(e),class:"hover:text-blue-500"},[Object(a["createVNode"])(h,{name:"eye"})],8,O)])],8,j))),128)),0===r.paginatedReceipts.length?(Object(a["openBlock"])(),Object(a["createElementBlock"])("tr",u,E)):Object(a["createCommentVNode"])("",!0)])])]),r.filteredReceipts.length>0?(Object(a["openBlock"])(),Object(a["createBlock"])(k,{key:0,meta:e.meta,onPage:r.updatePage},null,8,["meta","onPage"])):Object(a["createCommentVNode"])("",!0)])])]),_:1}),Object(a["createVNode"])(V)],64)}var h=c("66c3"),k=c("cdae"),y=c("d529");const V={class:"flex items-center justify-between"},C={key:0},f={class:"table-sm"},v=Object(a["createElementVNode"])("th",null,"Date",-1),w={colspan:"4"},x=Object(a["createElementVNode"])("th",null,"Receipt ID",-1),T={colspan:"4"},D=Object(a["createElementVNode"])("th",null,"Transaction ID",-1),P={colspan:"4"},R=Object(a["createElementVNode"])("th",null,"Ticket Number",-1),B={colspan:"4"},I=Object(a["createElementVNode"])("th",null,"Cashier",-1),S={colspan:"4"},A=Object(a["createElementVNode"])("th",null,"Total Amount",-1),M={colspan:"4"},U=Object(a["createElementVNode"])("tr",{class:"whitespace-nowrap"},[Object(a["createElementVNode"])("th",null,"Product Name"),Object(a["createElementVNode"])("th",null,"Sku"),Object(a["createElementVNode"])("th",null,"Price"),Object(a["createElementVNode"])("th",null,"Quantity"),Object(a["createElementVNode"])("th",null,"Sub Total")],-1),Y={class:"whitespace-nowrap"},K={class:"mb-2 flex items-center justify-between"},_={class:"flex-1"},L=["placeholder"],z={class:"text-red-700 dark:text-red-400 text-sm"},$={key:0,class:"mr-3"};function H(e,t,c,r,o,l){const n=Object(a["resolveComponent"])("icon"),s=Object(a["resolveComponent"])("j-button"),i=Object(a["resolveComponent"])("modal");return Object(a["openBlock"])(),Object(a["createBlock"])(i,{maxWidth:e.maxWidth,show:e.show,onClose:t[3]||(t[3]=e=>r.closeModal())},{title:Object(a["withCtx"])(()=>[Object(a["createElementVNode"])("div",V,[Object(a["createElementVNode"])("span",null,Object(a["toDisplayString"])(r.translate("pos.receipts.title")),1),Object(a["createElementVNode"])("span",{class:"text-gray-500 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-200 cursor-pointer",onClick:t[0]||(t[0]=e=>r.closeModal())},[Object(a["createVNode"])(n,{name:"close"})])])]),content:Object(a["withCtx"])(()=>[e.receipt?(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",C,[Object(a["createElementVNode"])("table",f,[Object(a["createElementVNode"])("tbody",null,[Object(a["createElementVNode"])("tr",null,[v,Object(a["createElementVNode"])("td",w,Object(a["toDisplayString"])(r.formatDT(e.receipt.DATE)),1)]),Object(a["createElementVNode"])("tr",null,[x,Object(a["createElementVNode"])("td",T,Object(a["toDisplayString"])(e.receipt.ID),1)]),Object(a["createElementVNode"])("tr",null,[D,Object(a["createElementVNode"])("td",P,Object(a["toDisplayString"])(e.receipt.TRANSACTION_ID),1)]),Object(a["createElementVNode"])("tr",null,[R,Object(a["createElementVNode"])("td",B,Object(a["toDisplayString"])(e.receipt.TICKETNUMBER),1)]),Object(a["createElementVNode"])("tr",null,[I,Object(a["createElementVNode"])("td",S,Object(a["toDisplayString"])(e.receipt.CASHIER),1)]),Object(a["createElementVNode"])("tr",null,[A,Object(a["createElementVNode"])("td",M,Object(a["toDisplayString"])(e.receipt.TOTAL.replace("Total Price: ","").replace(e.receipt.CURRENCY,"")+" "+e.receipt.CURRENCY),1)]),U,(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(e.receipt.items,(t,c)=>(Object(a["openBlock"])(),Object(a["createElementBlock"])("tr",{key:c},[Object(a["createElementVNode"])("td",null,Object(a["toDisplayString"])(t.ITEM_NAME),1),Object(a["createElementVNode"])("td",null,Object(a["toDisplayString"])(t.ITEM_SKU),1),Object(a["createElementVNode"])("td",Y,Object(a["toDisplayString"])(`${t.ITEM_PRICE} ${t.CURRENCY?t.CURRENCY:e.receipt.CURRENCY}`),1),Object(a["createElementVNode"])("td",null,Object(a["toDisplayString"])(t.QUANTITY),1),Object(a["createElementVNode"])("td",null,Object(a["toDisplayString"])(`${t.QUANTITY*t.ITEM_PRICE} ${t.CURRENCY?t.CURRENCY:e.receipt.CURRENCY}`),1)]))),128))])]),Object(a["createElementVNode"])("form",{onSubmit:t[2]||(t[2]=Object(a["withModifiers"])(e=>r.submit(),["prevent"]))},[Object(a["createElementVNode"])("div",K,[Object(a["createElementVNode"])("div",_,[Object(a["withDirectives"])(Object(a["createElementVNode"])("input",{placeholder:r.translate("pos.receipts.email"),"aria-label":"Email",class:"form-input w-full",type:"email","onUpdate:modelValue":t[1]||(t[1]=t=>e.form.email=t)},null,8,L),[[a["vModelText"],e.form.email]]),Object(a["createElementVNode"])("div",z,Object(a["toDisplayString"])(r.showError(e.errorBag,"email")),1)]),Object(a["createVNode"])(s,{disabled:e.isProcessing,class:"ml-3"},{default:Object(a["withCtx"])(()=>[e.isProcessing?(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",$,[Object(a["createVNode"])(n,{name:"spinner",classes:"w-4 h-4 text-white"})])):Object(a["createCommentVNode"])("",!0),Object(a["createElementVNode"])("span",null,Object(a["toDisplayString"])(r.translate("pos.receipts.btn_send_receipt")),1)]),_:1},8,["disabled"])])],32)])):Object(a["createCommentVNode"])("",!0)]),_:1},8,["maxWidth","show"])}var F=c("714b"),J=c("4032"),W=c("5502"),q=c("ea45"),Q=c("c1df"),G={name:"ReceiptDetailModal",components:{Modal:F["a"],Icon:k["a"],JButton:J["a"]},setup(){const e=Object(a["inject"])("translate"),t=Object(a["inject"])("emitter"),c=Object(a["inject"])("toast"),r=Object(a["inject"])("http"),o=Object(W["b"])(),{showError:l,validate:n}=Object(q["a"])(),s=Object(a["reactive"])({show:!1,maxWidth:"2xl",closeable:!0,receipt:null,form:{email:""},errorBag:{},rules:{email:["required","email"]},messages:{email:{required:"Email address is required",email:"Please provide a valid email address"}},isProcessing:!1}),i=Object(a["computed"])(()=>o.state.user);Object(a["watch"])(()=>({...s.form}),(e,t)=>{Object.keys(s.errorBag).length>0&&(s.errorBag=n(s.form,s.rules,s.messages))});const d="https://app.cointopay.com",b=()=>{s.show=!1},m=e=>Q(new Date(Number(e))).format("DD/MM/YYYY H:mm A"),p=()=>{if(s.errorBag=n(s.form,s.rules,s.messages),0===Object.keys(s.errorBag).length){s.isProcessing=!0;const e={"Receipt ID":s.receipt.ID,Time:m(s.receipt.DATE),"Total Amount":`${s.receipt.TOTAL} ${s.receipt.CURRENCY}`,Cashier:s.receipt.CASHIER,Items:s.receipt.items},t={Call:"POSRECEIPT",MerchantID:Number(i.value.ID),APIKey:i.value.APIKey,email:s.form.email,ticketData:JSON.stringify(e),output:"json"},a=e=>Object.keys(e).map(t=>encodeURIComponent(t)+"="+encodeURIComponent(e[t])).join("&");r.post(d+"/v2REAPI",a(t),{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(e=>{s.isProcessing=!1,e.data&&c.success("Receipt sent successfully")}).catch(e=>{s.isProcessing=!1,console.log(e)})}};return Object(a["onBeforeMount"])(()=>{t.on("receiptDetailModal",e=>{s.receipt=e.receipt,s.form={email:""},s.show=!0})}),{translate:e,...Object(a["toRefs"])(s),closeModal:b,showError:l,submit:p,formatDT:m}}},X=c("6b0d"),Z=c.n(X);const ee=Z()(G,[["render",H]]);var te=ee,ce=c("2ef0"),ae={name:"Recipients",components:{"pos-layout":h["a"],Icon:k["a"],Pagination:y["a"],ReceiptDetailModal:te},setup(){const e=Object(a["inject"])("emitter"),t=Object(W["b"])(),c=Object(a["reactive"])({keyword:"",sortKey:null,order:"asc",meta:{currentPage:1,totalPages:0,limit:25,offset:0}}),r=Object(a["computed"])(()=>t.state.pos),o=Object(a["computed"])(()=>c.keyword?r.value.receipts.filter(e=>{const t=c.keyword.trim().toLowerCase();return ce["includes"](e.ID,t)||ce["includes"](e.CASHIER.toLowerCase(),t)||ce["includes"](e.TICKETNUMBER,t)||ce["includes"](e.TRANSACTION_ID,t)}):ce["orderBy"](r.value.receipts,"DATE","desc")),l=Object(a["computed"])(()=>{if(o.value&&o.value.length>0){let e=ce["cloneDeep"](o.value);return e=e.map(e=>({...e,ITEM_PRICE:Number.parseFloat(e.TOTAL.replace("Total Price: ",""))})),e=ce["orderBy"](e,c.sortKey,c.order),e.slice(c.meta.offset,c.meta.currentPage*c.meta.limit)}return o.value});Object(a["watch"])(()=>c.keyword,(e,t)=>{c.meta={...c.meta,currentPage:1,totalPages:Math.ceil(o.value.length/c.meta.limit),offset:0}});const n=e=>{e===c.sortKey&&(c.order="asc"===c.order?"desc":"asc"),c.sortKey=e},s=e=>{c.meta={...c.meta,currentPage:e,offset:(e-1)*c.meta.limit}},i=e=>Q(new Date(Number(e))).format("DD/MM/YYYY H:mm A"),d=t=>{t.items=r.value.receiptItems.filter(e=>e.RECIEPT_ID===t.ID),e.emit("receiptDetailModal",{receipt:t})};return Object(a["onBeforeMount"])(()=>{c.employee=ce["find"](r.value.users,{isLoggedIn:"true"}),c.meta={...c.meta,currentPage:1,totalPages:Math.ceil(o.value.length/c.meta.limit),offset:0}}),{...Object(a["toRefs"])(c),filteredReceipts:o,paginatedReceipts:l,sort:n,updatePage:s,formatDT:i,launchReceiptDetailModal:d}}};c("313c");const re=Z()(ae,[["render",N],["__scopeId","data-v-3f640c0a"]]);t["default"]=re},"914c":function(e,t,c){},d529:function(e,t,c){"use strict";var a=c("f2bf");const r={key:0,"aria-label":"pagination",class:"mt-3"},o={class:"inline-flex -space-x-px text-sm md:text-base"},l=Object(a["createElementVNode"])("span",{"aria-hidden":"true"},"«",-1),n=[l],s={key:0,class:"px-1 py-2 md:px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:text-blue-500 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:text-blue-500",href:"javascript:void(0)"},i=["onClick"],d={key:0,class:"sr-only"},b=Object(a["createElementVNode"])("span",{"aria-hidden":"true"},"»",-1),m=[b];function p(e,t,c,l,b,p){return c.meta.totalPages>1?(Object(a["openBlock"])(),Object(a["createElementBlock"])("nav",r,[Object(a["createElementVNode"])("ul",o,[Object(a["createElementVNode"])("li",null,[Object(a["createElementVNode"])("a",{class:Object(a["normalizeClass"])([{"cursor-not-allowed bg-gray-200 dark:bg-gray-900 dark:hover:text-gray-400":!e.isPrev},"px-2 py-2 md:px-3 ml-0 leading-tight text-gray-500 dark:text-gray-400 bg-white rounded-l border border-gray-300 hover:text-blue-500 dark:bg-gray-800 dark:border-gray-700 dark:hover:text-blue-500"]),href:"javascript:void(0)",onClick:t[0]||(t[0]=e=>l.prev())},n,2)]),(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(l.pageRange,(t,c)=>(Object(a["openBlock"])(),Object(a["createElementBlock"])("li",{key:c},["..."===t?(Object(a["openBlock"])(),Object(a["createElementBlock"])("a",s,Object(a["toDisplayString"])(t),1)):(Object(a["openBlock"])(),Object(a["createElementBlock"])("a",{key:1,class:Object(a["normalizeClass"])(`px-2 py-2 md:px-3 leading-tight bg-white border border-gray-300 dark:bg-gray-800 dark:border-gray-700 ${t===e.currentPage?"text-blue-500 font-semibold":"text-gray-500 dark:text-gray-400"} hover:text-blue-500 dark:hover:text-blue-500`),href:"javascript:void(0)",onClick:e=>l.updatePage(t)},[Object(a["createTextVNode"])(Object(a["toDisplayString"])(t)+" ",1),t===e.currentPage?(Object(a["openBlock"])(),Object(a["createElementBlock"])("span",d,"(current)")):Object(a["createCommentVNode"])("",!0)],10,i))]))),128)),Object(a["createElementVNode"])("li",null,[Object(a["createElementVNode"])("a",{class:Object(a["normalizeClass"])([{"cursor-not-allowed bg-gray-200 dark:bg-gray-900 dark:hover:bg-text-400":!e.isNext},"px-2 py-2 md:px-3 leading-tight text-gray-500 bg-white rounded-r border border-gray-300 hover:text-blue-500 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:text-blue-500"]),href:"javascript:void(0)",onClick:t[1]||(t[1]=e=>l.next())},m,2)])])])):Object(a["createCommentVNode"])("",!0)}c("14d9");var j={name:"Pagination",props:["meta"],emits:["page"],setup(e,{emit:t}){const c=Object(a["reactive"])({isPrev:!1,isNext:!1,pagesLimit:5,currentPage:e.meta.currentPage,delta:3}),r=Object(a["computed"])(()=>{const t=e.meta.currentPage,a=e.meta.totalPages,r=t-c.delta,o=t+c.delta+1,l=[],n=[];let s;for(let e=1;e<=a;e++)(1===e||e===a||e>=r&&e<o)&&l.push(e);return l.forEach((function(e){s&&(e-s===2?n.push(s+1):e-s!==1&&n.push("...")),n.push(e),s=e})),n}),o=e=>{e!==c.currentPage&&(c.currentPage=e,s(),t("page",c.currentPage))},l=()=>{c.currentPage>1?c.currentPage--:c.currentPage=1,s(),t("page",c.currentPage)},n=()=>{c.currentPage<e.meta.totalPages?c.currentPage++:c.currentPage=e.meta.totalPages,s(),t("page",c.currentPage)},s=()=>{c.isPrev=c.currentPage>1,c.isNext=c.currentPage<e.meta.totalPages},i=()=>{c.delta=3,/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&(c.delta=1)};return Object(a["onBeforeMount"])(()=>{s(),window.addEventListener("resize",i)}),Object(a["onBeforeUnmount"])(()=>{window.removeEventListener("resize",i)}),{...Object(a["toRefs"])(c),pageRange:r,prev:l,next:n,updatePage:o}}},O=c("6b0d"),u=c.n(O);const g=u()(j,[["render",p]]);t["a"]=g}}]);
//# sourceMappingURL=account-pos-recipients.eae913ab.js.map