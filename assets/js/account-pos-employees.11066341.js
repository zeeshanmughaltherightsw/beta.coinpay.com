(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["account-pos-employees"],{"2c6b":function(e,t,o){},"7c64":function(e,t,o){"use strict";o("2c6b")},efc9:function(e,t,o){"use strict";o.r(t);var r=o("f2bf"),n={class:"card"},s={class:"body"},c={class:"text-right mb-3"},a={class:"table-sm"},l=["onClick"],i={class:"cursor-pointer ml-3 text-base"},d={class:"text-right"},u={key:0,class:"pr-3"},m=["onClick"],b=["onClick"];function p(e,t,o,p,j,O){var f=Object(r["resolveComponent"])("j-button"),g=Object(r["resolveComponent"])("icon"),y=Object(r["resolveComponent"])("pos-layout"),v=Object(r["resolveComponent"])("save-employee-modal"),E=Object(r["resolveComponent"])("pos-login-modal");return Object(r["openBlock"])(),Object(r["createElementBlock"])(r["Fragment"],null,[Object(r["createVNode"])(y,null,{content:Object(r["withCtx"])((function(){return[Object(r["createElementVNode"])("div",n,[Object(r["createElementVNode"])("div",s,[Object(r["createElementVNode"])("div",c,[Object(r["createVNode"])(f,{onClick:t[0]||(t[0]=function(e){return p.launchSaveEmployeeModal()}),type:"button"},{default:Object(r["withCtx"])((function(){return[Object(r["createTextVNode"])(Object(r["toDisplayString"])(p.translate("pos.employees.btn_add")),1)]})),_:1})]),Object(r["createElementVNode"])("table",a,[Object(r["createElementVNode"])("tbody",null,[(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(p.employees,(function(e,t){return Object(r["openBlock"])(),Object(r["createElementBlock"])("tr",{key:t},[Object(r["createElementVNode"])("td",null,[Object(r["createElementVNode"])("div",{class:"flex items-center cursor-pointer",onClick:function(e){return p.login(t)}},[Object(r["createVNode"])(g,{name:"user-circle",classes:"w-8 h-8 ".concat(p.isLoggedIn(e)?"text-blue-500":"")},null,8,["classes"]),Object(r["createElementVNode"])("span",i,Object(r["toDisplayString"])(e.USERNAME),1)],8,l)]),Object(r["createElementVNode"])("td",d,["false"===e.isParentUser?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",u,[p.loggedInEmployee&&"true"===p.loggedInEmployee.isParentUser?(Object(r["openBlock"])(),Object(r["createElementBlock"])("button",{key:0,onClick:function(o){return p.launchSaveEmployeeModal(e,t)},class:"mr-2 hover:text-blue-500"},[Object(r["createVNode"])(g,{name:"edit"})],8,m)):Object(r["createCommentVNode"])("",!0),p.loggedInEmployee&&"true"===p.loggedInEmployee.isParentUser?(Object(r["openBlock"])(),Object(r["createElementBlock"])("button",{key:1,onClick:function(e){return p.deleteEmployee(t)},class:"hover:text-red-500"},[Object(r["createVNode"])(g,{name:"trash"})],8,b)):Object(r["createCommentVNode"])("",!0)])):Object(r["createCommentVNode"])("",!0)])])})),128))])])])])]})),_:1}),Object(r["createVNode"])(v),Object(r["createVNode"])(E)],64)}o("a434");var j=o("66c3"),O=o("4032"),f=o("cdae"),g={class:"flex items-center justify-between"},y={class:"mb-2"},v={class:"flex items-center justify-between mb-1"},E={class:"text-red-700 dark:text-red-400 text-sm"},w={class:"mb-2"},x={class:"flex items-center justify-between mb-1"},h={class:"text-red-700 dark:text-red-400 text-sm"},N={class:"mt-4 text-right"},V={key:0,class:"mr-3"};function k(e,t,o,n,s,c){var a=Object(r["resolveComponent"])("icon"),l=Object(r["resolveComponent"])("j-button"),i=Object(r["resolveComponent"])("modal");return Object(r["openBlock"])(),Object(r["createBlock"])(i,{maxWidth:e.maxWidth,show:e.show,onClose:t[4]||(t[4]=function(e){return n.closeModal()})},{title:Object(r["withCtx"])((function(){return[Object(r["createElementVNode"])("div",g,[Object(r["createElementVNode"])("span",null,Object(r["toDisplayString"])(n.translate("pos.employees.title")),1),Object(r["createElementVNode"])("span",{class:"text-gray-500 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-200 cursor-pointer",onClick:t[0]||(t[0]=function(e){return n.closeModal()})},[Object(r["createVNode"])(a,{name:"close"})])])]})),content:Object(r["withCtx"])((function(){return[Object(r["createElementVNode"])("form",{onSubmit:t[3]||(t[3]=Object(r["withModifiers"])((function(e){return n.submit()}),["prevent"]))},[Object(r["createElementVNode"])("div",y,[Object(r["createElementVNode"])("div",v,[Object(r["createElementVNode"])("label",null,Object(r["toDisplayString"])(n.translate("pos.employees.username")),1),Object(r["createElementVNode"])("div",E,Object(r["toDisplayString"])(n.showError(e.errorBag,"username")),1)]),Object(r["withDirectives"])(Object(r["createElementVNode"])("input",{class:"form-input w-full",type:"text","onUpdate:modelValue":t[1]||(t[1]=function(t){return e.form.username=t})},null,512),[[r["vModelText"],e.form.username]])]),Object(r["createElementVNode"])("div",w,[Object(r["createElementVNode"])("div",x,[Object(r["createElementVNode"])("label",null,Object(r["toDisplayString"])(n.translate("pos.employees.password")),1),Object(r["createElementVNode"])("div",h,Object(r["toDisplayString"])(n.showError(e.errorBag,"password")),1)]),Object(r["withDirectives"])(Object(r["createElementVNode"])("input",{class:"form-input w-full",placeholder:"000000",type:"text","onUpdate:modelValue":t[2]||(t[2]=function(t){return e.form.password=t})},null,512),[[r["vModelText"],e.form.password]])]),Object(r["createElementVNode"])("div",N,[Object(r["createVNode"])(l,{disabled:e.isProcessing},{default:Object(r["withCtx"])((function(){return[e.isProcessing?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",V,[Object(r["createVNode"])(a,{name:"spinner",classes:"w-4 h-4 text-white"})])):Object(r["createCommentVNode"])("",!0),Object(r["createElementVNode"])("span",null,Object(r["toDisplayString"])(n.translate("pos.employees.btn_save")),1)]})),_:1},8,["disabled"])])],32)]})),_:1},8,["maxWidth","show"])}var B=o("5530"),C=(o("b64b"),o("714b")),I=o("ea45"),M=o("2ef0"),S=o("5502"),D=o("8923"),P=o("2e13"),U={name:"SaveEmployeeModal",components:{Modal:C["a"],Icon:f["a"],JButton:O["a"]},setup:function(){var e=Object(r["inject"])("translate"),t=Object(r["inject"])("emitter"),o=Object(r["inject"])("toast"),n=Object(S["b"])(),s=Object(I["a"])(),c=s.showError,a=s.validate,l=Object(P["a"])(),i=l.generateId,d=Object(r["reactive"])({show:!1,maxWidth:"2xl",closeable:!0,employee:null,type:"pin",index:-1,form:{username:"",password:""},errorBag:{},rules:{},messages:null,isProcessing:!1}),u=Object(r["computed"])((function(){return n.state.pos})),m=Object(r["computed"])((function(){return n.state.posCalls}));Object(r["watch"])((function(){return Object(B["a"])({},d.form)}),(function(e,t){Object.keys(d.errorBag).length>0&&(d.errorBag=a(e,d.rules,d.messages))}));var b=function(){d.show=!1},p=function(){if(d.errorBag=a(d.form,d.rules,d.messages),0===Object.keys(d.errorBag).length){d.isProcessing=!0;var e=d.form,t=M["cloneDeep"](u.value.users),r=!0;d.employee?-1===M["findIndex"](t,(function(t){return t.USERNAME===e.username&&t.ID!==d.employee.ID}))?(t[d.index].USERNAME=e.username,t[d.index].PIN=e.password):(r=!1,d.isProcessing=!1,o.error("Username already exists!")):-1===M["findIndex"](t,{USERNAME:e.username})?t.push({ID:i(u.value.users),PIN:e.password,USERNAME:e.username,isLoggedIn:"false",isParentUser:"false"}):(r=!1,d.isProcessing=!1,o.error("Username already exists!")),r&&n.dispatch(D["u"],{call:m.value.users,data:t}).then((function(e){d.isProcessing=!1;var t=d.employee?"Employee updated successfully":"Employee added successfully";o.success(t),b()})).catch((function(e){console.log(e),d.isProcessing=!1,o.error("Internal Server Error")}))}};return Object(r["onBeforeMount"])((function(){t.on("saveEmployeeModal",(function(e){d.employee=e.employee||null,d.index=e.index||-1,d.type=d.employee&&"true"===d.employee.isParentUser?"password":"pin",d.form={username:d.employee?d.employee.USERNAME:"",password:""},d.rules={username:["required"],password:"password"===d.type?["required"]:["required","regex:/^[0-9]{6}$/"]},d.messages={username:{required:"Username is required"},password:{required:"password"===d.type?"Password is required":"PIN is required",regex:"Please enter a 6 digit pin"}},d.show=!0}))})),Object(B["a"])(Object(B["a"])({translate:e},Object(r["toRefs"])(d)),{},{closeModal:b,showError:c,submit:p})}},q=o("6b0d"),L=o.n(q);const R=L()(U,[["render",k]]);var A=R,_={class:"flex items-center justify-between"},W={class:"mb-2"},T={class:"flex items-center justify-between mb-1"},J={class:"text-red-700 dark:text-red-400 text-sm"},F={class:"mb-2"},$={class:"flex items-center justify-between mb-1"},Y={class:"text-red-700 dark:text-red-400 text-sm"},z={class:"text-red-700 dark:text-red-400 text-sm"},G={class:"mt-4 text-right"},H={key:0,class:"mr-3"};function K(e,t,o,n,s,c){var a=Object(r["resolveComponent"])("icon"),l=Object(r["resolveComponent"])("j-button"),i=Object(r["resolveComponent"])("modal");return Object(r["openBlock"])(),Object(r["createBlock"])(i,{maxWidth:e.maxWidth,show:e.show,onClose:t[4]||(t[4]=function(e){return n.closeModal()})},{title:Object(r["withCtx"])((function(){return[Object(r["createElementVNode"])("div",_,[Object(r["createElementVNode"])("span",null,Object(r["toDisplayString"])(n.translate("pos.employees.title")),1),Object(r["createElementVNode"])("span",{class:"text-gray-500 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-200 cursor-pointer",onClick:t[0]||(t[0]=function(e){return n.closeModal()})},[Object(r["createVNode"])(a,{name:"close"})])])]})),content:Object(r["withCtx"])((function(){return[Object(r["createElementVNode"])("form",{onSubmit:t[3]||(t[3]=Object(r["withModifiers"])((function(e){return n.submit()}),["prevent"]))},[Object(r["createElementVNode"])("div",W,[Object(r["createElementVNode"])("div",T,[Object(r["createElementVNode"])("label",null,Object(r["toDisplayString"])(n.translate("pos.employees.username")),1),Object(r["createElementVNode"])("div",J,Object(r["toDisplayString"])(n.showError(e.errorBag,"username")),1)]),Object(r["withDirectives"])(Object(r["createElementVNode"])("input",{class:"form-input w-full",readonly:"",type:"text","onUpdate:modelValue":t[1]||(t[1]=function(t){return e.form.username=t})},null,512),[[r["vModelText"],e.form.username]])]),Object(r["createElementVNode"])("div",F,[Object(r["createElementVNode"])("div",$,[Object(r["createElementVNode"])("label",null,Object(r["toDisplayString"])(n.translate("pos.employees.password")),1),Object(r["createElementVNode"])("div",Y,Object(r["toDisplayString"])(n.showError(e.errorBag,"password")),1)]),Object(r["withDirectives"])(Object(r["createElementVNode"])("input",{class:"form-input w-full",type:"password","onUpdate:modelValue":t[2]||(t[2]=function(t){return e.form.password=t})},null,512),[[r["vModelText"],e.form.password]]),Object(r["createElementVNode"])("div",z,Object(r["toDisplayString"])(n.showError(e.errorBag,"password")),1)]),Object(r["createElementVNode"])("div",G,[Object(r["createVNode"])(l,{disabled:e.isProcessing},{default:Object(r["withCtx"])((function(){return[e.isProcessing?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",H,[Object(r["createVNode"])(a,{name:"spinner",classes:"w-4 h-4 text-white"})])):Object(r["createCommentVNode"])("",!0),Object(r["createElementVNode"])("span",null,Object(r["toDisplayString"])(n.translate("pos.employees.btn_login")),1)]})),_:1},8,["disabled"])])],32)]})),_:1},8,["maxWidth","show"])}o("4de4"),o("d3b7");var Q={name:"PosLoginModal",components:{Modal:C["a"],Icon:f["a"],JButton:O["a"]},setup:function(){var e=Object(r["inject"])("translate"),t=Object(r["inject"])("emitter"),o=Object(r["inject"])("toast"),n=Object(S["b"])(),s=Object(I["a"])(),c=s.showError,a=s.validate,l=Object(r["reactive"])({show:!1,maxWidth:"2xl",closeable:!0,index:-1,loggedInEmployee:null,form:{username:"",password:""},errorBag:{},rules:{},messages:{},isProcessing:!1}),i=Object(r["computed"])((function(){return n.state.pos})),d=Object(r["computed"])((function(){return n.state.posCalls}));Object(r["watch"])((function(){return Object(B["a"])({},l.form)}),(function(e,t){Object.keys(l.errorBag).length>0&&(l.errorBag=a(e,l.rules,l.messages))}));var u=function(){l.show=!1},m=function(){if(l.errorBag=a(l.form,l.rules,l.messages),0===Object.keys(l.errorBag).length){var e=l.form,t=M["cloneDeep"](i.value.users),r=t[l.index];r.USERNAME===e.username&&r.PIN===e.password?(l.loggedInEmployee&&t.filter((function(e){e.ID===l.loggedInEmployee.ID&&e.USERNAME===l.loggedInEmployee.USERNAME&&(e.isLoggedIn="false")})),t[l.index].isLoggedIn="true",n.dispatch(D["u"],{call:d.value.users,data:t}).catch((function(e){console.log(e)})),u()):o.error("Please provide a valid password/pin")}};return Object(r["onBeforeMount"])((function(){t.on("posLoginModal",(function(e){l.loggedInEmployee=e.loggedInEmployee,l.index=e.index,l.type=e.type,l.form={username:e.employee?e.employee.USERNAME:"",password:""},l.rules={username:["required"],password:"password"===l.type?["required"]:["required","regex:/^[0-9]{6}$/"]},l.messages={username:{required:"Username is required"},password:{required:"password"===l.type?"Password is required":"PIN is required",regex:"Please enter a 6 digit pin"}},l.show=!0}))})),Object(B["a"])(Object(B["a"])({translate:e},Object(r["toRefs"])(l)),{},{showError:c,closeModal:u,submit:m})}};const X=L()(Q,[["render",K]]);var Z=X,ee={name:"Employees",components:{"pos-layout":j["a"],JButton:O["a"],Icon:f["a"],SaveEmployeeModal:A,PosLoginModal:Z},setup:function(){var e=Object(r["inject"])("translate"),t=Object(r["inject"])("emitter"),o=Object(r["inject"])("swal"),n=Object(r["inject"])("toast"),s=Object(S["b"])(),c=Object(r["computed"])((function(){return s.state.pos})),a=Object(r["computed"])((function(){return s.state.posCalls})),l=Object(r["computed"])((function(){return c.value.users})),i=Object(r["computed"])((function(){return M["find"](c.value.users,{isLoggedIn:"true"})})),d=function(e){return i.value&&e.ID===i.value.ID},u=function(e){var o=M["cloneDeep"](c.value.users),r=o[e],n="true"===r.isParentUser?"password":"pin";"false"!==r.isLoggedIn&&r.ID===i.value.ID||t.emit("posLoginModal",{employee:r,type:n,loggedInEmployee:i.value,index:e})},m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;t.emit("saveEmployeeModal",{employee:e,index:o})},b=function(e){o.fire({title:"Employee",text:"Are you sure, want to delete this employee?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"Yes",cancelButtonText:"No",focusCancel:!0,customClass:{container:"swal2-tailwind"}}).then((function(t){var o=t.value;if(o&&!0===o){var r=M["cloneDeep"](c.value.users);r.splice(e,1),s.dispatch(D["u"],{call:a.value.users,data:r}).then((function(e){n.success("Employee deleted successfully")})).catch((function(e){console.log(e),n.error("Internal Server Error")}))}}))};return{translate:e,employees:l,loggedInEmployee:i,isLoggedIn:d,login:u,launchSaveEmployeeModal:m,deleteEmployee:b}}};o("7c64");const te=L()(ee,[["render",p],["__scopeId","data-v-733d1af0"]]);t["default"]=te}}]);
//# sourceMappingURL=account-pos-employees.11066341.js.map