{"version":3,"sources":["webpack:///./src/views/pos/Favourites.vue?9d51","webpack:///./src/views/pos/Favourites.vue","webpack:///./src/views/pos/Favourites.vue?3d56"],"names":["class","_createElementVNode","value","colspan","_createVNode","_component_pos_layout","content","_hoisted_1","_component_nav_tabs","_hoisted_2","_hoisted_3","_hoisted_4","onClick","_ctx","_component_icon","name","aria-label","_hoisted_5","_createElementBlock","_Fragment","$setup","category","index","key","id","_hoisted_7","classes","type","_hoisted_8","_component_StreamBarcodeReader","onDecode","onError","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","style","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","length","product","categoryID","_hoisted_19","src","imageUri","alt","_hoisted_22","itemName","sku","stock","price","_hoisted_26","_hoisted_30","_createBlock","_component_pagination","meta","onPage","_component_add_to_cart_modal","components","NavTabs","POSLayout","Icon","Pagination","StreamBarcodeReader","AddToCartModal","setup","translate","inject","toast","emitter","store","useStore","route","useRoute","fancyBox","compositionUtils","state","reactive","employee","keyword","categoryId","sortKey","order","currentPage","totalPages","limit","offset","isBarcodeScanner","accountInfo","computed","altCoins","pos","filteredFavourites","trim","toLowerCase","favourites","filter","_","description","Number","paginatedFavourites","filteredFavouritesList","map","p","parseFloat","slice","currency","PayoutCurrencyShortName","altCoin","ShortName","LongName","watch","newVal","oldVal","Math","ceil","sort","getCategoryName","categories","getCategoryColorCode","categoryColourCode","isFavourite","updatePage","page","markFavourite","push","success","splice","posData","commit","SET_POS","result","launchAddToCartModal","error","console","log","emit","warning","onBeforeMount","users","isLoggedIn","onMounted","Object","keys","query","category_id","toRefs","__exports__","render"],"mappings":"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","file":"assets/js/account-pos-favourites.1fe10f20.js","sourcesContent":["export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./Favourites.vue?vue&type=style&index=0&id=231d94e3&scoped=true&lang=scss\"","<template>\r\n  <pos-layout>\r\n    <template v-slot:content>\r\n      <div class=\"card\">\r\n        <nav-tabs></nav-tabs>\r\n        <hr class=\"border-gray-300 dark:border-gray-600\"/>\r\n        <div class=\"body\">\r\n          <div class=\"flex items-center justify-end mb-3 flex-col lg:flex-row\">\r\n            <span\r\n              class=\"hover:text-blue-500 mb-3 lg:mb-0 ml-0 lg:ml-3 cursor-pointer w-full lg:w-auto\"\r\n              @click=\"isBarcodeScanner = !isBarcodeScanner\">\r\n              <icon name=\"barcode\"></icon>\r\n            </span>\r\n            <select aria-label=\"Select Category\" class=\"form-select w-full mb-3 lg:mb-0 ml-0 lg:ml-3 w-full lg:w-72\"\r\n                    v-model=\"categoryId\">\r\n              <option value>Select Category</option>\r\n              <option :key=\"index\" :value=\"category.id\" v-for=\"(category, index) in categories\">\r\n                {{ category.name }}\r\n              </option>\r\n            </select>\r\n            <div class=\"relative mb-3 lg:mb-0 ml-0 lg:ml-3 w-full lg:w-auto\">\r\n              <icon classes=\"absolute w-5 h-5 top-3 left-3 dark:text-gray-300\" name=\"search\"></icon>\r\n              <input v-model=\"keyword\" aria-label=\"Search...\" class=\"form-input px-10 w-full lg:w-auto\" type=\"text\"/>\r\n              <span v-if=\"keyword !== ''\" class=\"absolute top-3 right-3 dark:text-gray-400 cursor-pointer\"\r\n                    @click=\"keyword = ''\">\r\n                <icon classes=\"w-5 h-5\" name=\"close\"></icon>\r\n              </span>\r\n            </div>\r\n          </div>\r\n          <div class=\"mx-auto mb-3 w-40\" v-if=\"isBarcodeScanner\">\r\n            <StreamBarcodeReader @decode=\"onDecode\" @error=\"onError\"></StreamBarcodeReader>\r\n          </div>\r\n          <div\r\n            class=\"w-full scrollbar scrollbar-thin scrollbar-thumb-gray-400 scrollbar-track-gray-200 dark:scrollbar-track-gray-900 dark:scrollbar-thumb-gray-600\">\r\n            <table class=\"table-sm mb-2\">\r\n              <thead>\r\n              <tr>\r\n                <th>Category</th>\r\n                <th>Image</th>\r\n                <th @click=\"sort('itemName')\" class=\"cursor-pointer\" style=\"max-width: 150px;\">\r\n                  <div class=\"flex items-center\">\r\n                    Name\r\n                    <span :class=\"`ml-4 transform transition-all ${order === 'asc' ? 'rotate-180' : ''}`\"\r\n                          v-if=\"sortKey === 'itemName'\">\r\n                      <icon name=\"sort\" classes=\"w-4 h-4\"></icon>\r\n                    </span>\r\n                  </div>\r\n                </th>\r\n                <th class=\"whitespace-nowrap\">SKU / EAN / Barcode / QR</th>\r\n                <th>Quantity</th>\r\n                <th @click=\"sort('price')\" class=\"cursor-pointer\">\r\n                  <div class=\"flex items-center\">\r\n                    Price\r\n                    <span :class=\"`ml-4 transform transition-all ${order === 'asc' ? 'rotate-180' : ''}`\"\r\n                          v-if=\"sortKey === 'price'\">\r\n                      <icon name=\"sort\" classes=\"w-4 h-4\"></icon>\r\n                    </span>\r\n                  </div>\r\n                </th>\r\n                <th>Actions</th>\r\n              </tr>\r\n              </thead>\r\n              <tbody>\r\n              <template v-if=\"filteredFavourites.length > 0\">\r\n                <tr :key=\"index\" v-for=\"(product, index) in paginatedFavourites\">\r\n                  <td>\r\n                    <div @click=\"categoryId = product.categoryID\" class=\"cursor-pointer flex items-center\">\r\n                      <div :style=\"'background: #' + getCategoryColorCode(product.categoryID)\"\r\n                           class=\"inline-block w-5 h-5 rounded-full mr-3\"></div>\r\n                      {{ getCategoryName(product.categoryID) }}\r\n                    </div>\r\n                  </td>\r\n                  <td>\r\n                    <div class=\"w-12 h-12 rounded-full overflow-hidden\">\r\n                      <img :src=\"product.imageUri\" alt=\"\" class=\"w-12 h-12 object-cover\"\r\n                           @click=\"fancyBox(product.imageUri)\"/>\r\n                    </div>\r\n                  </td>\r\n                  <td @click=\"launchAddToCartModal(product)\" class=\"cursor-pointer whitespace-normal\"\r\n                      style=\"width: 150px;\">\r\n                    <p class=\"break-all\">{{ product.itemName }}</p>\r\n                  </td>\r\n                  <td @click=\"launchAddToCartModal(product)\" class=\"cursor-pointer\">{{ product.sku }}</td>\r\n                  <td @click=\"launchAddToCartModal(product)\" class=\"cursor-pointer\">{{ product.stock }}</td>\r\n                  <td @click=\"launchAddToCartModal(product)\" class=\"cursor-pointer\">\r\n                    {{ `${product.price} ${currency}` }}\r\n                  </td>\r\n                  <td>\r\n                    <div class=\"flex items-center space-x-1\">\r\n                      <button @click=\"launchAddToCartModal(product)\"\r\n                              class=\"hover:text-blue-500\" type=\"button\">\r\n                        <icon name=\"shopping-cart\"></icon>\r\n                      </button>\r\n                      <button @click=\"markFavourite(product, index)\">\r\n                        <icon name=\"heart\"\r\n                              :classes=\"`w-6 h-6 hover:text-red-500 ${isFavourite(product) ? 'text-red-500' : ''}`\"></icon>\r\n                      </button>\r\n                    </div>\r\n                  </td>\r\n                </tr>\r\n              </template>\r\n              <template v-else>\r\n                <tr>\r\n                  <td colspan=\"7\" class=\"text-center\">{{ translate('address_book.empty') }}</td>\r\n                </tr>\r\n              </template>\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n          <template v-if=\"filteredFavourites.length > 0\">\r\n            <pagination :meta=\"meta\" @page=\"updatePage\"></pagination>\r\n          </template>\r\n        </div>\r\n      </div>\r\n    </template>\r\n  </pos-layout>\r\n  <!-- Add To Cart Modal -->\r\n  <add-to-cart-modal></add-to-cart-modal>\r\n</template>\r\n\r\n<script>\r\nimport POSLayout from '@/components/layouts/POSLayout'\r\nimport NavTabs from '@/components/account/pos/NavTabs'\r\nimport Icon from '@/components/Icon'\r\nimport Pagination from '@/components/common/Pagination'\r\nimport AddToCartModal from '@/components/account/pos/modals/products/AddToCartModal'\r\nimport { StreamBarcodeReader } from 'vue-barcode-reader'\r\nimport { computed, inject, onBeforeMount, onMounted, reactive, toRefs, watch } from 'vue'\r\nimport { useStore } from 'vuex'\r\nimport * as _ from 'lodash'\r\nimport { SET_POS } from '@/store/keys'\r\nimport { useRoute } from 'vue-router'\r\nimport compositionUtils from '@/compositionUtils'\r\n\r\nexport default {\r\n  name: 'Favourites',\r\n  components: {\r\n    NavTabs,\r\n    'pos-layout': POSLayout,\r\n    Icon,\r\n    Pagination,\r\n    StreamBarcodeReader,\r\n    AddToCartModal\r\n  },\r\n  setup () {\r\n    // Providers\r\n    const translate = inject('translate')\r\n    const toast = inject('toast')\r\n    const emitter = inject('emitter')\r\n    // Store\r\n    const store = useStore()\r\n    const route = useRoute()\r\n\r\n    const { fancyBox } = compositionUtils()\r\n\r\n    // State\r\n    const state = reactive({\r\n      employee: null,\r\n      keyword: '',\r\n      categoryId: '',\r\n      sortKey: null,\r\n      order: 'asc',\r\n      meta: {\r\n        currentPage: 1,\r\n        totalPages: 0,\r\n        limit: 25,\r\n        offset: 0\r\n      },\r\n      isBarcodeScanner: false\r\n    })\r\n\r\n    // Computed\r\n    const accountInfo = computed(() => store.state.accountInfo)\r\n    const altCoins = computed(() => store.state.altCoins)\r\n    const pos = computed(() => store.state.pos)\r\n    const filteredFavourites = computed(() => {\r\n      if (state.keyword || state.categoryId) {\r\n        const keyword = state.keyword.trim().toLowerCase()\r\n        return pos.value.favourites.filter(product => {\r\n          if (state.categoryId && keyword) {\r\n            return (product.categoryID === state.categoryId &&\r\n              (_.includes(product.itemName.toLowerCase(), keyword) ||\r\n                _.includes(product.sku.toLowerCase(), keyword) ||\r\n                _.includes(product.description.toLowerCase(), keyword) ||\r\n                Number(product.price) === Number(keyword)\r\n              )\r\n            )\r\n          } else if (state.categoryId) {\r\n            return product.categoryID === state.categoryId\r\n          } else if (keyword) {\r\n            return (\r\n              _.includes(product.itemName.toLowerCase(), keyword) ||\r\n              _.includes(product.sku.toLowerCase(), keyword) ||\r\n              _.includes(product.description.toLowerCase(), keyword) ||\r\n              Number(product.price) === Number(keyword)\r\n            )\r\n          }\r\n        })\r\n      }\r\n      return pos.value.favourites\r\n    })\r\n    const paginatedFavourites = computed(() => {\r\n      if (filteredFavourites.value && filteredFavourites.value.length > 0) {\r\n        let filteredFavouritesList = _.cloneDeep(filteredFavourites.value)\r\n        filteredFavouritesList = filteredFavouritesList.map(p => {\r\n          return {\r\n            ...p,\r\n            price: Number.parseFloat(p.price)\r\n          }\r\n        })\r\n        filteredFavouritesList = _.orderBy(filteredFavouritesList, state.sortKey, state.order)\r\n        return filteredFavouritesList.slice(state.meta.offset, state.meta.currentPage * state.meta.limit)\r\n      }\r\n      return filteredFavourites.value\r\n    })\r\n    const currency = computed(() => {\r\n      let currency = 'EUR'\r\n      if (accountInfo.value) {\r\n        currency = accountInfo.value.PayoutCurrencyShortName\r\n        // Convert short name to long name\r\n        const altCoin = _.find(altCoins.value, { ShortName: accountInfo.value.PayoutCurrencyShortName })\r\n        if (altCoin) {\r\n          currency = altCoin.LongName\r\n        }\r\n      }\r\n      return currency\r\n    })\r\n\r\n    // Watch\r\n    watch(() => state.keyword,\r\n      (newVal, oldVal) => {\r\n        state.meta = {\r\n          ...state.meta,\r\n          currentPage: 1,\r\n          totalPages: Math.ceil(filteredFavourites.value.length / state.meta.limit),\r\n          offset: 0\r\n        }\r\n      })\r\n\r\n    // Methods\r\n    const sort = (key) => {\r\n      if (key === state.sortKey) {\r\n        state.order = state.order === 'asc' ? 'desc' : 'asc'\r\n      }\r\n      state.sortKey = key\r\n    }\r\n    const getCategoryName = (id) => {\r\n      const category = _.find(pos.value.categories, { id: id })\r\n      return category ? category.name : ''\r\n    }\r\n    const getCategoryColorCode = (id) => {\r\n      const category = _.find(pos.value.categories, { id: id })\r\n      return category ? category.categoryColourCode : ''\r\n    }\r\n    const isFavourite = (product) => {\r\n      if (product.sku) {\r\n        return _.findIndex(pos.value.favourites, { sku: product.sku }) !== -1\r\n      } else if (product.id) {\r\n        return _.findIndex(pos.value.favourites, { id: product.id }) !== -1\r\n      }\r\n      return false\r\n    }\r\n    const updatePage = (page) => {\r\n      state.meta = {\r\n        ...state.meta,\r\n        currentPage: page,\r\n        offset: (page - 1) * state.meta.limit\r\n      }\r\n    }\r\n    // Mark favourite\r\n    const markFavourite = (product) => {\r\n      const favourites = _.cloneDeep(pos.value.favourites)\r\n      let index = -1\r\n      if (product.sku) {\r\n        index = _.findIndex(favourites, { sku: product.sku })\r\n      } else if (product.id) {\r\n        index = _.findIndex(favourites, { id: product.id })\r\n      }\r\n      if (index === -1) {\r\n        favourites.push(product)\r\n        toast.success('Product marked favourite successfully')\r\n      } else {\r\n        favourites.splice(index, 1)\r\n        toast.success('Product unmarked favourite successfully')\r\n      }\r\n      const posData = _.cloneDeep(pos.value)\r\n      posData.favourites = favourites\r\n      store.commit(SET_POS, posData)\r\n    }\r\n    const onDecode = (result) => {\r\n      state.keyword = result\r\n      state.isBarcodeScanner = false\r\n      const product = _.find(pos.value.favourites, { sku: result })\r\n      if (product) {\r\n        launchAddToCartModal(product)\r\n      }\r\n    }\r\n    const onError = (error) => {\r\n      console.log(error)\r\n    }\r\n    const launchAddToCartModal = (product) => {\r\n      if (Number(product.stock) > 0) {\r\n        emitter.emit('addToCartModal', {\r\n          product: product,\r\n          currency: currency.value,\r\n          employee: state.employee\r\n        })\r\n      } else {\r\n        toast.warning('Product out of stock')\r\n      }\r\n    }\r\n\r\n    onBeforeMount(() => {\r\n      state.employee = _.find(pos.value.users, { isLoggedIn: 'true' })\r\n      state.meta = {\r\n        ...state.meta,\r\n        currentPage: 1,\r\n        totalPages: Math.ceil(filteredFavourites.value.length / state.meta.limit),\r\n        offset: 0\r\n      }\r\n    })\r\n\r\n    onMounted(() => {\r\n      if (Object.keys(route.query).length > 0 && typeof route.query.category_id !== 'undefined') {\r\n        state.categoryId = route.query.category_id\r\n      }\r\n    })\r\n\r\n    return {\r\n      translate,\r\n      ...toRefs(state),\r\n      filteredFavourites,\r\n      paginatedFavourites,\r\n      categories: pos.value.categories,\r\n      sort,\r\n      updatePage,\r\n      getCategoryName,\r\n      getCategoryColorCode,\r\n      isFavourite,\r\n      currency,\r\n      markFavourite,\r\n      onDecode,\r\n      onError,\r\n      launchAddToCartModal,\r\n      fancyBox\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n.table-sm {\r\n  thead {\r\n    tr {\r\n      th:first-child {\r\n        @apply pl-3;\r\n      }\r\n    }\r\n  }\r\n\r\n  tbody {\r\n    tr {\r\n      td:first-child {\r\n        @apply pl-3;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n","import { render } from \"./Favourites.vue?vue&type=template&id=231d94e3&scoped=true\"\nimport script from \"./Favourites.vue?vue&type=script&lang=js\"\nexport * from \"./Favourites.vue?vue&type=script&lang=js\"\n\nimport \"./Favourites.vue?vue&type=style&index=0&id=231d94e3&scoped=true&lang=scss\"\n\nimport exportComponent from \"C:\\\\Users\\\\zeesh\\\\OneDrive\\\\Desktop\\\\Cointopay\\\\cointopay.com.frontend.vuejs3.paymentfocus\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-231d94e3\"]])\n\nexport default __exports__"],"sourceRoot":""}