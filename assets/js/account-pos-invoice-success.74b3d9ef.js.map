{"version":3,"file":"assets/js/account-pos-invoice-success.74b3d9ef.js","mappings":"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","sources":["webpack://cointopay/./src/views/pos/Success.vue","webpack://cointopay/./src/views/pos/Success.vue?9f37"],"sourcesContent":["<template>\r\n  <pos-layout>\r\n    <template v-slot:content>\r\n      <div class=\"text-center\" v-if=\"ticket && ticket.paymentRequest\">\r\n        <icon name=\"check-circle\" classes=\"w-24 h-24 text-green-500 mx-auto\"></icon>\r\n        <p class=\"font-bold text-green-500 mb-4\">\r\n          Invoice #{{ ticket.paymentRequest.TransactionID }} has been paid successfully!\r\n        </p>\r\n        <div class=\"w-full md:w-3/5 mx-auto mb-3\">\r\n          <form @submit.prevent=\"submit()\">\r\n            <div class=\"flex items-center mb-1\">\r\n              <div style=\"flex-grow: 1\">\r\n                <input :placeholder=\"translate('pos.receipts.email')\"\r\n                       aria-label=\"Email\" class=\"form-input w-full\" type=\"email\" v-model=\"form.email\"/>\r\n              </div>\r\n              <button :disabled=\"isProcessing\" class=\"btn btn-success ml-3\">\r\n                <span v-if=\"isProcessing\" class=\"mr-3\">\r\n                  <icon :name=\"'spinner'\" classes=\"w-4 h-4 text-white\"></icon>\r\n                </span>\r\n                <span>{{ translate('pos.receipts.btn_send_receipt') }}</span>\r\n              </button>\r\n            </div>\r\n          </form>\r\n          <div class=\"text-blue-500 text-sm text-left\">{{ showError(errorBag, 'email') }}</div>\r\n        </div>\r\n        <routerLink class=\"btn btn-primary\" tag=\"a\" :to=\"{name: 'account-pos-products'}\">\r\n          Create New Order\r\n        </routerLink>\r\n      </div>\r\n    </template>\r\n  </pos-layout>\r\n</template>\r\n\r\n<script>\r\nimport POSLayout from '@/components/layouts/POSLayout'\r\nimport Icon from '@/components/Icon'\r\nimport { computed, inject, onBeforeMount, reactive, toRefs, watch } from 'vue'\r\nimport { useRoute, useRouter } from 'vue-router'\r\nimport { useStore } from 'vuex'\r\nimport validator from '@/validator'\r\nimport * as _ from 'lodash'\r\nimport moment from 'moment'\r\n\r\nexport default {\r\n  name: 'Success',\r\n  components: {\r\n    'pos-layout': POSLayout,\r\n    Icon\r\n  },\r\n  setup () {\r\n    // Providers\r\n    const translate = inject('translate')\r\n    const http = inject('http')\r\n    const toast = inject('toast')\r\n\r\n    const store = useStore()\r\n    const route = useRoute()\r\n    const router = useRouter()\r\n\r\n    const {\r\n      showError,\r\n      validate\r\n    } = validator()\r\n\r\n    // State\r\n    const state = reactive({\r\n      ticket: null,\r\n      form: {\r\n        email: ''\r\n      },\r\n      errorBag: {},\r\n      rules: {\r\n        email: ['required', 'email']\r\n      },\r\n      messages: {\r\n        email: {\r\n          required: 'Email address is required',\r\n          email: 'Please provide a valid email address'\r\n        }\r\n      },\r\n      isProcessing: false\r\n    })\r\n\r\n    // Computed\r\n    const user = computed(() => store.state.user)\r\n    const pos = computed(() => store.state.pos)\r\n    const receipt = computed(() => {\r\n      const receipt = _.find(\r\n        pos.value.receipts, receipt => receipt.TICKETNUMBER === state.ticket.ticketId.toString()\r\n      )\r\n      if (receipt) {\r\n        receipt.items = pos.value.receiptItems.filter(item => item.RECIEPT_ID === receipt.ID)\r\n      }\r\n      return receipt\r\n    })\r\n\r\n    // Watch\r\n    watch(() => ({ ...state.form }),\r\n      (newVal, oldVal) => {\r\n        if (Object.keys(state.errorBag).length > 0) {\r\n          state.errorBag = validate(newVal, state.rules, state.messages)\r\n        }\r\n      }\r\n    )\r\n\r\n    // Method\r\n    const apiBaseUrl = process.env.VUE_APP_API_URL\r\n    const submit = () => {\r\n      state.errorBag = validate(state.form, state.rules, state.messages)\r\n      if (Object.keys(state.errorBag).length === 0 && receipt.value) {\r\n        state.isProcessing = true\r\n        const ticketReceipt = {\r\n          'Receipt ID': receipt.value.ID,\r\n          Time: moment(new Date(Number(receipt.value.DATE))).format('DD/MM/YYYY H:mm A'),\r\n          'Total Amount': receipt.value.TOTAL + ' ' + receipt.value.CURRENCY,\r\n          Cashier: receipt.value.CASHIER,\r\n          Items: receipt.value.items\r\n        }\r\n        const payload = {\r\n          Call: 'POSRECEIPT',\r\n          MerchantID: Number(user.value.ID),\r\n          APIKey: user.value.APIKey,\r\n          email: state.form.email,\r\n          ticketData: JSON.stringify(ticketReceipt),\r\n          output: 'json'\r\n        }\r\n        const encodeForm = data => {\r\n          return Object.keys(data).map(key => encodeURIComponent(key) + '=' + encodeURIComponent(data[key])).join('&')\r\n        }\r\n        http.post(`${apiBaseUrl}/v2REAPI`, encodeForm(payload), {\r\n          headers: {\r\n            'Content-Type': 'application/x-www-form-urlencoded'\r\n          }\r\n        }).then(response => {\r\n          state.isProcessing = false\r\n          if (response.data) {\r\n            state.form.email = ''\r\n            toast.success('Receipt sent successfully')\r\n          }\r\n          router.push({ name: 'account-pos-products' })\r\n        }).catch(error => {\r\n          state.isProcessing = false\r\n          console.log(error)\r\n        })\r\n      }\r\n    }\r\n\r\n    onBeforeMount(() => {\r\n      if (Object.keys(route.params).length > 0 && route.params.ticketId) {\r\n        state.ticket = _.find(pos.value.tickets, { ticketId: route.params.ticketId })\r\n      }\r\n    })\r\n\r\n    return {\r\n      translate,\r\n      ...toRefs(state),\r\n      showError,\r\n      submit\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped></style>\r\n","import { render } from \"./Success.vue?vue&type=template&id=02b8e37c\"\nimport script from \"./Success.vue?vue&type=script&lang=js\"\nexport * from \"./Success.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"C:\\\\Users\\\\TRS 37\\\\Desktop\\\\Zeeshan\\\\Cointopay\\\\cointopay.com.frontend.vuejs3.paymentfocus\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["class","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","style","_hoisted_6","_hoisted_7","_hoisted_8","key","_hoisted_9","_hoisted_10","_createTextVNode","render","_ctx","_cache","_component_icon","_resolveComponent","_component_routerLink","_component_pos_layout","_openBlock","_createBlock","content","paymentRequest","_createElementBlock","_hoisted_1","_createVNode","name","classes","_createElementVNode","TransactionID","onSubmit","$setup","placeholder","type","email","_vModelText","disabled","_createCommentVNode","tag","to","default","components","POSLayout","Icon","setup","translate","inject","http","toast","store","useStore","route","useRoute","router","useRouter","showError","validate","validator","state","reactive","ticket","form","errorBag","rules","messages","required","isProcessing","user","computed","pos","receipt","_","value","receipts","TICKETNUMBER","ticketId","toString","items","receiptItems","filter","item","RECIEPT_ID","ID","watch","newVal","oldVal","Object","keys","length","apiBaseUrl","process","submit","ticketReceipt","Time","moment","Date","Number","DATE","format","TOTAL","CURRENCY","Cashier","CASHIER","Items","payload","Call","MerchantID","APIKey","ticketData","JSON","stringify","output","encodeForm","data","map","encodeURIComponent","join","post","headers","then","response","success","push","catch","error","console","log","onBeforeMount","params","tickets","toRefs","__exports__"],"sourceRoot":""}