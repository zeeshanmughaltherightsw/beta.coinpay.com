"use strict";(self["webpackChunkcointopay"]=self["webpackChunkcointopay"]||[]).push([[118],{6216:function(e,t,o){o.r(t),o.d(t,{default:function(){return X}});var a=o(821);const r=e=>((0,a.pushScopeId)("data-v-231d94e3"),e=e(),(0,a.popScopeId)(),e),l={class:"card"},c=r((()=>(0,a.createElementVNode)("hr",{class:"border-gray-300 dark:border-gray-600"},null,-1))),n={class:"body"},s={class:"flex items-center justify-end mb-3 flex-col lg:flex-row"},d=r((()=>(0,a.createElementVNode)("option",{value:""},"Select Category",-1))),i=["value"],u={class:"relative mb-3 lg:mb-0 ml-0 lg:ml-3 w-full lg:w-auto"},m={key:0,class:"mx-auto mb-3 w-40"},p={class:"w-full scrollbar scrollbar-thin scrollbar-thumb-gray-400 scrollbar-track-gray-200 dark:scrollbar-track-gray-900 dark:scrollbar-thumb-gray-600"},y={class:"table-sm mb-2"},g=r((()=>(0,a.createElementVNode)("th",null,"Category",-1))),k=r((()=>(0,a.createElementVNode)("th",null,"Image",-1))),v={class:"flex items-center"},N=(0,a.createTextVNode)(" Name "),f=r((()=>(0,a.createElementVNode)("th",{class:"whitespace-nowrap"},"SKU / EAN / Barcode / QR",-1))),C=r((()=>(0,a.createElementVNode)("th",null,"Quantity",-1))),V={class:"flex items-center"},h=(0,a.createTextVNode)(" Price "),E=r((()=>(0,a.createElementVNode)("th",null,"Actions",-1))),w=["onClick"],b={class:"w-12 h-12 rounded-full overflow-hidden"},B=["src","onClick"],x=["onClick"],I={class:"break-all"},S=["onClick"],D=["onClick"],P=["onClick"],F={class:"flex items-center space-x-1"},M=["onClick"],T=["onClick"],L={key:1},A={colspan:"7",class:"text-center"};function j(e,t,o,r,j,K){const Z=(0,a.resolveComponent)("nav-tabs"),R=(0,a.resolveComponent)("icon"),U=(0,a.resolveComponent)("StreamBarcodeReader"),_=(0,a.resolveComponent)("pagination"),q=(0,a.resolveComponent)("pos-layout"),z=(0,a.resolveComponent)("add-to-cart-modal");return(0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,null,[(0,a.createVNode)(q,null,{content:(0,a.withCtx)((()=>[(0,a.createElementVNode)("div",l,[(0,a.createVNode)(Z),c,(0,a.createElementVNode)("div",n,[(0,a.createElementVNode)("div",s,[(0,a.createElementVNode)("span",{class:"hover:text-blue-500 mb-3 lg:mb-0 ml-0 lg:ml-3 cursor-pointer w-full lg:w-auto",onClick:t[0]||(t[0]=t=>e.isBarcodeScanner=!e.isBarcodeScanner)},[(0,a.createVNode)(R,{name:"barcode"})]),(0,a.withDirectives)((0,a.createElementVNode)("select",{"aria-label":"Select Category",class:"form-select w-full mb-3 lg:mb-0 ml-0 lg:ml-3 w-full lg:w-72","onUpdate:modelValue":t[1]||(t[1]=t=>e.categoryId=t)},[d,((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(r.categories,((e,t)=>((0,a.openBlock)(),(0,a.createElementBlock)("option",{key:t,value:e.id},(0,a.toDisplayString)(e.name),9,i)))),128))],512),[[a.vModelSelect,e.categoryId]]),(0,a.createElementVNode)("div",u,[(0,a.createVNode)(R,{classes:"absolute w-5 h-5 top-3 left-3 dark:text-gray-300",name:"search"}),(0,a.withDirectives)((0,a.createElementVNode)("input",{"onUpdate:modelValue":t[2]||(t[2]=t=>e.keyword=t),"aria-label":"Search...",class:"form-input px-10 w-full lg:w-auto",type:"text"},null,512),[[a.vModelText,e.keyword]]),""!==e.keyword?((0,a.openBlock)(),(0,a.createElementBlock)("span",{key:0,class:"absolute top-3 right-3 dark:text-gray-400 cursor-pointer",onClick:t[3]||(t[3]=t=>e.keyword="")},[(0,a.createVNode)(R,{classes:"w-5 h-5",name:"close"})])):(0,a.createCommentVNode)("",!0)])]),e.isBarcodeScanner?((0,a.openBlock)(),(0,a.createElementBlock)("div",m,[(0,a.createVNode)(U,{onDecode:r.onDecode,onError:r.onError},null,8,["onDecode","onError"])])):(0,a.createCommentVNode)("",!0),(0,a.createElementVNode)("div",p,[(0,a.createElementVNode)("table",y,[(0,a.createElementVNode)("thead",null,[(0,a.createElementVNode)("tr",null,[g,k,(0,a.createElementVNode)("th",{onClick:t[4]||(t[4]=e=>r.sort("itemName")),class:"cursor-pointer",style:{"max-width":"150px"}},[(0,a.createElementVNode)("div",v,[N,"itemName"===e.sortKey?((0,a.openBlock)(),(0,a.createElementBlock)("span",{key:0,class:(0,a.normalizeClass)("ml-4 transform transition-all "+("asc"===e.order?"rotate-180":""))},[(0,a.createVNode)(R,{name:"sort",classes:"w-4 h-4"})],2)):(0,a.createCommentVNode)("",!0)])]),f,C,(0,a.createElementVNode)("th",{onClick:t[5]||(t[5]=e=>r.sort("price")),class:"cursor-pointer"},[(0,a.createElementVNode)("div",V,[h,"price"===e.sortKey?((0,a.openBlock)(),(0,a.createElementBlock)("span",{key:0,class:(0,a.normalizeClass)("ml-4 transform transition-all "+("asc"===e.order?"rotate-180":""))},[(0,a.createVNode)(R,{name:"sort",classes:"w-4 h-4"})],2)):(0,a.createCommentVNode)("",!0)])]),E])]),(0,a.createElementVNode)("tbody",null,[r.filteredFavourites.length>0?((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,{key:0},(0,a.renderList)(r.paginatedFavourites,((t,o)=>((0,a.openBlock)(),(0,a.createElementBlock)("tr",{key:o},[(0,a.createElementVNode)("td",null,[(0,a.createElementVNode)("div",{onClick:o=>e.categoryId=t.categoryID,class:"cursor-pointer flex items-center"},[(0,a.createElementVNode)("div",{style:(0,a.normalizeStyle)("background: #"+r.getCategoryColorCode(t.categoryID)),class:"inline-block w-5 h-5 rounded-full mr-3"},null,4),(0,a.createTextVNode)(" "+(0,a.toDisplayString)(r.getCategoryName(t.categoryID)),1)],8,w)]),(0,a.createElementVNode)("td",null,[(0,a.createElementVNode)("div",b,[(0,a.createElementVNode)("img",{src:t.imageUri,alt:"",class:"w-12 h-12 object-cover",onClick:e=>r.fancyBox(t.imageUri)},null,8,B)])]),(0,a.createElementVNode)("td",{onClick:e=>r.launchAddToCartModal(t),class:"cursor-pointer whitespace-normal",style:{width:"150px"}},[(0,a.createElementVNode)("p",I,(0,a.toDisplayString)(t.itemName),1)],8,x),(0,a.createElementVNode)("td",{onClick:e=>r.launchAddToCartModal(t),class:"cursor-pointer"},(0,a.toDisplayString)(t.sku),9,S),(0,a.createElementVNode)("td",{onClick:e=>r.launchAddToCartModal(t),class:"cursor-pointer"},(0,a.toDisplayString)(t.stock),9,D),(0,a.createElementVNode)("td",{onClick:e=>r.launchAddToCartModal(t),class:"cursor-pointer"},(0,a.toDisplayString)(`${t.price} ${r.currency}`),9,P),(0,a.createElementVNode)("td",null,[(0,a.createElementVNode)("div",F,[(0,a.createElementVNode)("button",{onClick:e=>r.launchAddToCartModal(t),class:"hover:text-blue-500",type:"button"},[(0,a.createVNode)(R,{name:"shopping-cart"})],8,M),(0,a.createElementVNode)("button",{onClick:e=>r.markFavourite(t,o)},[(0,a.createVNode)(R,{name:"heart",classes:"w-6 h-6 hover:text-red-500 "+(r.isFavourite(t)?"text-red-500":"")},null,8,["classes"])],8,T)])])])))),128)):((0,a.openBlock)(),(0,a.createElementBlock)("tr",L,[(0,a.createElementVNode)("td",A,(0,a.toDisplayString)(r.translate("address_book.empty")),1)]))])])]),r.filteredFavourites.length>0?((0,a.openBlock)(),(0,a.createBlock)(_,{key:1,meta:e.meta,onPage:r.updatePage},null,8,["meta","onPage"])):(0,a.createCommentVNode)("",!0)])])])),_:1}),(0,a.createVNode)(z)],64)}var K=o(2630),Z=o(6708),R=o(7983),U=o(7199),_=o(7609),q=o(714),z=o(8637),Q=o(6486),$=o(9783),O=o(2119),G=o(4729),H={name:"Favourites",components:{NavTabs:Z.Z,"pos-layout":K.Z,Icon:R.Z,Pagination:U.Z,StreamBarcodeReader:q.w,AddToCartModal:_.Z},setup(){const e=(0,a.inject)("translate"),t=(0,a.inject)("toast"),o=(0,a.inject)("emitter"),r=(0,z.oR)(),l=(0,O.yj)(),{fancyBox:c}=(0,G.Z)(),n=(0,a.reactive)({employee:null,keyword:"",categoryId:"",sortKey:null,order:"asc",meta:{currentPage:1,totalPages:0,limit:25,offset:0},isBarcodeScanner:!1}),s=(0,a.computed)((()=>r.state.accountInfo)),d=(0,a.computed)((()=>r.state.altCoins)),i=(0,a.computed)((()=>r.state.pos)),u=(0,a.computed)((()=>{if(n.keyword||n.categoryId){const e=n.keyword.trim().toLowerCase();return i.value.favourites.filter((t=>n.categoryId&&e?t.categoryID===n.categoryId&&(Q.includes(t.itemName.toLowerCase(),e)||Q.includes(t.sku.toLowerCase(),e)||Q.includes(t.description.toLowerCase(),e)||Number(t.price)===Number(e)):n.categoryId?t.categoryID===n.categoryId:e?Q.includes(t.itemName.toLowerCase(),e)||Q.includes(t.sku.toLowerCase(),e)||Q.includes(t.description.toLowerCase(),e)||Number(t.price)===Number(e):void 0))}return i.value.favourites})),m=(0,a.computed)((()=>{if(u.value&&u.value.length>0){let e=Q.cloneDeep(u.value);return e=e.map((e=>({...e,price:Number.parseFloat(e.price)}))),e=Q.orderBy(e,n.sortKey,n.order),e.slice(n.meta.offset,n.meta.currentPage*n.meta.limit)}return u.value})),p=(0,a.computed)((()=>{let e="EUR";if(s.value){e=s.value.PayoutCurrencyShortName;const t=Q.find(d.value,{ShortName:s.value.PayoutCurrencyShortName});t&&(e=t.LongName)}return e}));(0,a.watch)((()=>n.keyword),((e,t)=>{n.meta={...n.meta,currentPage:1,totalPages:Math.ceil(u.value.length/n.meta.limit),offset:0}}));const y=e=>{e===n.sortKey&&(n.order="asc"===n.order?"desc":"asc"),n.sortKey=e},g=e=>{const t=Q.find(i.value.categories,{id:e});return t?t.name:""},k=e=>{const t=Q.find(i.value.categories,{id:e});return t?t.categoryColourCode:""},v=e=>e.sku?-1!==Q.findIndex(i.value.favourites,{sku:e.sku}):!!e.id&&-1!==Q.findIndex(i.value.favourites,{id:e.id}),N=e=>{n.meta={...n.meta,currentPage:e,offset:(e-1)*n.meta.limit}},f=e=>{const o=Q.cloneDeep(i.value.favourites);let a=-1;e.sku?a=Q.findIndex(o,{sku:e.sku}):e.id&&(a=Q.findIndex(o,{id:e.id})),-1===a?(o.push(e),t.success("Product marked favourite successfully")):(o.splice(a,1),t.success("Product unmarked favourite successfully"));const l=Q.cloneDeep(i.value);l.favourites=o,r.commit($.qx,l)},C=e=>{n.keyword=e,n.isBarcodeScanner=!1;const t=Q.find(i.value.favourites,{sku:e});t&&h(t)},V=e=>{console.log(e)},h=e=>{Number(e.stock)>0?o.emit("addToCartModal",{product:e,currency:p.value,employee:n.employee}):t.warning("Product out of stock")};return(0,a.onBeforeMount)((()=>{n.employee=Q.find(i.value.users,{isLoggedIn:"true"}),n.meta={...n.meta,currentPage:1,totalPages:Math.ceil(u.value.length/n.meta.limit),offset:0}})),(0,a.onMounted)((()=>{Object.keys(l.query).length>0&&"undefined"!==typeof l.query.category_id&&(n.categoryId=l.query.category_id)})),{translate:e,...(0,a.toRefs)(n),filteredFavourites:u,paginatedFavourites:m,categories:i.value.categories,sort:y,updatePage:N,getCategoryName:g,getCategoryColorCode:k,isFavourite:v,currency:p,markFavourite:f,onDecode:C,onError:V,launchAddToCartModal:h,fancyBox:c}}},J=o(3744);const W=(0,J.Z)(H,[["render",j],["__scopeId","data-v-231d94e3"]]);var X=W}}]);
//# sourceMappingURL=account-pos-favourites.50385faf.js.map