"use strict";(self["webpackChunkcointopay"]=self["webpackChunkcointopay"]||[]).push([[434],{9838:function(e,t,r){r.r(t),r.d(t,{default:function(){return Le}});var o=r(821);const a=e=>((0,o.pushScopeId)("data-v-3d098886"),e=e(),(0,o.popScopeId)(),e),l={class:"card"},c=a((()=>(0,o.createElementVNode)("hr",{class:"border-gray-300 dark:border-gray-600"},null,-1))),n={class:"body"},s={class:"flex items-center justify-end mb-3 flex-col lg:flex-row"},d=a((()=>(0,o.createElementVNode)("option",{value:""},"Select Category",-1))),i=["value"],u={class:"relative mb-3 lg:mb-0 ml-0 lg:ml-3 w-full lg:w-auto"},m={key:0,class:"mx-auto mb-3 w-40"},p={class:"w-full scrollbar scrollbar-thin scrollbar-thumb-gray-400 scrollbar-track-gray-200 dark:scrollbar-track-gray-900 dark:scrollbar-thumb-gray-600"},g={class:"table-sm mb-2"},y=a((()=>(0,o.createElementVNode)("th",null,"Category",-1))),v=a((()=>(0,o.createElementVNode)("th",null,"Image",-1))),f={class:"flex items-center"},k=(0,o.createTextVNode)(" Name "),E=a((()=>(0,o.createElementVNode)("th",{class:"whitespace-nowrap"},"SKU / EAN / Barcode / QR",-1))),N=a((()=>(0,o.createElementVNode)("th",null,"Quantity",-1))),h={class:"flex items-center"},V=(0,o.createTextVNode)(" Price "),w=a((()=>(0,o.createElementVNode)("th",null,"Actions",-1))),b=["onClick"],x={class:"w-12 h-12 rounded-full overflow-hidden"},C=["src","onClick"],B=["onClick"],I={class:"break-all"},S=["onClick"],D=["onClick"],P=["onClick"],M={class:"flex items-center space-x-1"},A=["onClick"],q=["onClick"],R={key:0,class:"flex items-center space-x-1"},U=["onClick"],j=["onClick"],T={key:1},F={colspan:"7",class:"text-center"};function Z(e,t,r,a,Z,K){const L=(0,o.resolveComponent)("nav-tabs"),O=(0,o.resolveComponent)("icon"),H=(0,o.resolveComponent)("j-button"),z=(0,o.resolveComponent)("StreamBarcodeReader"),J=(0,o.resolveComponent)("pagination"),W=(0,o.resolveComponent)("pos-layout"),X=(0,o.resolveComponent)("save-product-modal"),Q=(0,o.resolveComponent)("add-to-cart-modal");return(0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,null,[(0,o.createVNode)(W,null,{content:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",l,[(0,o.createVNode)(L),c,(0,o.createElementVNode)("div",n,[(0,o.createElementVNode)("div",s,[(0,o.createElementVNode)("span",{class:"hover:text-blue-500 mb-3 lg:mb-0 ml-0 lg:ml-3 cursor-pointer w-full lg:w-auto",onClick:t[0]||(t[0]=t=>e.isBarcodeScanner=!e.isBarcodeScanner)},[(0,o.createVNode)(O,{name:"barcode"})]),(0,o.withDirectives)((0,o.createElementVNode)("select",{"aria-label":"Select Category",class:"form-select w-full mb-3 lg:mb-0 ml-0 lg:ml-3 w-full lg:w-72","onUpdate:modelValue":t[1]||(t[1]=t=>e.categoryId=t)},[d,((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(a.categories,((e,t)=>((0,o.openBlock)(),(0,o.createElementBlock)("option",{key:t,value:e.id},(0,o.toDisplayString)(e.name),9,i)))),128))],512),[[o.vModelSelect,e.categoryId]]),(0,o.createElementVNode)("div",u,[(0,o.createVNode)(O,{classes:"absolute w-5 h-5 top-3 left-3 dark:text-gray-300",name:"search"}),(0,o.withDirectives)((0,o.createElementVNode)("input",{"onUpdate:modelValue":t[2]||(t[2]=t=>e.keyword=t),"aria-label":"Search...",class:"form-input px-10 w-full lg:w-auto",type:"text"},null,512),[[o.vModelText,e.keyword]]),""!==e.keyword?((0,o.openBlock)(),(0,o.createElementBlock)("span",{key:0,class:"absolute top-3 right-3 dark:text-gray-400 cursor-pointer",onClick:t[3]||(t[3]=t=>e.keyword="")},[(0,o.createVNode)(O,{classes:"w-5 h-5",name:"close"})])):(0,o.createCommentVNode)("",!0)]),e.employee&&"true"===e.employee.isParentUser?((0,o.openBlock)(),(0,o.createBlock)(H,{key:0,class:"ml-3",type:"button",onClick:t[4]||(t[4]=e=>a.launchSaveProductModal())},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(a.translate("pos.products.btn_add")),1)])),_:1})):(0,o.createCommentVNode)("",!0)]),e.isBarcodeScanner?((0,o.openBlock)(),(0,o.createElementBlock)("div",m,[(0,o.createVNode)(z,{onDecode:a.onDecode,onError:a.onError},null,8,["onDecode","onError"])])):(0,o.createCommentVNode)("",!0),(0,o.createElementVNode)("div",p,[(0,o.createElementVNode)("table",g,[(0,o.createElementVNode)("thead",null,[(0,o.createElementVNode)("tr",null,[y,v,(0,o.createElementVNode)("th",{onClick:t[5]||(t[5]=e=>a.sort("itemName")),class:"cursor-pointer",style:{"max-width":"150px"}},[(0,o.createElementVNode)("div",f,[k,"itemName"===e.sortKey?((0,o.openBlock)(),(0,o.createElementBlock)("span",{key:0,class:(0,o.normalizeClass)("ml-4 transform transition-all "+("asc"===e.order?"rotate-180":""))},[(0,o.createVNode)(O,{name:"sort",classes:"w-4 h-4"})],2)):(0,o.createCommentVNode)("",!0)])]),E,N,(0,o.createElementVNode)("th",{onClick:t[6]||(t[6]=e=>a.sort("price")),class:"cursor-pointer"},[(0,o.createElementVNode)("div",h,[V,"price"===e.sortKey?((0,o.openBlock)(),(0,o.createElementBlock)("span",{key:0,class:(0,o.normalizeClass)("ml-4 transform transition-all "+("asc"===e.order?"rotate-180":""))},[(0,o.createVNode)(O,{name:"sort",classes:"w-4 h-4"})],2)):(0,o.createCommentVNode)("",!0)])]),w])]),(0,o.createElementVNode)("tbody",null,[a.filteredProducts.length>0?((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,{key:0},(0,o.renderList)(a.paginatedProducts,((t,r)=>((0,o.openBlock)(),(0,o.createElementBlock)("tr",{key:r},[(0,o.createElementVNode)("td",null,[(0,o.createElementVNode)("div",{onClick:r=>e.categoryId=t.categoryID,class:"cursor-pointer flex items-center"},[(0,o.createElementVNode)("div",{style:(0,o.normalizeStyle)("background: #"+a.getCategoryColorCode(t.categoryID)),class:"inline-block w-5 h-5 rounded-full mr-3"},null,4),(0,o.createTextVNode)(" "+(0,o.toDisplayString)(a.getCategoryName(t.categoryID)),1)],8,b)]),(0,o.createElementVNode)("td",null,[(0,o.createElementVNode)("div",x,[(0,o.createElementVNode)("img",{src:t.imageUri,alt:"",class:"w-12 h-12 object-cover",onClick:e=>a.fancyBox(t.imageUri)},null,8,C)])]),(0,o.createElementVNode)("td",{onClick:e=>a.launchAddToCartModal(t),class:"cursor-pointer whitespace-normal",style:{width:"150px"}},[(0,o.createElementVNode)("p",I,(0,o.toDisplayString)(t.itemName),1)],8,B),(0,o.createElementVNode)("td",{onClick:e=>a.launchAddToCartModal(t),class:"cursor-pointer"},(0,o.toDisplayString)(t.sku),9,S),(0,o.createElementVNode)("td",{onClick:e=>a.launchAddToCartModal(t),class:"cursor-pointer"},(0,o.toDisplayString)(t.stock),9,D),(0,o.createElementVNode)("td",{onClick:e=>a.launchAddToCartModal(t),class:"cursor-pointer"},(0,o.toDisplayString)(`${t.price} ${a.currency}`),9,P),(0,o.createElementVNode)("td",null,[(0,o.createElementVNode)("div",M,[(0,o.createElementVNode)("button",{onClick:e=>a.launchAddToCartModal(t),class:"hover:text-blue-500",type:"button"},[(0,o.createVNode)(O,{name:"shopping-cart"})],8,A),(0,o.createElementVNode)("button",{onClick:e=>a.markFavourite(t,r)},[(0,o.createVNode)(O,{name:"heart",classes:"w-6 h-6 hover:text-red-500 "+(a.isFavourite(t)?"text-red-500":"")},null,8,["classes"])],8,q),e.employee&&"true"===e.employee.isParentUser?((0,o.openBlock)(),(0,o.createElementBlock)("div",R,[(0,o.createElementVNode)("button",{onClick:e=>a.launchSaveProductModal(t),class:"hover:text-blue-500"},[(0,o.createVNode)(O,{name:"edit"})],8,U),(0,o.createElementVNode)("button",{onClick:e=>a.deleteProduct(t.id),class:"hover:text-red-500"},[(0,o.createVNode)(O,{name:"trash"})],8,j)])):(0,o.createCommentVNode)("",!0)])])])))),128)):((0,o.openBlock)(),(0,o.createElementBlock)("tr",T,[(0,o.createElementVNode)("td",F,(0,o.toDisplayString)(a.translate("address_book.empty")),1)]))])])]),a.filteredProducts.length>0?((0,o.openBlock)(),(0,o.createBlock)(J,{key:1,meta:e.meta,onPage:a.updatePage},null,8,["meta","onPage"])):(0,o.createCommentVNode)("",!0)])])])),_:1}),(0,o.createVNode)(X),(0,o.createVNode)(Q)],64)}var K=r(2630),L=r(6708),O=r(7983),H=r(3164),z=r(7199);const J={class:"flex items-center justify-between"},W={class:"mb-2"},X={class:"flex items-center justify-between mb-1"},Q={class:"text-red-500 text-sm"},Y=(0,o.createElementVNode)("option",{value:""},"Select Category",-1),G=["value"],_={class:"mb-2"},$={class:"flex items-center justify-between mb-1"},ee={class:"text-red-500 text-sm"},te={class:"mb-2"},re={class:"flex items-center justify-between mb-1"},oe={class:"text-red-500 text-sm"},ae={class:"mb-2"},le={class:"grid grid-cols-2 gap-1 md:gap-4"},ce={class:"col-span-1"},ne={class:"flex items-center justify-between mb-1"},se={class:"text-red-500 text-sm"},de={class:"col-span-1"},ie={class:"flex items-center justify-between mb-1"},ue={class:"text-red-500 text-sm"},me={class:"mb-4"},pe={class:"flex items-center justify-between mb-1"},ge={class:"text-red-500 text-sm"},ye={class:"flex items-center justify-between"},ve={class:"mb-2"},fe={class:"grid grid-cols-2 gap-1 md:gap-4"},ke={class:"col-span-1"},Ee={class:"w-28 h-28 overflow-hidden mx-auto"},Ne={for:"file",class:"cursor-pointer"},he=["src"],Ve={class:"col-span-1"},we={key:0,class:"mx-auto w-40"},be={class:"mt-4 text-right"},xe={key:0,class:"mr-3"};function Ce(e,t,r,a,l,c){const n=(0,o.resolveComponent)("icon"),s=(0,o.resolveComponent)("StreamBarcodeReader"),d=(0,o.resolveComponent)("j-button"),i=(0,o.resolveComponent)("modal"),u=(0,o.resolveDirective)("tippy");return(0,o.openBlock)(),(0,o.createBlock)(i,{maxWidth:e.maxWidth,show:e.show,onClose:t[10]||(t[10]=e=>a.closeModal())},{title:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",J,[(0,o.createElementVNode)("span",null,(0,o.toDisplayString)(a.translate("pos.products.title")),1),(0,o.createElementVNode)("span",{class:"text-gray-500 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-200 cursor-pointer",onClick:t[0]||(t[0]=e=>a.closeModal())},[(0,o.createVNode)(n,{name:"close"})])])])),content:(0,o.withCtx)((()=>[(0,o.createElementVNode)("form",{onSubmit:t[9]||(t[9]=(0,o.withModifiers)((e=>a.submit()),["prevent"]))},[(0,o.createElementVNode)("div",W,[(0,o.createElementVNode)("div",X,[(0,o.createElementVNode)("label",null,(0,o.toDisplayString)(a.translate("pos.products.select_category")),1),(0,o.createElementVNode)("div",Q,(0,o.toDisplayString)(a.showError(e.errorBag,"categoryId")),1)]),(0,o.withDirectives)((0,o.createElementVNode)("select",{class:"form-select w-full","onUpdate:modelValue":t[1]||(t[1]=t=>e.form.categoryId=t)},[Y,((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(a.categories,((e,t)=>((0,o.openBlock)(),(0,o.createElementBlock)("option",{key:t,value:e.id},(0,o.toDisplayString)(e.name),9,G)))),128))],512),[[o.vModelSelect,e.form.categoryId]])]),(0,o.createElementVNode)("div",_,[(0,o.createElementVNode)("div",$,[(0,o.createElementVNode)("label",null,(0,o.toDisplayString)(a.translate("pos.products.name")),1),(0,o.createElementVNode)("div",ee,(0,o.toDisplayString)(a.showError(e.errorBag,"name")),1)]),(0,o.withDirectives)((0,o.createElementVNode)("input",{class:"form-input w-full",type:"text","onUpdate:modelValue":t[2]||(t[2]=t=>e.form.name=t)},null,512),[[o.vModelText,e.form.name]])]),(0,o.createElementVNode)("div",te,[(0,o.createElementVNode)("div",re,[(0,o.createElementVNode)("label",null,(0,o.toDisplayString)(a.translate("pos.products.description")),1),(0,o.createElementVNode)("div",oe,(0,o.toDisplayString)(a.showError(e.errorBag,"description")),1)]),(0,o.withDirectives)((0,o.createElementVNode)("textarea",{class:"form-input w-full",rows:"4","onUpdate:modelValue":t[3]||(t[3]=t=>e.form.description=t)},null,512),[[o.vModelText,e.form.description]])]),(0,o.createElementVNode)("div",ae,[(0,o.createElementVNode)("div",le,[(0,o.createElementVNode)("div",ce,[(0,o.createElementVNode)("div",ne,[(0,o.createElementVNode)("label",null,(0,o.toDisplayString)(a.translate("pos.products.quantity")),1),(0,o.createElementVNode)("div",se,(0,o.toDisplayString)(a.showError(e.errorBag,"quantity")),1)]),(0,o.withDirectives)((0,o.createElementVNode)("input",{class:"form-input w-full",type:"text","onUpdate:modelValue":t[4]||(t[4]=t=>e.form.quantity=t)},null,512),[[o.vModelText,e.form.quantity]])]),(0,o.createElementVNode)("div",de,[(0,o.createElementVNode)("div",ie,[(0,o.createElementVNode)("label",null,(0,o.toDisplayString)(a.translate("pos.products.price"))+" ("+(0,o.toDisplayString)(e.currency)+")",1),(0,o.createElementVNode)("div",ue,(0,o.toDisplayString)(a.showError(e.errorBag,"price")),1)]),(0,o.withDirectives)((0,o.createElementVNode)("input",{class:"form-input w-full",type:"text","onUpdate:modelValue":t[5]||(t[5]=t=>e.form.price=t)},null,512),[[o.vModelText,e.form.price]])])])]),(0,o.createElementVNode)("div",me,[(0,o.createElementVNode)("div",pe,[(0,o.createElementVNode)("label",null,(0,o.toDisplayString)(a.translate("pos.products.sku")),1),(0,o.createElementVNode)("div",ge,(0,o.toDisplayString)(a.showError(e.errorBag,"sku")),1)]),(0,o.createElementVNode)("div",ye,[(0,o.withDirectives)((0,o.createElementVNode)("input",{class:"form-input w-full",type:"text","onUpdate:modelValue":t[6]||(t[6]=t=>e.form.sku=t)},null,512),[[o.vModelText,e.form.sku]]),(0,o.createElementVNode)("span",{class:"hover:text-blue-500 ml-3 cursor-pointer",onClick:t[7]||(t[7]=t=>e.isBarcodeScanner=!e.isBarcodeScanner)},[(0,o.createVNode)(n,{name:"barcode"})])])]),(0,o.createElementVNode)("div",ve,[(0,o.createElementVNode)("div",fe,[(0,o.createElementVNode)("div",ke,[(0,o.createElementVNode)("div",Ee,[(0,o.withDirectives)(((0,o.openBlock)(),(0,o.createElementBlock)("label",Ne,[(0,o.createElementVNode)("img",{class:"w-28 h-28 object-cover",src:a.getImageUrl,alt:""},null,8,he)])),[[u,"Click here to upload"]]),(0,o.createElementVNode)("input",{onChange:t[8]||(t[8]=e=>a.upload(e)),class:"hidden",id:"file",type:"file",ref:"featuredImg"},null,544)])]),(0,o.createElementVNode)("div",Ve,[e.isBarcodeScanner?((0,o.openBlock)(),(0,o.createElementBlock)("div",we,[(0,o.createVNode)(s,{onDecode:a.onDecode,onError:a.onError},null,8,["onDecode","onError"])])):(0,o.createCommentVNode)("",!0)])])]),(0,o.createElementVNode)("div",be,[(0,o.createVNode)(d,{disabled:e.isProcessing},{default:(0,o.withCtx)((()=>[e.isProcessing?((0,o.openBlock)(),(0,o.createElementBlock)("div",xe,[(0,o.createVNode)(n,{name:"spinner",classes:"w-4 h-4 text-white"})])):(0,o.createCommentVNode)("",!0),(0,o.createElementVNode)("span",null,(0,o.toDisplayString)(a.translate("pos.products.btn_save")),1)])),_:1},8,["disabled"])])],32)])),_:1},8,["maxWidth","show"])}var Be=r(9099),Ie=r(6232),Se=r(8637),De=r(6486),Pe=r(9783),Me=r(714),Ae={name:"SaveProductModal",components:{Modal:Be.Z,Icon:O.Z,JButton:H.Z,StreamBarcodeReader:Me.w},setup(){const e=(0,o.inject)("translate"),t=(0,o.inject)("emitter"),a=(0,o.inject)("http"),l=(0,o.inject)("toast"),c=(0,Se.oR)(),{showError:n,validate:s}=(0,Ie.Z)(),d=(0,o.ref)(null),i=(0,o.reactive)({show:!1,maxWidth:"2xl",closeable:!0,product:null,currency:null,form:{categoryId:"",name:"",description:"",imageUrl:"",quantity:"",price:"",sku:""},errorBag:{},rules:{categoryId:["required"],name:["required"],description:["required"],sku:["required"],quantity:["required","minValue:1","maxValue:9999999"],price:["required","minValue:0.1","regex:/^[0-9]{1,8}([,.][0-9]{1,8})?$/"]},messages:{categoryId:{required:"Please select category"},name:{required:"Product name is required"},description:{required:"Product description is required"},sku:{required:"Product sku is required"},quantity:{required:"Product stock level is required",minValue:"Product stock should be between 1 and 9999999",maxValue:"Product stock should be between 1 and 9999999"},price:{required:"Product price is required",regex:"Please enter a valid price value",minValue:"Price should be greater than 0"}},isProcessing:!1,isBarcodeScanner:!1}),u=(0,o.computed)((()=>c.state.user)),m=(0,o.computed)((()=>c.state.pos)),p=(0,o.computed)((()=>c.state.posCalls)),g=(0,o.computed)((()=>i.form.imageUrl?i.form.imageUrl:r(3887)));(0,o.watch)((()=>({...i.form})),((e,t)=>{Object.keys(i.errorBag).length>0&&(i.errorBag=s(i.form,i.rules,i.messages))}));const y=()=>{i.show=!1},v=e=>{e&&(i.form.sku=e,i.isBarcodeScanner=!1)},f=e=>{console.log(e)},k=()=>{const e=De.cloneDeep(m.value.products);if(e.length>0){const t=De.maxBy(e,(e=>Number(e.id)));return(Number(t.id)+1).toString()}return"1"},E=e=>{const t=e.target.files;if(t.length>0){const e=t[0];if(e.type.startsWith("image/")){const t=new FormData;t.append("file123",e),t.append("MerchantID",u.value.ID);const r="https://app.cointopay.com";a.post(`${r}/MarketAPI?POSBLOB`,t,{headers:{"Content-Type":"multipart/form-data"}}).then((e=>{200===e.status&&(i.form.imageUrl=e.data,d.value.value="")})).catch((e=>{console.log(e)}))}else d.value.value="",l.error("Please provide a valid image file")}},N=()=>{if(i.errorBag=s(i.form,i.rules,i.messages),0===Object.keys(i.errorBag).length){i.isProcessing=!0;const e=i.form,t=De.cloneDeep(m.value.products);let r=!0;if(i.product){let o=De.findIndex(t,(t=>t.sku===e.sku&&i.product.id!==t.id));-1===o?(o=De.findIndex(t,{id:i.product.id}),t.splice(o,1,{id:i.product.id,categoryID:e.categoryId,itemName:e.name,description:e.description,imageUri:e.imageUrl,sku:e.sku,stock:e.quantity,price:e.price})):(r=!1,i.isProcessing=!1,l.error("Product with this sku already exists!"))}else-1===De.findIndex(t,{sku:e.sku})?t.push({id:k(),categoryID:e.categoryId,itemName:e.name,description:e.description,imageUri:e.imageUrl,sku:e.sku,stock:e.quantity,price:e.price}):(r=!1,i.isProcessing=!1,l.error("Product with this sku already exists!"));r&&c.dispatch(Pe.Rb,{call:p.value.products,data:t}).then((()=>{i.isProcessing=!1;const e=i.product?"Product updated successfully":"Product added successfully";l.success(e),y()})).catch((e=>{console.log(e),i.isProcessing=!1,l.error("Internal Server Error")}))}};return(0,o.onBeforeMount)((()=>{t.on("saveProductModal",(e=>{i.product=e.product||null,i.currency=e.currency,d.value&&(d.value.value=""),i.form={categoryId:i.product?i.product.categoryID:"",name:i.product?i.product.itemName:"",description:i.product?i.product.description:"",imageUrl:i.product?i.product.imageUri:"",quantity:i.product?i.product.stock:"",price:i.product?i.product.price:"",sku:i.product?i.product.sku:""},i.show=!0}))})),{translate:e,...(0,o.toRefs)(i),featuredImg:d,categories:m.value.categories,showError:n,closeModal:y,getImageUrl:g,onDecode:v,onError:f,upload:E,submit:N}}},qe=r(3744);const Re=(0,qe.Z)(Ae,[["render",Ce]]);var Ue=Re,je=r(7609),Te=r(2119),Fe=r(4729),Ze={name:"Products",components:{NavTabs:L.Z,"pos-layout":K.Z,Icon:O.Z,JButton:H.Z,Pagination:z.Z,StreamBarcodeReader:Me.w,SaveProductModal:Ue,AddToCartModal:je.Z},setup(){const e=(0,o.inject)("translate"),t=(0,o.inject)("toast"),r=(0,o.inject)("swal"),a=(0,o.inject)("emitter"),l=(0,Se.oR)(),c=(0,Te.yj)(),{fancyBox:n}=(0,Fe.Z)(),s=(0,o.reactive)({employee:null,keyword:"",categoryId:"",sortKey:null,order:"asc",meta:{currentPage:1,totalPages:0,limit:25,offset:0},isBarcodeScanner:!1}),d=(0,o.computed)((()=>l.state.accountInfo)),i=(0,o.computed)((()=>l.state.altCoins)),u=(0,o.computed)((()=>l.state.pos)),m=(0,o.computed)((()=>l.state.posCalls)),p=(0,o.computed)((()=>{if(s.keyword||s.categoryId){const e=s.keyword.trim().toLowerCase();return u.value.products.filter((t=>s.categoryId&&e?t.categoryID===s.categoryId&&(De.includes(t.itemName.toLowerCase(),e)||De.includes(t.sku.toLowerCase(),e)||De.includes(t.description.toLowerCase(),e)||Number(t.price)===Number(e)):s.categoryId?t.categoryID===s.categoryId:e?De.includes(t.itemName.toLowerCase(),e)||De.includes(t.sku.toLowerCase(),e)||De.includes(t.description.toLowerCase(),e)||Number(t.price)===Number(e):void 0))}return u.value.products})),g=(0,o.computed)((()=>{if(p.value&&p.value.length>0){let e=De.cloneDeep(p.value);return e=e.map((e=>({...e,price:Number.parseFloat(e.price)}))),e=De.orderBy(e,s.sortKey,s.order),e.slice(s.meta.offset,s.meta.currentPage*s.meta.limit)}return p.value})),y=(0,o.computed)((()=>{let e="EUR";if(d.value){e=d.value.PayoutCurrencyShortName;const t=De.find(i.value,{ShortName:d.value.PayoutCurrencyShortName});t&&(e=t.LongName)}return e}));(0,o.watch)((()=>s.keyword),((e,t)=>{s.meta={...s.meta,currentPage:1,totalPages:Math.ceil(p.value.length/s.meta.limit),offset:0}}));const v=e=>{e===s.sortKey&&(s.order="asc"===s.order?"desc":"asc"),s.sortKey=e},f=e=>{const t=De.find(u.value.categories,{id:e});return t?t.name:""},k=e=>{const t=De.find(u.value.categories,{id:e});return t?t.categoryColourCode:""},E=e=>e.sku?-1!==De.findIndex(u.value.favourites,{sku:e.sku}):!!e.id&&-1!==De.findIndex(u.value.favourites,{id:e.id}),N=e=>{s.meta={...s.meta,currentPage:e,offset:(e-1)*s.meta.limit}},h=e=>{const r=De.cloneDeep(u.value.favourites);let o=-1;e.sku?o=De.findIndex(r,{sku:e.sku}):e.id&&(o=De.findIndex(r,{id:e.id})),-1===o?(r.push(e),t.success("Product marked favourite successfully")):(r.splice(o,1),t.success("Product unmarked favourite successfully"));const a=De.cloneDeep(u.value);a.favourites=r,l.commit(Pe.qx,a)},V=e=>{const o=De.findIndex(u.value.products,{id:e});-1!==o&&r.fire({title:"Product",text:"Are you sure you want to remove this product?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"Yes",cancelButtonText:"No",focusCancel:!0,customClass:{container:"swal2-tailwind"}}).then((({value:e})=>{if(e&&!0===e){const e=De.cloneDeep(u.value.products);e.splice(o,1),l.dispatch(Pe.Rb,{call:m.value.products,data:e}).then((e=>{t.success("Product deleted successfully")})).catch((e=>{console.log(e),t.error("Internal Server Error")}))}}))},w=e=>{s.keyword=e,s.isBarcodeScanner=!1;const t=De.find(u.value.products,{sku:e});t&&x(t)},b=e=>{console.log(e)},x=e=>{Number(e.stock)>0?a.emit("addToCartModal",{product:e,currency:y.value,employee:s.employee}):t.warning("Product out of stock")},C=(e=null)=>{a.emit("saveProductModal",{product:e,currency:y.value})};return(0,o.onBeforeMount)((()=>{s.employee=De.find(u.value.users,{isLoggedIn:"true"}),s.meta={...s.meta,currentPage:1,totalPages:Math.ceil(p.value.length/s.meta.limit),offset:0}})),(0,o.onMounted)((()=>{Object.keys(c.query).length>0&&"undefined"!==typeof c.query.category_id&&(s.categoryId=c.query.category_id)})),{translate:e,...(0,o.toRefs)(s),filteredProducts:p,paginatedProducts:g,categories:u.value.categories,sort:v,updatePage:N,getCategoryName:f,getCategoryColorCode:k,isFavourite:E,currency:y,markFavourite:h,deleteProduct:V,onDecode:w,onError:b,launchAddToCartModal:x,launchSaveProductModal:C,fancyBox:n}}};const Ke=(0,qe.Z)(Ze,[["render",Z],["__scopeId","data-v-3d098886"]]);var Le=Ke},3887:function(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAMAAACahl6sAAAAVFBMVEXp7vG6vsHn7fDr8PO3u761uLuxtbju8/bO09bx9vnv9PfDx8qvsrXKz9K9wcTh5eiws7bg5um5vcCzt7rW2t3t8vXS19rBxMfk6u3Z3uHz+PvHy863ukFnAAACm0lEQVR42u3a23KiQBSF4b3X7m4EMWOak4f3f88RLCqHjpmJXNCk1neRS6t+45KmRIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiCZYSvIAKcoFqsqyKIFcTof9EleUsj6I7WvvlvD1AJOVQWTwulQzyOqs91EXC323+k5enKo71s87Ti9wWTsER1U3wJ43vRX1yVYoSUIOJeRZKHdeNbzmEVItCCkyDIHcYeMhEBNg+rvpEBj6wTduaGHYcAjspI2L0bkwnAybDYEUwemdc91m/yOQSp3O/EuJrYbY2UWdxVoeDB7Zh1Q7r2/8l4cnmBhyD+mu7n3IF9dIoOzDxZB5SPGvEEjXB+fFcg/58NFq2g6fO8q+iepeToasQ+zs9Luxo2pDVL2ViCHnkO+/foGy9VFHzl8M+YbIrST4dxfEdB9z5biTjEOmI4p37u2IkuxjNu0k35Dk0JjuYzLvJN+Q5Bif7mMy7yTfkOTGKt3H+51kHJJI9vFxJ9mHAA/28XknmYegqwRf7SPdSdYhKPrp3U73ke4k5xBUbRMGM6T7SHeScQiqc+O02Zth3sdDzSHfkFvHtAl/K5n38ZA/WK4h6NrGzT8VFOM+thky7iPqXbM/N3GjIfd9zJyLus2QeR+zqNsMmffxZpsh931sP+S+j+2HwMZrxi8IEds7/RUh3ZUhDGHItyF7736qyTHEDvryU3GX4/0InpD3Pfu2n3x4Wl4hF3veZQw5rh8SVKOeX/886/WPRtUaAlnX4FRdExYYXyBcVu6AjTchS8XQrv7JErmGuLjjuvpTpgIp+jr4JUK9W79DBCiq826JtiokC4AVS1g2D8cL/kvuz/gTEREREREREREREREREREREREREREREREREdHa/gKrrUWVgnSBWwAAAABJRU5ErkJggg=="}}]);
//# sourceMappingURL=account-pos-products.59011e32.js.map