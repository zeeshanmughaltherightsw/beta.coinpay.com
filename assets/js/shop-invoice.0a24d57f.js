(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["shop-invoice"],{de56:function(e,t,o){"use strict";o.r(t);o("99af"),o("b64b"),o("b0c0");var n=o("f2bf"),c={key:0},r={class:"text-center mb-3"},a={class:"font-bold"},i={class:"font-bold"},l={class:"w-full lg:w-3/5 mx-auto"},s={class:"mb-4"},d={class:"text-3xl font-bold text-blue-500 text-center"},b=["href"],p=Object(n["createElementVNode"])("span",{class:"mr-2"},"Click to Redirect",-1),m={key:0},u={class:"mt-4"},O={class:"flex justify-center flex-wrap items-stretch w-full mb-4 relative"},j={class:"flex -mr-px"},v={class:"mb-4"},f={class:"text-3xl font-bold text-blue-500 text-center"},h=["href"],g=Object(n["createElementVNode"])("span",{class:"mr-2"},"Click to Redirect",-1),N={key:0},k={class:"mt-4"},V={key:0,class:"text-center mb-3"},y={class:"flex justify-center flex-wrap items-stretch w-full mb-4 relative"},E={class:"flex -mr-px"},x={class:"mb-4"},C={class:"text-3xl font-bold text-blue-500 text-center"},w=["href"],q=Object(n["createElementVNode"])("span",{class:"mr-2"},"Click to Redirect",-1),B={key:0},S={class:"text-center"},T={key:0,class:"card mt-4"},D={class:"body"},I={class:"scrollbar scrollbar-thin scrollbar-thumb-gray-400 scrollbar-track-gray-200 dark:scrollbar-track-gray-900 dark:scrollbar-thumb-gray-600"},L={class:"table-sm mb-2"},R=Object(n["createElementVNode"])("th",null,"Item",-1),P={key:0},A=Object(n["createElementVNode"])("th",null,"Price",-1),_=Object(n["createElementVNode"])("th",null,"Quantity",-1),M=Object(n["createElementVNode"])("th",null,"Subtotal",-1),U={class:"flex items-center"},H=["src","onClick"],z={key:0},Q={key:0},F=["colspan"],J={colspan:"1"},K={key:1},Z=["colspan"],W={class:"text-red-500"},G={colspan:"1"},X={class:"text-red-500"},Y=["colspan"],$=Object(n["createElementVNode"])("span",{class:"font-bold"},"Total:",-1),ee=[$],te={colspan:"1"},oe={class:"font-bold"},ne={class:"text-center"},ce=Object(n["createTextVNode"])("Invoice Page "),re={key:1,class:"row"},ae={class:"offset-md-3 col-md-6 text-center"},ie={class:"alert alert-success"},le=["innerHTML"];function se(e,t,o,$,se,de){var be=Object(n["resolveComponent"])("icon"),pe=Object(n["resolveComponent"])("QRCodeVue3"),me=Object(n["resolveComponent"])("Tab"),ue=Object(n["resolveComponent"])("TabSet"),Oe=Object(n["resolveComponent"])("router-link"),je=Object(n["resolveComponent"])("centered-layout");return Object(n["openBlock"])(),Object(n["createBlock"])(je,null,{default:Object(n["withCtx"])((function(){return[e.invoice?(Object(n["openBlock"])(),Object(n["createElementBlock"])(n["Fragment"],{key:0},[$.isInvoiceComplete?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",re,[Object(n["createElementVNode"])("div",ae,[Object(n["createElementVNode"])("div",ie,[Object(n["createElementVNode"])("span",{innerHTML:$.translate("pos.invoice.success")},null,8,le),Object(n["createTextVNode"])(Object(n["toDisplayString"])(e.invoice.TransactionID),1)]),Object(n["createVNode"])(Oe,{class:"btn btn-success b200",tag:"a",to:"/shop"},{default:Object(n["withCtx"])((function(){return[Object(n["createTextVNode"])(Object(n["toDisplayString"])($.translate("pos.cart.continue_shopping")),1)]})),_:1})])])):(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",c,[Object(n["createElementVNode"])("div",r,[Object(n["createElementVNode"])("p",null,Object(n["toDisplayString"])($.translate("pos.invoice.message")),1),Object(n["createElementVNode"])("p",null,[Object(n["createElementVNode"])("span",a,Object(n["toDisplayString"])($.translate("pos.invoice.merchant")),1),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.invoice.ShopTitle),1)]),Object(n["createElementVNode"])("p",null,[Object(n["createElementVNode"])("span",i,Object(n["toDisplayString"])($.translate("pos.invoice.invoice_number")),1),Object(n["createTextVNode"])("  "+Object(n["toDisplayString"])(e.invoice.TransactionID),1)])]),Object(n["createElementVNode"])("div",l,[Object(n["createVNode"])(ue,null,{default:Object(n["withCtx"])((function(){return[Object(n["createVNode"])(me,{name:$.translate("invoice.address_only")},{default:Object(n["withCtx"])((function(){return[Object(n["createElementVNode"])("div",s,[Object(n["createElementVNode"])("p",d,Object(n["toDisplayString"])(e.timer),1),$.isPaid?(Object(n["openBlock"])(),Object(n["createElementBlock"])("a",{key:0,href:e.invoice.RedirectTargetURL,class:"mt-3 text-blue-500 hover:underline inline-flex items-center"},[p,Object(n["createVNode"])(be,{name:"arrow-right",classes:"w-5 h-5"})],8,b)):Object(n["createCommentVNode"])("",!0)]),$.isPaid||$.isExpired?Object(n["createCommentVNode"])("",!0):(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",m,[Object(n["createVNode"])(pe,{imgclass:"mx-auto",width:$.qrOptions.width,height:$.qrOptions.height,"qr-options":$.qrOptions.qrOptions,"background-options":$.qrOptions.backgroundOptions,"dots-options":$.qrOptions.dotsOptions,"corners-dot-options":$.qrOptions.cornersDotOptions,"corners-square-options":$.qrOptions.cornersSquareOptions,value:e.invoice.coinAddress},null,8,["width","height","qr-options","background-options","dots-options","corners-dot-options","corners-square-options","value"]),Object(n["createElementVNode"])("div",u,[Object(n["createElementVNode"])("div",O,[Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=function(t){return e.invoice.coinAddress=t}),readonly:"",class:"form-input w-2/3 rounded-r-none"},null,512),[[n["vModelText"],e.invoice.coinAddress]]),Object(n["createElementVNode"])("div",j,[Object(n["createElementVNode"])("span",{onClick:t[1]||(t[1]=function(t){return $.copyToClipboard(e.invoice.coinAddress)}),class:"hover:bg-gray-200 dark:hover:bg-gray-700 cursor-pointer flex items-center leading-normal rounded rounded-l-none border border-l-0 border-gray-300 dark:border-gray-600 px-3 whitespace-no-wrap text-sm"},[Object(n["createVNode"])(be,{name:"clipboard",classes:"w-5 h-5"})])])])])]))]})),_:1},8,["name"]),Object(n["createVNode"])(me,{name:$.translate("invoice.full_crypto_link"),selected:!0},{default:Object(n["withCtx"])((function(){return[Object(n["createElementVNode"])("div",v,[Object(n["createElementVNode"])("p",f,Object(n["toDisplayString"])(e.timer),1),$.isPaid?(Object(n["openBlock"])(),Object(n["createElementBlock"])("a",{key:0,href:e.invoice.RedirectTargetURL,class:"mt-3 text-blue-500 hover:underline inline-flex items-center"},[g,Object(n["createVNode"])(be,{name:"arrow-right",classes:"w-5 h-5"})],8,h)):Object(n["createCommentVNode"])("",!0)]),$.isPaid||$.isExpired?Object(n["createCommentVNode"])("",!0):(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",N,[Object(n["createVNode"])(pe,{imgclass:"mx-auto",width:$.qrOptions.width,height:$.qrOptions.height,"qr-options":$.qrOptions.qrOptions,"background-options":$.qrOptions.backgroundOptions,"dots-options":$.qrOptions.dotsOptions,"corners-dot-options":$.qrOptions.cornersDotOptions,"corners-square-options":$.qrOptions.cornersSquareOptions,value:$.qrLink},null,8,["width","height","qr-options","background-options","dots-options","corners-dot-options","corners-square-options","value"]),Object(n["createElementVNode"])("div",k,[e.invoice.Tag?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",V,"Memo/Tag: "+Object(n["toDisplayString"])(e.invoice.Tag),1)):Object(n["createCommentVNode"])("",!0),Object(n["createElementVNode"])("div",y,[Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=function(t){return e.invoice.coinAddress=t}),readonly:"",class:"form-input w-2/3 rounded-r-none"},null,512),[[n["vModelText"],e.invoice.coinAddress]]),Object(n["createElementVNode"])("div",E,[Object(n["createElementVNode"])("span",{onClick:t[3]||(t[3]=function(t){return $.copyToClipboard(e.invoice.coinAddress)}),class:"hover:bg-gray-200 dark:hover:bg-gray-700 cursor-pointer flex items-center leading-normal rounded rounded-l-none border border-l-0 border-gray-300 dark:border-gray-600 px-3 whitespace-no-wrap text-sm"},[Object(n["createVNode"])(be,{name:"clipboard",classes:"w-5 h-5"})])])])])]))]})),_:1},8,["name"]),Object(n["createVNode"])(me,{name:$.translate("invoice.tzero")},{default:Object(n["withCtx"])((function(){return[Object(n["createElementVNode"])("div",x,[Object(n["createElementVNode"])("p",C,Object(n["toDisplayString"])(e.timer),1),$.isPaid?(Object(n["openBlock"])(),Object(n["createElementBlock"])("a",{key:0,href:e.invoice.RedirectTargetURL,class:"mt-3 text-blue-500 hover:underline inline-flex items-center"},[q,Object(n["createVNode"])(be,{name:"arrow-right",classes:"w-5 h-5"})],8,w)):Object(n["createCommentVNode"])("",!0)]),$.isPaid||$.isExpired?Object(n["createCommentVNode"])("",!0):(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",B,[Object(n["createVNode"])(pe,{imgclass:"mx-auto",width:$.qrOptions.width,height:$.qrOptions.height,"qr-options":$.qrOptions.qrOptions,"background-options":$.qrOptions.backgroundOptions,"dots-options":$.qrOptions.dotsOptions,"corners-dot-options":$.qrOptions.cornersDotOptions,"corners-square-options":$.qrOptions.cornersSquareOptions,value:e.invoice.TZERO},null,8,["width","height","qr-options","background-options","dots-options","corners-dot-options","corners-square-options","value"])]))]})),_:1},8,["name"])]})),_:1}),Object(n["createElementVNode"])("p",S,Object(n["toDisplayString"])("".concat($.translate("pos.invoice.amount"),": ").concat(e.invoice.Amount," ").concat(e.invoice.LongName)),1),e.order.items.length>0?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",T,[Object(n["createElementVNode"])("div",D,[Object(n["createElementVNode"])("div",I,[Object(n["createElementVNode"])("table",L,[Object(n["createElementVNode"])("thead",null,[Object(n["createElementVNode"])("tr",null,[R,6===Object.keys(e.order.items[0]).length?(Object(n["openBlock"])(),Object(n["createElementBlock"])("th",P,"SKU")):Object(n["createCommentVNode"])("",!0),A,_,M])]),Object(n["createElementVNode"])("tbody",null,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.order.items,(function(t,o){return Object(n["openBlock"])(),Object(n["createElementBlock"])("tr",{key:o},[Object(n["createElementVNode"])("td",null,[Object(n["createElementVNode"])("div",U,[t.url?(Object(n["openBlock"])(),Object(n["createElementBlock"])("img",{key:0,src:t.url,alt:"",class:"w-12 h-12 rounded-full overflow-hidden mr-2 cursor-pointer",onClick:function(e){return $.fancyBox(t.url)}},null,8,H)):Object(n["createCommentVNode"])("",!0),Object(n["createElementVNode"])("p",null,Object(n["toDisplayString"])(t.name),1)])]),6===Object.keys(e.order.items[0]).length?(Object(n["openBlock"])(),Object(n["createElementBlock"])("td",z,Object(n["toDisplayString"])(t.sku),1)):Object(n["createCommentVNode"])("",!0),Object(n["createElementVNode"])("td",null,Object(n["toDisplayString"])($.formatPrice(t.price,$.currency)),1),Object(n["createElementVNode"])("td",null,Object(n["toDisplayString"])("x "+t.qty),1),Object(n["createElementVNode"])("td",null,Object(n["toDisplayString"])($.formatPrice(t.price*t.qty,$.currency)),1)])})),128)),e.order.shipping?(Object(n["openBlock"])(),Object(n["createElementBlock"])("tr",Q,[Object(n["createElementVNode"])("td",{colspan:6===Object.keys(e.order.items[0]).length?4:3,class:"text-right"},Object(n["toDisplayString"])($.translate("invoice.shipping_cost"))+": ",9,F),Object(n["createElementVNode"])("td",J,Object(n["toDisplayString"])(e.order.shipping.method+" "+$.formatPrice(e.order.shipping.cost,$.currency)),1)])):Object(n["createCommentVNode"])("",!0),e.order.coupon?(Object(n["openBlock"])(),Object(n["createElementBlock"])("tr",K,[Object(n["createElementVNode"])("td",{colspan:6===Object.keys(e.order.items[0]).length?4:3,class:"text-right"},[Object(n["createElementVNode"])("span",W,Object(n["toDisplayString"])($.translate("invoice.discount"))+":",1)],8,Z),Object(n["createElementVNode"])("td",G,[Object(n["createElementVNode"])("span",X,"-"+Object(n["toDisplayString"])($.formatPrice(e.order.coupon.discount,$.currency)),1)])])):Object(n["createCommentVNode"])("",!0),Object(n["createElementVNode"])("tr",null,[Object(n["createElementVNode"])("td",{colspan:6===Object.keys(e.order.items[0]).length?4:3,class:"text-right"},ee,8,Y),Object(n["createElementVNode"])("td",te,[Object(n["createElementVNode"])("span",oe,Object(n["toDisplayString"])($.cartTotal),1)])])])])])])])):Object(n["createCommentVNode"])("",!0),Object(n["createElementVNode"])("div",ne,[Object(n["createVNode"])(Oe,{to:{name:"invoice",params:{confirmCode:e.invoice.Security}},tag:"a",class:"btn btn-primary"},{default:Object(n["withCtx"])((function(){return[ce]})),_:1},8,["to"])])])]))],64)):Object(n["createCommentVNode"])("",!0)]})),_:1})}var de=o("5530"),be=(o("d81d"),o("a9e3"),o("498a"),o("4de4"),o("d3b7"),o("ac1f"),o("1276"),o("9e55")),pe=o("cdae"),me=o("6c02"),ue=o("5502"),Oe=o("8923"),je=o("bad0"),ve=o("f51a"),fe=o("61c6"),he=o.n(fe),ge=o("3fbe"),Ne=o("2e13"),ke=o("2ef0"),Ve=o("1d5e"),ye={name:"ShopInvoice",components:{CenteredLayout:be["a"],TabSet:je["a"],Tab:ve["a"],Icon:pe["a"],QRCodeVue3:he.a},setup:function(){var e=Object(n["inject"])("translate"),t=Object(n["inject"])("http"),o=Object(me["d"])(),c=Object(me["e"])(),r=Object(ue["b"])(),a=Object(ge["a"])(),i=a.qrOptions,l=Object(Ne["a"])(),s=l.copyToClipboard,d=l.formatPrice,b=l.fancyBox,p=Object(n["reactive"])({confirmCode:null,invoice:null,order:{items:[],shipping:null,coupon:null},interval:null,transactionInterval:null,timer:null,loader:"",socket:null,isClosedSocket:!1,status:"null"}),m=Object(n["computed"])((function(){return!!p.status&&-1!==["paid","underpaid","complete"].indexOf(p.status.toLowerCase())})),u=Object(n["computed"])((function(){return p.invoice&&("paid"===p.invoice.Status.toLowerCase()||"underpaid"===p.invoice.Status.toLowerCase())})),O=Object(n["computed"])((function(){return p.invoice&&"expired"===p.invoice.Status.toLowerCase()})),j=Object(n["computed"])((function(){return p.invoice.CoinName.toLowerCase()+":"+p.invoice.coinAddress+"?amount="+p.invoice.Amount})),v=Object(n["computed"])((function(){return p.invoice?p.invoice.inputCurrency:"EUR"})),f=Object(n["computed"])((function(){var e=0;return p.order.items.length>0&&p.order.items.map((function(t){e+=Number(t.qty)*Number(t.price)})),p.order.shipping&&(e+=Number(p.order.shipping.cost)),p.order.coupon&&(e-=Number(p.order.coupon.discount)),d(e,v.value)})),h="https://app.cointopay.com",g=function(e){var t=decodeURIComponent(e.CustomerReferenceNr),o=document.createElement("div");o.innerHTML=t;var n=o.innerHTML.trim();p.order={items:[],shipping:null,coupon:null},n&&(n=n.split(":::").filter(Boolean),n.map((function(e){e=e.split("|").filter(Boolean),6===e.length?p.order.items.push({id:e[0],sku:e[1],name:e[2],url:e[3],price:Number(e[4]),qty:Number(e[5])}):5===e.length?p.order.items.push({id:e[0],name:e[1],url:e[2],price:Number(e[3]),qty:Number(e[4])}):2===e.length?p.order.shipping={method:e[0],cost:e[1]}:3===e.length&&(p.order.coupon={code:e[0],value:e[1],discount:e[2]})})))},N=function(e){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"main";p.loader=o;var n={Call:"Transactiondetail",MerchantID:0,APIKey:"_",ConfirmCode:e,output:"json"};t.get("".concat(h,"/v2REAPI"),{params:n}).then((function(e){if(p.loader="",200===e.status&&"failed"!==e.data.result){p.invoice=e.data.data,g(p.invoice),r.commit(Oe["L"],p.invoice);var t=p.invoice.Status.toLowerCase();-1!==["paid","underpaid","expired"].indexOf(t)&&(p.timer=p.invoice.Status,p.transactionInterval&&clearInterval(p.transactionInterval),p.interval&&(clearInterval(p.interval),p.timer=t)),-1!==["waiting","awaiting-fiat"].indexOf(t)&&V()}})).catch((function(e){p.loader="",console.log(e)}))},k=function(){if(Object.keys(o.params).length>0){var e=o.params.confirmCode;N(e),p.transactionInterval&&clearInterval(p.transactionInterval),p.transactionInterval=setInterval((function(){N(e,!1)}),6e4)}else c.push({name:"shop"})},V=function(){if(!p.timer){var e=Ve.tz(p.invoice.CreatedOn,"Europe/Amsterdam").add(Number(p.invoice.ExpiryTime),"minutes");p.interval=setInterval((function(){var t=Ve().tz("Europe/Amsterdam").valueOf(),o=e.valueOf()-t,n=Math.floor(o/864e5),c=Math.floor(o%864e5/36e5),r=Math.floor(o%36e5/6e4),a=Math.floor(o%6e4/1e3);p.timer="".concat(n,"d ").concat(c,"h ").concat(r,"m ").concat(a,"s"),o<0&&(clearInterval(p.interval),p.timer="Expired",N(p.invoice.ConfirmCode,""))}),1e3)}},y=function e(){p.socket=new WebSocket("wss://wss.cointopay.com/transactions"),p.socket.onmessage=function(e){if(e&&e.data){var t=e.data.split(":");if(p.invoice){var o=ke["cloneDeep"](p.invoice);"TZERO"===t[0]&&o&&Number(o.TransactionID)===Number(t[1])&&(p.interval&&clearInterval(p.interval),o.Status=t[2].toLowerCase(),p.status=t[2].toLowerCase(),r.commit(Oe["L"],o))}}},p.socket.onclose=function(t){p.isClosedSocket||e()}};return Object(n["onBeforeMount"])((function(){k(),y()})),Object(n["onBeforeUnmount"])((function(){p.transactionInterval&&clearInterval(p.transactionInterval),p.interval&&clearInterval(p.interval),null!==p.socket&&(p.isClosedSocket=!0,p.socket.close())})),Object(de["a"])(Object(de["a"])({translate:e},Object(n["toRefs"])(p)),{},{currency:v,isInvoiceComplete:m,copyToClipboard:s,qrOptions:i,isPaid:u,isExpired:O,qrLink:j,formatPrice:d,cartTotal:f,fancyBox:b})}},Ee=o("6b0d"),xe=o.n(Ee);const Ce=xe()(ye,[["render",se]]);t["default"]=Ce}}]);
//# sourceMappingURL=shop-invoice.0a24d57f.js.map