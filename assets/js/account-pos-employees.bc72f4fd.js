(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["account-pos-employees"],{"273f":function(e,t,o){},4401:function(e,t,o){"use strict";o("273f")},efc9:function(e,t,o){"use strict";o.r(t);var s=o("f2bf");const r={class:"card"},l={class:"body"},c={class:"text-right mb-3"},a={class:"table-sm"},n=["onClick"],d={class:"cursor-pointer ml-3 text-base"},i={class:"text-right"},m={key:0,class:"pr-3"},p=["onClick"],b=["onClick"];function u(e,t,o,u,j,O){const g=Object(s["resolveComponent"])("j-button"),y=Object(s["resolveComponent"])("icon"),E=Object(s["resolveComponent"])("pos-layout"),w=Object(s["resolveComponent"])("save-employee-modal"),v=Object(s["resolveComponent"])("pos-login-modal");return Object(s["openBlock"])(),Object(s["createElementBlock"])(s["Fragment"],null,[Object(s["createVNode"])(E,null,{content:Object(s["withCtx"])(()=>[Object(s["createElementVNode"])("div",r,[Object(s["createElementVNode"])("div",l,[Object(s["createElementVNode"])("div",c,[Object(s["createVNode"])(g,{onClick:t[0]||(t[0]=e=>u.launchSaveEmployeeModal()),type:"button"},{default:Object(s["withCtx"])(()=>[Object(s["createTextVNode"])(Object(s["toDisplayString"])(u.translate("pos.employees.btn_add")),1)]),_:1})]),Object(s["createElementVNode"])("table",a,[Object(s["createElementVNode"])("tbody",null,[(Object(s["openBlock"])(!0),Object(s["createElementBlock"])(s["Fragment"],null,Object(s["renderList"])(u.employees,(e,t)=>(Object(s["openBlock"])(),Object(s["createElementBlock"])("tr",{key:t},[Object(s["createElementVNode"])("td",null,[Object(s["createElementVNode"])("div",{class:"flex items-center cursor-pointer",onClick:e=>u.login(t)},[Object(s["createVNode"])(y,{name:"user-circle",classes:"w-8 h-8 "+(u.isLoggedIn(e)?"text-blue-500":"")},null,8,["classes"]),u.isLoggedIn(e)?(Object(s["openBlock"])(),Object(s["createBlock"])(y,{key:0,name:"check-circle"})):Object(s["createCommentVNode"])("",!0),Object(s["createElementVNode"])("span",d,Object(s["toDisplayString"])(e.USERNAME),1)],8,n)]),Object(s["createElementVNode"])("td",i,["false"===e.isParentUser?(Object(s["openBlock"])(),Object(s["createElementBlock"])("div",m,[u.loggedInEmployee&&"true"===u.loggedInEmployee.isParentUser?(Object(s["openBlock"])(),Object(s["createElementBlock"])("button",{key:0,onClick:o=>u.launchSaveEmployeeModal(e,t),class:"mr-2 hover:text-blue-500"},[Object(s["createVNode"])(y,{name:"edit"})],8,p)):Object(s["createCommentVNode"])("",!0),u.loggedInEmployee&&"true"===u.loggedInEmployee.isParentUser?(Object(s["openBlock"])(),Object(s["createElementBlock"])("button",{key:1,onClick:e=>u.deleteEmployee(t),class:"hover:text-red-500"},[Object(s["createVNode"])(y,{name:"trash"})],8,b)):Object(s["createCommentVNode"])("",!0)])):Object(s["createCommentVNode"])("",!0)])]))),128))])])])])]),_:1}),Object(s["createVNode"])(w),Object(s["createVNode"])(v)],64)}var j=o("66c3"),O=o("4032"),g=o("cdae");const y={class:"flex items-center justify-between"},E={class:"mb-2"},w={class:"flex items-center justify-between mb-1"},v={class:"text-red-700 dark:text-red-400 text-sm"},x={class:"mb-2"},f={class:"flex items-center justify-between mb-1"},h={class:"text-red-700 dark:text-red-400 text-sm"},N={class:"mt-4 text-right"},V={key:0,class:"mr-3"};function k(e,t,o,r,l,c){const a=Object(s["resolveComponent"])("icon"),n=Object(s["resolveComponent"])("j-button"),d=Object(s["resolveComponent"])("modal");return Object(s["openBlock"])(),Object(s["createBlock"])(d,{maxWidth:e.maxWidth,show:e.show,onClose:t[4]||(t[4]=e=>r.closeModal())},{title:Object(s["withCtx"])(()=>[Object(s["createElementVNode"])("div",y,[Object(s["createElementVNode"])("span",null,Object(s["toDisplayString"])(r.translate("pos.employees.title")),1),Object(s["createElementVNode"])("span",{class:"text-gray-500 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-200 cursor-pointer",onClick:t[0]||(t[0]=e=>r.closeModal())},[Object(s["createVNode"])(a,{name:"close"})])])]),content:Object(s["withCtx"])(()=>[Object(s["createElementVNode"])("form",{onSubmit:t[3]||(t[3]=Object(s["withModifiers"])(e=>r.submit(),["prevent"]))},[Object(s["createElementVNode"])("div",E,[Object(s["createElementVNode"])("div",w,[Object(s["createElementVNode"])("label",null,Object(s["toDisplayString"])(r.translate("pos.employees.username")),1),Object(s["createElementVNode"])("div",v,Object(s["toDisplayString"])(r.showError(e.errorBag,"username")),1)]),Object(s["withDirectives"])(Object(s["createElementVNode"])("input",{class:"form-input w-full",type:"text","onUpdate:modelValue":t[1]||(t[1]=t=>e.form.username=t)},null,512),[[s["vModelText"],e.form.username]])]),Object(s["createElementVNode"])("div",x,[Object(s["createElementVNode"])("div",f,[Object(s["createElementVNode"])("label",null,Object(s["toDisplayString"])(r.translate("pos.employees.password")),1),Object(s["createElementVNode"])("div",h,Object(s["toDisplayString"])(r.showError(e.errorBag,"password")),1)]),Object(s["withDirectives"])(Object(s["createElementVNode"])("input",{class:"form-input w-full",placeholder:"000000",type:"text","onUpdate:modelValue":t[2]||(t[2]=t=>e.form.password=t)},null,512),[[s["vModelText"],e.form.password]])]),Object(s["createElementVNode"])("div",N,[Object(s["createVNode"])(n,{disabled:e.isProcessing},{default:Object(s["withCtx"])(()=>[e.isProcessing?(Object(s["openBlock"])(),Object(s["createElementBlock"])("div",V,[Object(s["createVNode"])(a,{name:"spinner",classes:"w-4 h-4 text-white"})])):Object(s["createCommentVNode"])("",!0),Object(s["createElementVNode"])("span",null,Object(s["toDisplayString"])(r.translate("pos.employees.btn_save")),1)]),_:1},8,["disabled"])])],32)]),_:1},8,["maxWidth","show"])}o("14d9");var B=o("714b"),C=o("ea45"),I=o("2ef0"),M=o("5502"),S=o("8923"),D=o("2e13"),P={name:"SaveEmployeeModal",components:{Modal:B["a"],Icon:g["a"],JButton:O["a"]},setup(){const e=Object(s["inject"])("translate"),t=Object(s["inject"])("emitter"),o=Object(s["inject"])("toast"),r=Object(M["b"])(),{showError:l,validate:c}=Object(C["a"])(),{generateId:a}=Object(D["a"])(),n=Object(s["reactive"])({show:!1,maxWidth:"2xl",closeable:!0,employee:null,type:"pin",index:-1,form:{username:"",password:""},errorBag:{},rules:{},messages:null,isProcessing:!1}),d=Object(s["computed"])(()=>r.state.pos),i=Object(s["computed"])(()=>r.state.posCalls);Object(s["watch"])(()=>({...n.form}),(e,t)=>{Object.keys(n.errorBag).length>0&&(n.errorBag=c(e,n.rules,n.messages))});const m=()=>{n.show=!1},p=()=>{if(n.errorBag=c(n.form,n.rules,n.messages),0===Object.keys(n.errorBag).length){n.isProcessing=!0;const e=n.form,t=I["cloneDeep"](d.value.users);let s=!0;n.employee?-1===I["findIndex"](t,t=>t.USERNAME===e.username&&t.ID!==n.employee.ID)?(t[n.index].USERNAME=e.username,t[n.index].PIN=e.password):(s=!1,n.isProcessing=!1,o.error("Username already exists!")):-1===I["findIndex"](t,{USERNAME:e.username})?t.push({ID:a(d.value.users),PIN:e.password,USERNAME:e.username,isLoggedIn:"false",isParentUser:"false"}):(s=!1,n.isProcessing=!1,o.error("Username already exists!")),s&&r.dispatch(S["v"],{call:i.value.users,data:t}).then(e=>{n.isProcessing=!1;const t=n.employee?"Employee updated successfully":"Employee added successfully";o.success(t),m()}).catch(e=>{console.log(e),n.isProcessing=!1,o.error("Internal Server Error")})}};return Object(s["onBeforeMount"])(()=>{t.on("saveEmployeeModal",e=>{n.employee=e.employee||null,n.index=e.index||-1,n.type=n.employee&&"true"===n.employee.isParentUser?"password":"pin",n.form={username:n.employee?n.employee.USERNAME:"",password:""},n.rules={username:["required"],password:"password"===n.type?["required"]:["required","regex:/^[0-9]{6}$/"]},n.messages={username:{required:"Username is required"},password:{required:"password"===n.type?"Password is required":"PIN is required",regex:"Please enter a 6 digit pin"}},n.show=!0})}),{translate:e,...Object(s["toRefs"])(n),closeModal:m,showError:l,submit:p}}},U=o("6b0d"),q=o.n(U);const L=q()(P,[["render",k]]);var R=L;const A={class:"flex items-center justify-between"},_={class:"mb-2"},W={class:"flex items-center justify-between mb-1"},T={class:"text-red-700 dark:text-red-400 text-sm"},J={class:"mb-2"},F={class:"flex items-center justify-between mb-1"},$={class:"text-red-700 dark:text-red-400 text-sm"},Y={class:"text-red-700 dark:text-red-400 text-sm"},z={class:"mt-4 text-right"},G={key:0,class:"mr-3"};function H(e,t,o,r,l,c){const a=Object(s["resolveComponent"])("icon"),n=Object(s["resolveComponent"])("j-button"),d=Object(s["resolveComponent"])("modal");return Object(s["openBlock"])(),Object(s["createBlock"])(d,{maxWidth:e.maxWidth,show:e.show,onClose:t[4]||(t[4]=e=>r.closeModal())},{title:Object(s["withCtx"])(()=>[Object(s["createElementVNode"])("div",A,[Object(s["createElementVNode"])("span",null,Object(s["toDisplayString"])(r.translate("pos.employees.title")),1),Object(s["createElementVNode"])("span",{class:"text-gray-500 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-200 cursor-pointer",onClick:t[0]||(t[0]=e=>r.closeModal())},[Object(s["createVNode"])(a,{name:"close"})])])]),content:Object(s["withCtx"])(()=>[Object(s["createElementVNode"])("form",{onSubmit:t[3]||(t[3]=Object(s["withModifiers"])(e=>r.submit(),["prevent"]))},[Object(s["createElementVNode"])("div",_,[Object(s["createElementVNode"])("div",W,[Object(s["createElementVNode"])("label",null,Object(s["toDisplayString"])(r.translate("pos.employees.username")),1),Object(s["createElementVNode"])("div",T,Object(s["toDisplayString"])(r.showError(e.errorBag,"username")),1)]),Object(s["withDirectives"])(Object(s["createElementVNode"])("input",{class:"form-input w-full",readonly:"",type:"text","onUpdate:modelValue":t[1]||(t[1]=t=>e.form.username=t)},null,512),[[s["vModelText"],e.form.username]])]),Object(s["createElementVNode"])("div",J,[Object(s["createElementVNode"])("div",F,[Object(s["createElementVNode"])("label",null,Object(s["toDisplayString"])(r.translate("pos.employees.password")),1),Object(s["createElementVNode"])("div",$,Object(s["toDisplayString"])(r.showError(e.errorBag,"password")),1)]),Object(s["withDirectives"])(Object(s["createElementVNode"])("input",{class:"form-input w-full",type:"password","onUpdate:modelValue":t[2]||(t[2]=t=>e.form.password=t)},null,512),[[s["vModelText"],e.form.password]]),Object(s["createElementVNode"])("div",Y,Object(s["toDisplayString"])(r.showError(e.errorBag,"password")),1)]),Object(s["createElementVNode"])("div",z,[Object(s["createVNode"])(n,{disabled:e.isProcessing},{default:Object(s["withCtx"])(()=>[e.isProcessing?(Object(s["openBlock"])(),Object(s["createElementBlock"])("div",G,[Object(s["createVNode"])(a,{name:"spinner",classes:"w-4 h-4 text-white"})])):Object(s["createCommentVNode"])("",!0),Object(s["createElementVNode"])("span",null,Object(s["toDisplayString"])(r.translate("pos.employees.btn_login")),1)]),_:1},8,["disabled"])])],32)]),_:1},8,["maxWidth","show"])}var K={name:"PosLoginModal",components:{Modal:B["a"],Icon:g["a"],JButton:O["a"]},setup(){const e=Object(s["inject"])("translate"),t=Object(s["inject"])("emitter"),o=Object(s["inject"])("toast"),r=Object(M["b"])(),{showError:l,validate:c}=Object(C["a"])(),a=Object(s["reactive"])({show:!1,maxWidth:"2xl",closeable:!0,index:-1,loggedInEmployee:null,form:{username:"",password:""},errorBag:{},rules:{},messages:{},isProcessing:!1}),n=Object(s["computed"])(()=>r.state.pos),d=Object(s["computed"])(()=>r.state.posCalls);Object(s["watch"])(()=>({...a.form}),(e,t)=>{Object.keys(a.errorBag).length>0&&(a.errorBag=c(e,a.rules,a.messages))});const i=()=>{a.show=!1},m=()=>{if(a.errorBag=c(a.form,a.rules,a.messages),0===Object.keys(a.errorBag).length){const e=a.form,t=I["cloneDeep"](n.value.users),s=t[a.index];s.USERNAME===e.username&&s.PIN===e.password?(a.loggedInEmployee&&t.filter(e=>{e.ID===a.loggedInEmployee.ID&&e.USERNAME===a.loggedInEmployee.USERNAME&&(e.isLoggedIn="false")}),t[a.index].isLoggedIn="true",r.dispatch(S["v"],{call:d.value.users,data:t}).catch(e=>{console.log(e)}),i()):o.error("Please provide a valid password/pin")}};return Object(s["onBeforeMount"])(()=>{t.on("posLoginModal",e=>{a.loggedInEmployee=e.loggedInEmployee,a.index=e.index,a.type=e.type,a.form={username:e.employee?e.employee.USERNAME:"",password:""},a.rules={username:["required"],password:"password"===a.type?["required"]:["required","regex:/^[0-9]{6}$/"]},a.messages={username:{required:"Username is required"},password:{required:"password"===a.type?"Password is required":"PIN is required",regex:"Please enter a 6 digit pin"}},a.show=!0})}),{translate:e,...Object(s["toRefs"])(a),showError:l,closeModal:i,submit:m}}};const Q=q()(K,[["render",H]]);var X=Q,Z={name:"Employees",components:{"pos-layout":j["a"],JButton:O["a"],Icon:g["a"],SaveEmployeeModal:R,PosLoginModal:X},setup(){const e=Object(s["inject"])("translate"),t=Object(s["inject"])("emitter"),o=Object(s["inject"])("swal"),r=Object(s["inject"])("toast"),l=Object(M["b"])(),c=Object(s["computed"])(()=>l.state.pos),a=Object(s["computed"])(()=>l.state.posCalls),n=Object(s["computed"])(()=>c.value.users),d=Object(s["computed"])(()=>I["find"](c.value.users,{isLoggedIn:"true"})),i=e=>d.value&&e.ID===d.value.ID,m=e=>{const o=I["cloneDeep"](c.value.users),s=o[e],r="true"===s.isParentUser?"password":"pin";"false"!==s.isLoggedIn&&s.ID===d.value.ID||t.emit("posLoginModal",{employee:s,type:r,loggedInEmployee:d.value,index:e})},p=(e=null,o=null)=>{t.emit("saveEmployeeModal",{employee:e,index:o})},b=e=>{o.fire({title:"Employee",text:"Are you sure, want to delete this employee?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"Yes",cancelButtonText:"No",focusCancel:!0,customClass:{container:"swal2-tailwind"}}).then(({value:t})=>{if(t&&!0===t){const t=I["cloneDeep"](c.value.users);t.splice(e,1),l.dispatch(S["v"],{call:a.value.users,data:t}).then(e=>{r.success("Employee deleted successfully")}).catch(e=>{console.log(e),r.error("Internal Server Error")})}})};return{translate:e,employees:n,loggedInEmployee:d,isLoggedIn:i,login:m,launchSaveEmployeeModal:p,deleteEmployee:b}}};o("4401");const ee=q()(Z,[["render",u],["__scopeId","data-v-6453e10f"]]);t["default"]=ee}}]);
//# sourceMappingURL=account-pos-employees.bc72f4fd.js.map