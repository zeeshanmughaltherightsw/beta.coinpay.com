(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["account-pos-products"],{"1e3c":function(e,t,c){"use strict";c.r(t);var o=c("f2bf");const r=e=>(Object(o["pushScopeId"])("data-v-2d2692d4"),e=e(),Object(o["popScopeId"])(),e),a={class:"card"},l=r(()=>Object(o["createElementVNode"])("hr",{class:"border-gray-300 dark:border-gray-600"},null,-1)),n={class:"body"},s={class:"flex items-center justify-end mb-3 flex-col lg:flex-row"},d=r(()=>Object(o["createElementVNode"])("option",{value:""},"Select Category",-1)),i=["value"],u={class:"relative mb-3 lg:mb-0 ml-0 lg:ml-3 w-full lg:w-auto"},m={key:0,class:"mx-auto mb-3 w-40"},b={class:"w-full scrollbar scrollbar-thin scrollbar-thumb-gray-400 scrollbar-track-gray-200 dark:scrollbar-track-gray-900 dark:scrollbar-thumb-gray-600"},p={class:"table-sm mb-2"},j=r(()=>Object(o["createElementVNode"])("th",null,"Category",-1)),O=r(()=>Object(o["createElementVNode"])("th",null,"Image",-1)),g={class:"flex items-center"},y=r(()=>Object(o["createElementVNode"])("th",{class:"whitespace-nowrap"},"SKU / EAN / Barcode / QR",-1)),v=r(()=>Object(o["createElementVNode"])("th",null,"Quantity",-1)),f={class:"flex items-center"},k=r(()=>Object(o["createElementVNode"])("th",null,"Actions",-1)),E=["onClick"],N={class:"w-12 h-12 rounded-full overflow-hidden"},h=["src","onClick"],V=["onClick"],w={class:"break-all"},x=["onClick"],C=["onClick"],B=["onClick"],I={class:"flex items-center space-x-1"},S=["onClick"],D=["onClick"],P={key:0,class:"flex items-center space-x-1"},M=["onClick"],A=["onClick"],q={key:1},U={colspan:"7",class:"text-center"};function R(e,t,c,r,R,T){const F=Object(o["resolveComponent"])("nav-tabs"),K=Object(o["resolveComponent"])("icon"),L=Object(o["resolveComponent"])("j-button"),J=Object(o["resolveComponent"])("StreamBarcodeReader"),H=Object(o["resolveComponent"])("pagination"),z=Object(o["resolveComponent"])("pos-layout"),W=Object(o["resolveComponent"])("save-product-modal"),X=Object(o["resolveComponent"])("add-to-cart-modal");return Object(o["openBlock"])(),Object(o["createElementBlock"])(o["Fragment"],null,[Object(o["createVNode"])(z,null,{content:Object(o["withCtx"])(()=>[Object(o["createElementVNode"])("div",a,[Object(o["createVNode"])(F),l,Object(o["createElementVNode"])("div",n,[Object(o["createElementVNode"])("div",s,[Object(o["createElementVNode"])("span",{class:"hover:text-blue-500 mb-3 lg:mb-0 ml-0 lg:ml-3 cursor-pointer w-full lg:w-auto",onClick:t[0]||(t[0]=t=>e.isBarcodeScanner=!e.isBarcodeScanner)},[Object(o["createVNode"])(K,{name:"barcode"})]),Object(o["withDirectives"])(Object(o["createElementVNode"])("select",{"aria-label":"Select Category",class:"form-select w-full mb-3 lg:mb-0 ml-0 lg:ml-3 w-full lg:w-72","onUpdate:modelValue":t[1]||(t[1]=t=>e.categoryId=t)},[d,(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(r.categories,(e,t)=>(Object(o["openBlock"])(),Object(o["createElementBlock"])("option",{key:t,value:e.id},Object(o["toDisplayString"])(e.name),9,i))),128))],512),[[o["vModelSelect"],e.categoryId]]),Object(o["createElementVNode"])("div",u,[Object(o["createVNode"])(K,{classes:"absolute w-5 h-5 top-3 left-3 dark:text-gray-300",name:"search"}),Object(o["withDirectives"])(Object(o["createElementVNode"])("input",{"onUpdate:modelValue":t[2]||(t[2]=t=>e.keyword=t),"aria-label":"Search...",class:"form-input px-10 w-full lg:w-auto",type:"text"},null,512),[[o["vModelText"],e.keyword]]),""!==e.keyword?(Object(o["openBlock"])(),Object(o["createElementBlock"])("span",{key:0,class:"absolute top-3 right-3 dark:text-gray-400 cursor-pointer",onClick:t[3]||(t[3]=t=>e.keyword="")},[Object(o["createVNode"])(K,{classes:"w-5 h-5",name:"close"})])):Object(o["createCommentVNode"])("",!0)]),e.employee&&"true"===e.employee.isParentUser?(Object(o["openBlock"])(),Object(o["createBlock"])(L,{key:0,class:"ml-3",type:"button",onClick:t[4]||(t[4]=e=>r.launchSaveProductModal())},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])(Object(o["toDisplayString"])(r.translate("pos.products.btn_add")),1)]),_:1})):Object(o["createCommentVNode"])("",!0)]),e.isBarcodeScanner?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",m,[Object(o["createVNode"])(J,{onDecode:r.onDecode,onError:r.onError},null,8,["onDecode","onError"])])):Object(o["createCommentVNode"])("",!0),Object(o["createElementVNode"])("div",b,[Object(o["createElementVNode"])("table",p,[Object(o["createElementVNode"])("thead",null,[Object(o["createElementVNode"])("tr",null,[j,O,Object(o["createElementVNode"])("th",{onClick:t[5]||(t[5]=e=>r.sort("itemName")),class:"cursor-pointer",style:{"max-width":"150px"}},[Object(o["createElementVNode"])("div",g,[Object(o["createTextVNode"])(" Name "),"itemName"===e.sortKey?(Object(o["openBlock"])(),Object(o["createElementBlock"])("span",{key:0,class:Object(o["normalizeClass"])("ml-4 transform transition-all "+("asc"===e.order?"rotate-180":""))},[Object(o["createVNode"])(K,{name:"sort",classes:"w-4 h-4"})],2)):Object(o["createCommentVNode"])("",!0)])]),y,v,Object(o["createElementVNode"])("th",{onClick:t[6]||(t[6]=e=>r.sort("price")),class:"cursor-pointer"},[Object(o["createElementVNode"])("div",f,[Object(o["createTextVNode"])(" Price "),"price"===e.sortKey?(Object(o["openBlock"])(),Object(o["createElementBlock"])("span",{key:0,class:Object(o["normalizeClass"])("ml-4 transform transition-all "+("asc"===e.order?"rotate-180":""))},[Object(o["createVNode"])(K,{name:"sort",classes:"w-4 h-4"})],2)):Object(o["createCommentVNode"])("",!0)])]),k])]),Object(o["createElementVNode"])("tbody",null,[r.filteredProducts.length>0?(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],{key:0},Object(o["renderList"])(r.paginatedProducts,(t,c)=>(Object(o["openBlock"])(),Object(o["createElementBlock"])("tr",{key:c},[Object(o["createElementVNode"])("td",null,[Object(o["createElementVNode"])("div",{onClick:c=>e.categoryId=t.categoryID,class:"cursor-pointer flex items-center"},[Object(o["createElementVNode"])("div",{style:Object(o["normalizeStyle"])("background: #"+r.getCategoryColorCode(t.categoryID)),class:"inline-block w-5 h-5 rounded-full mr-3"},null,4),Object(o["createTextVNode"])(" "+Object(o["toDisplayString"])(r.getCategoryName(t.categoryID)),1)],8,E)]),Object(o["createElementVNode"])("td",null,[Object(o["createElementVNode"])("div",N,[Object(o["createElementVNode"])("img",{src:t.imageUri,alt:"",class:"w-12 h-12 object-cover",onClick:e=>r.fancyBox(t.imageUri)},null,8,h)])]),Object(o["createElementVNode"])("td",{onClick:e=>r.launchAddToCartModal(t),class:"cursor-pointer whitespace-normal",style:{width:"150px"}},[Object(o["createElementVNode"])("p",w,Object(o["toDisplayString"])(t.itemName),1)],8,V),Object(o["createElementVNode"])("td",{onClick:e=>r.launchAddToCartModal(t),class:"cursor-pointer"},Object(o["toDisplayString"])(t.sku),9,x),Object(o["createElementVNode"])("td",{onClick:e=>r.launchAddToCartModal(t),class:"cursor-pointer"},Object(o["toDisplayString"])(t.stock),9,C),Object(o["createElementVNode"])("td",{onClick:e=>r.launchAddToCartModal(t),class:"cursor-pointer"},Object(o["toDisplayString"])(`${t.price} ${r.currency}`),9,B),Object(o["createElementVNode"])("td",null,[Object(o["createElementVNode"])("div",I,[Object(o["createElementVNode"])("button",{onClick:e=>r.launchAddToCartModal(t),class:"hover:text-blue-500",type:"button"},[Object(o["createVNode"])(K,{name:"shopping-cart"})],8,S),Object(o["createElementVNode"])("button",{onClick:e=>r.markFavourite(t,c)},[Object(o["createVNode"])(K,{name:"heart",classes:"w-6 h-6 hover:text-red-500 "+(r.isFavourite(t)?"text-red-500":"")},null,8,["classes"])],8,D),e.employee&&"true"===e.employee.isParentUser?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",P,[Object(o["createElementVNode"])("button",{onClick:e=>r.launchSaveProductModal(t),class:"hover:text-blue-500"},[Object(o["createVNode"])(K,{name:"edit"})],8,M),Object(o["createElementVNode"])("button",{onClick:e=>r.deleteProduct(t.id),class:"hover:text-red-500"},[Object(o["createVNode"])(K,{name:"trash"})],8,A)])):Object(o["createCommentVNode"])("",!0)])])]))),128)):(Object(o["openBlock"])(),Object(o["createElementBlock"])("tr",q,[Object(o["createElementVNode"])("td",U,Object(o["toDisplayString"])(r.translate("address_book.empty")),1)]))])])]),r.filteredProducts.length>0?(Object(o["openBlock"])(),Object(o["createBlock"])(H,{key:1,meta:e.meta,onPage:r.updatePage},null,8,["meta","onPage"])):Object(o["createCommentVNode"])("",!0)])])]),_:1}),Object(o["createVNode"])(W),Object(o["createVNode"])(X)],64)}c("14d9");var T=c("66c3"),F=c("edc4"),K=c("cdae"),L=c("4032"),J=c("d529");const H={class:"flex items-center justify-between"},z={class:"mb-2"},W={class:"flex items-center justify-between mb-1"},X={class:"text-red-500 text-sm"},Q=Object(o["createElementVNode"])("option",{value:""},"Select Category",-1),Y=["value"],G={class:"mb-2"},_={class:"flex items-center justify-between mb-1"},Z={class:"text-red-500 text-sm"},$={class:"mb-2"},ee={class:"flex items-center justify-between mb-1"},te={class:"text-red-500 text-sm"},ce={class:"mb-2"},oe={class:"grid grid-cols-2 gap-1 md:gap-4"},re={class:"col-span-1"},ae={class:"flex items-center justify-between mb-1"},le={class:"text-red-500 text-sm"},ne={class:"col-span-1"},se={class:"flex items-center justify-between mb-1"},de={class:"text-red-500 text-sm"},ie={class:"mb-4"},ue={class:"flex items-center justify-between mb-1"},me={class:"text-red-500 text-sm"},be={class:"flex items-center justify-between"},pe={class:"mb-2"},je={class:"grid grid-cols-2 gap-1 md:gap-4"},Oe={class:"col-span-1"},ge={class:"w-28 h-28 overflow-hidden mx-auto"},ye={for:"file",class:"cursor-pointer"},ve=["src"],fe={class:"col-span-1"},ke={key:0,class:"mx-auto w-40"},Ee={class:"mt-4 text-right"},Ne={key:0,class:"mr-3"};function he(e,t,c,r,a,l){const n=Object(o["resolveComponent"])("icon"),s=Object(o["resolveComponent"])("StreamBarcodeReader"),d=Object(o["resolveComponent"])("j-button"),i=Object(o["resolveComponent"])("modal"),u=Object(o["resolveDirective"])("tippy");return Object(o["openBlock"])(),Object(o["createBlock"])(i,{maxWidth:e.maxWidth,show:e.show,onClose:t[10]||(t[10]=e=>r.closeModal())},{title:Object(o["withCtx"])(()=>[Object(o["createElementVNode"])("div",H,[Object(o["createElementVNode"])("span",null,Object(o["toDisplayString"])(r.translate("pos.products.title")),1),Object(o["createElementVNode"])("span",{class:"text-gray-500 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-200 cursor-pointer",onClick:t[0]||(t[0]=e=>r.closeModal())},[Object(o["createVNode"])(n,{name:"close"})])])]),content:Object(o["withCtx"])(()=>[Object(o["createElementVNode"])("form",{onSubmit:t[9]||(t[9]=Object(o["withModifiers"])(e=>r.submit(),["prevent"]))},[Object(o["createElementVNode"])("div",z,[Object(o["createElementVNode"])("div",W,[Object(o["createElementVNode"])("label",null,Object(o["toDisplayString"])(r.translate("pos.products.select_category")),1),Object(o["createElementVNode"])("div",X,Object(o["toDisplayString"])(r.showError(e.errorBag,"categoryId")),1)]),Object(o["withDirectives"])(Object(o["createElementVNode"])("select",{class:"form-select w-full","onUpdate:modelValue":t[1]||(t[1]=t=>e.form.categoryId=t)},[Q,(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(r.categories,(e,t)=>(Object(o["openBlock"])(),Object(o["createElementBlock"])("option",{key:t,value:e.id},Object(o["toDisplayString"])(e.name),9,Y))),128))],512),[[o["vModelSelect"],e.form.categoryId]])]),Object(o["createElementVNode"])("div",G,[Object(o["createElementVNode"])("div",_,[Object(o["createElementVNode"])("label",null,Object(o["toDisplayString"])(r.translate("pos.products.name")),1),Object(o["createElementVNode"])("div",Z,Object(o["toDisplayString"])(r.showError(e.errorBag,"name")),1)]),Object(o["withDirectives"])(Object(o["createElementVNode"])("input",{class:"form-input w-full",type:"text","onUpdate:modelValue":t[2]||(t[2]=t=>e.form.name=t)},null,512),[[o["vModelText"],e.form.name]])]),Object(o["createElementVNode"])("div",$,[Object(o["createElementVNode"])("div",ee,[Object(o["createElementVNode"])("label",null,Object(o["toDisplayString"])(r.translate("pos.products.description")),1),Object(o["createElementVNode"])("div",te,Object(o["toDisplayString"])(r.showError(e.errorBag,"description")),1)]),Object(o["withDirectives"])(Object(o["createElementVNode"])("textarea",{class:"form-input w-full",rows:"4","onUpdate:modelValue":t[3]||(t[3]=t=>e.form.description=t)},null,512),[[o["vModelText"],e.form.description]])]),Object(o["createElementVNode"])("div",ce,[Object(o["createElementVNode"])("div",oe,[Object(o["createElementVNode"])("div",re,[Object(o["createElementVNode"])("div",ae,[Object(o["createElementVNode"])("label",null,Object(o["toDisplayString"])(r.translate("pos.products.quantity")),1),Object(o["createElementVNode"])("div",le,Object(o["toDisplayString"])(r.showError(e.errorBag,"quantity")),1)]),Object(o["withDirectives"])(Object(o["createElementVNode"])("input",{class:"form-input w-full",type:"text","onUpdate:modelValue":t[4]||(t[4]=t=>e.form.quantity=t)},null,512),[[o["vModelText"],e.form.quantity]])]),Object(o["createElementVNode"])("div",ne,[Object(o["createElementVNode"])("div",se,[Object(o["createElementVNode"])("label",null,Object(o["toDisplayString"])(r.translate("pos.products.price"))+"Â ("+Object(o["toDisplayString"])(e.currency)+")",1),Object(o["createElementVNode"])("div",de,Object(o["toDisplayString"])(r.showError(e.errorBag,"price")),1)]),Object(o["withDirectives"])(Object(o["createElementVNode"])("input",{class:"form-input w-full",type:"text","onUpdate:modelValue":t[5]||(t[5]=t=>e.form.price=t)},null,512),[[o["vModelText"],e.form.price]])])])]),Object(o["createElementVNode"])("div",ie,[Object(o["createElementVNode"])("div",ue,[Object(o["createElementVNode"])("label",null,Object(o["toDisplayString"])(r.translate("pos.products.sku")),1),Object(o["createElementVNode"])("div",me,Object(o["toDisplayString"])(r.showError(e.errorBag,"sku")),1)]),Object(o["createElementVNode"])("div",be,[Object(o["withDirectives"])(Object(o["createElementVNode"])("input",{class:"form-input w-full",type:"text","onUpdate:modelValue":t[6]||(t[6]=t=>e.form.sku=t)},null,512),[[o["vModelText"],e.form.sku]]),Object(o["createElementVNode"])("span",{class:"hover:text-blue-500 ml-3 cursor-pointer",onClick:t[7]||(t[7]=t=>e.isBarcodeScanner=!e.isBarcodeScanner)},[Object(o["createVNode"])(n,{name:"barcode"})])])]),Object(o["createElementVNode"])("div",pe,[Object(o["createElementVNode"])("div",je,[Object(o["createElementVNode"])("div",Oe,[Object(o["createElementVNode"])("div",ge,[Object(o["withDirectives"])((Object(o["openBlock"])(),Object(o["createElementBlock"])("label",ye,[Object(o["createElementVNode"])("img",{class:"w-28 h-28 object-cover",src:r.getImageUrl,alt:""},null,8,ve)])),[[u,"Click here to upload"]]),Object(o["createElementVNode"])("input",{onChange:t[8]||(t[8]=e=>r.upload(e)),class:"hidden",id:"file",type:"file",ref:"featuredImg"},null,544)])]),Object(o["createElementVNode"])("div",fe,[e.isBarcodeScanner?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",ke,[Object(o["createVNode"])(s,{onDecode:r.onDecode,onError:r.onError},null,8,["onDecode","onError"])])):Object(o["createCommentVNode"])("",!0)])])]),Object(o["createElementVNode"])("div",Ee,[Object(o["createVNode"])(d,{disabled:e.isProcessing},{default:Object(o["withCtx"])(()=>[e.isProcessing?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",Ne,[Object(o["createVNode"])(n,{name:"spinner",classes:"w-4 h-4 text-white"})])):Object(o["createCommentVNode"])("",!0),Object(o["createElementVNode"])("span",null,Object(o["toDisplayString"])(r.translate("pos.products.btn_save")),1)]),_:1},8,["disabled"])])],32)]),_:1},8,["maxWidth","show"])}var Ve=c("714b"),we=c("ea45"),xe=c("5502"),Ce=c("2ef0"),Be=c("8923"),Ie=c("f337"),Se={name:"SaveProductModal",components:{Modal:Ve["a"],Icon:K["a"],JButton:L["a"],StreamBarcodeReader:Ie["a"]},setup(){const e=Object(o["inject"])("translate"),t=Object(o["inject"])("emitter"),r=Object(o["inject"])("http"),a=Object(o["inject"])("toast"),l=Object(xe["b"])(),{showError:n,validate:s}=Object(we["a"])(),d=Object(o["ref"])(null),i=Object(o["reactive"])({show:!1,maxWidth:"2xl",closeable:!0,product:null,currency:null,form:{categoryId:"",name:"",description:"",imageUrl:"",quantity:"",price:"",sku:""},errorBag:{},rules:{categoryId:["required"],name:["required"],description:["required"],sku:["required"],quantity:["required","minValue:1","maxValue:9999999"],price:["required","minValue:0.1","regex:/^[0-9]{1,8}([,.][0-9]{1,8})?$/"]},messages:{categoryId:{required:"Please select category"},name:{required:"Product name is required"},description:{required:"Product description is required"},sku:{required:"Product sku is required"},quantity:{required:"Product stock level is required",minValue:"Product stock should be between 1 and 9999999",maxValue:"Product stock should be between 1 and 9999999"},price:{required:"Product price is required",regex:"Please enter a valid price value",minValue:"Price should be greater than 0"}},isProcessing:!1,isBarcodeScanner:!1}),u=Object(o["computed"])(()=>l.state.user),m=Object(o["computed"])(()=>l.state.pos),b=Object(o["computed"])(()=>l.state.posCalls),p=Object(o["computed"])(()=>i.form.imageUrl?i.form.imageUrl:c("f144"));Object(o["watch"])(()=>({...i.form}),(e,t)=>{Object.keys(i.errorBag).length>0&&(i.errorBag=s(i.form,i.rules,i.messages))});const j=()=>{i.show=!1},O=e=>{e&&(i.form.sku=e,i.isBarcodeScanner=!1)},g=e=>{console.log(e)},y=()=>{const e=Ce["cloneDeep"](m.value.products);if(e.length>0){const t=Ce["maxBy"](e,e=>Number(e.id));return(Number(t.id)+1).toString()}return"1"},v=e=>{const t=e.target.files;if(t.length>0){const e=t[0];if(e.type.startsWith("image/")){const t=new FormData;t.append("file123",e),t.append("MerchantID",u.value.ID);const c="https://app.cointopay.com";r.post(c+"/MarketAPI?POSBLOB",t,{headers:{"Content-Type":"multipart/form-data"}}).then(e=>{200===e.status&&(i.form.imageUrl=e.data,d.value.value="")}).catch(e=>{console.log(e)})}else d.value.value="",a.error("Please provide a valid image file")}},f=()=>{if(i.errorBag=s(i.form,i.rules,i.messages),0===Object.keys(i.errorBag).length){i.isProcessing=!0;const e=i.form,t=Ce["cloneDeep"](m.value.products);let c=!0;if(i.product){let o=Ce["findIndex"](t,t=>t.sku===e.sku&&i.product.id!==t.id);-1===o?(o=Ce["findIndex"](t,{id:i.product.id}),t.splice(o,1,{id:i.product.id,categoryID:e.categoryId,itemName:e.name,description:e.description,imageUri:e.imageUrl,sku:e.sku,stock:e.quantity,price:e.price})):(c=!1,i.isProcessing=!1,a.error("Product with this sku already exists!"))}else-1===Ce["findIndex"](t,{sku:e.sku})?t.push({id:y(),categoryID:e.categoryId,itemName:e.name,description:e.description,imageUri:e.imageUrl,sku:e.sku,stock:e.quantity,price:e.price}):(c=!1,i.isProcessing=!1,a.error("Product with this sku already exists!"));c&&l.dispatch(Be["w"],{call:b.value.products,data:t}).then(()=>{i.isProcessing=!1;const e=i.product?"Product updated successfully":"Product added successfully";a.success(e),j()}).catch(e=>{console.log(e),i.isProcessing=!1,a.error("Internal Server Error")})}};return Object(o["onBeforeMount"])(()=>{t.on("saveProductModal",e=>{i.product=e.product||null,i.currency=e.currency,d.value&&(d.value.value=""),i.form={categoryId:i.product?i.product.categoryID:"",name:i.product?i.product.itemName:"",description:i.product?i.product.description:"",imageUrl:i.product?i.product.imageUri:"",quantity:i.product?i.product.stock:"",price:i.product?i.product.price:"",sku:i.product?i.product.sku:""},i.show=!0})}),{translate:e,...Object(o["toRefs"])(i),featuredImg:d,categories:m.value.categories,showError:n,closeModal:j,getImageUrl:p,onDecode:O,onError:g,upload:v,submit:f}}},De=c("6b0d"),Pe=c.n(De);const Me=Pe()(Se,[["render",he]]);var Ae=Me,qe=c("19ee"),Ue=c("6605"),Re=c("2e13"),Te={name:"Products",components:{NavTabs:F["a"],"pos-layout":T["a"],Icon:K["a"],JButton:L["a"],Pagination:J["a"],StreamBarcodeReader:Ie["a"],SaveProductModal:Ae,AddToCartModal:qe["a"]},setup(){const e=Object(o["inject"])("translate"),t=Object(o["inject"])("toast"),c=Object(o["inject"])("swal"),r=Object(o["inject"])("emitter"),a=Object(xe["b"])(),l=Object(Ue["d"])(),{fancyBox:n}=Object(Re["a"])(),s=Object(o["reactive"])({employee:null,keyword:"",categoryId:"",sortKey:null,order:"asc",meta:{currentPage:1,totalPages:0,limit:25,offset:0},isBarcodeScanner:!1}),d=Object(o["computed"])(()=>a.state.accountInfo),i=Object(o["computed"])(()=>a.state.altCoins),u=Object(o["computed"])(()=>a.state.pos),m=Object(o["computed"])(()=>a.state.posCalls),b=Object(o["computed"])(()=>{if(s.keyword||s.categoryId){const e=s.keyword.trim().toLowerCase();return u.value.products.filter(t=>{return s.categoryId&&e?t.categoryID===s.categoryId&&(Ce["includes"](t.itemName.toLowerCase(),e)||Ce["includes"](t.sku.toLowerCase(),e)||Ce["includes"](t.description.toLowerCase(),e)||Number(t.price)===Number(e)):s.categoryId?t.categoryID===s.categoryId:e&&t.itemName?Ce["includes"](null===(c=t.itemName)||void 0===c?void 0:c.toLowerCase(),e)||Ce["includes"](null===(o=t.sku)||void 0===o?void 0:o.toLowerCase(),e)||Ce["includes"](null===(r=t.description)||void 0===r?void 0:r.toLowerCase(),e)||Number(t.price)===Number(e):void 0;var c,o,r})}return u.value.products}),p=Object(o["computed"])(()=>{if(b.value&&b.value.length>0){let e=Ce["cloneDeep"](b.value);return e=e.map(e=>({...e,price:Number.parseFloat(e.price)})),e=Ce["orderBy"](e,s.sortKey,s.order),e.slice(s.meta.offset,s.meta.currentPage*s.meta.limit)}return b.value}),j=Object(o["computed"])(()=>{let e="EUR";if(d.value){e=d.value.PayoutCurrencyShortName;const t=Ce["find"](i.value,{ShortName:d.value.PayoutCurrencyShortName});t&&(e=t.LongName)}return e});Object(o["watch"])(()=>s.keyword,(e,t)=>{s.meta={...s.meta,currentPage:1,totalPages:Math.ceil(b.value.length/s.meta.limit),offset:0}});const O=e=>{e===s.sortKey&&(s.order="asc"===s.order?"desc":"asc"),s.sortKey=e},g=e=>{const t=Ce["find"](u.value.categories,{id:e});return t?t.name:""},y=e=>{const t=Ce["find"](u.value.categories,{id:e});return t?t.categoryColourCode:""},v=e=>e.sku?-1!==Ce["findIndex"](u.value.favourites,{sku:e.sku}):!!e.id&&-1!==Ce["findIndex"](u.value.favourites,{id:e.id}),f=e=>{s.meta={...s.meta,currentPage:e,offset:(e-1)*s.meta.limit}},k=e=>{const c=Ce["cloneDeep"](u.value.favourites);let o=-1;e.sku?o=Ce["findIndex"](c,{sku:e.sku}):e.id&&(o=Ce["findIndex"](c,{id:e.id})),-1===o?(c.push(e),t.success("Product marked favourite successfully")):(c.splice(o,1),t.success("Product unmarked favourite successfully"));const r=Ce["cloneDeep"](u.value);r.favourites=c,a.commit(Be["S"],r)},E=e=>{const o=Ce["findIndex"](u.value.products,{id:e});-1!==o&&c.fire({title:"Product",text:"Are you sure you want to remove this product?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"Yes",cancelButtonText:"No",focusCancel:!0,customClass:{container:"swal2-tailwind"}}).then(({value:e})=>{if(e&&!0===e){const e=Ce["cloneDeep"](u.value.products);e.splice(o,1),a.dispatch(Be["w"],{call:m.value.products,data:e}).then(e=>{t.success("Product deleted successfully")}).catch(e=>{console.log(e),t.error("Internal Server Error")})}})},N=e=>{s.keyword=e,s.isBarcodeScanner=!1;const t=Ce["find"](u.value.products,{sku:e});t&&V(t)},h=e=>{console.log(e)},V=e=>{Number(e.stock)>0?r.emit("addToCartModal",{product:e,currency:j.value,employee:s.employee}):t.warning("Product out of stock")},w=(e=null)=>{r.emit("saveProductModal",{product:e,currency:j.value})};return Object(o["onBeforeMount"])(()=>{s.employee=Ce["find"](u.value.users,{isLoggedIn:"true"}),s.meta={...s.meta,currentPage:1,totalPages:Math.ceil(b.value.length/s.meta.limit),offset:0}}),Object(o["onMounted"])(()=>{Object.keys(l.query).length>0&&"undefined"!==typeof l.query.category_id&&(s.categoryId=l.query.category_id)}),{translate:e,...Object(o["toRefs"])(s),filteredProducts:b,paginatedProducts:p,categories:u.value.categories,sort:O,updatePage:f,getCategoryName:g,getCategoryColorCode:y,isFavourite:v,currency:j,markFavourite:k,deleteProduct:E,onDecode:N,onError:h,launchAddToCartModal:V,launchSaveProductModal:w,fancyBox:n}}};c("63bd");const Fe=Pe()(Te,[["render",R],["__scopeId","data-v-2d2692d4"]]);t["default"]=Fe},"3b29":function(e,t,c){},"63bd":function(e,t,c){"use strict";c("3b29")},f144:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAMAAACahl6sAAAAVFBMVEXp7vG6vsHn7fDr8PO3u761uLuxtbju8/bO09bx9vnv9PfDx8qvsrXKz9K9wcTh5eiws7bg5um5vcCzt7rW2t3t8vXS19rBxMfk6u3Z3uHz+PvHy863ukFnAAACm0lEQVR42u3a23KiQBSF4b3X7m4EMWOak4f3f88RLCqHjpmJXNCk1neRS6t+45KmRIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiCZYSvIAKcoFqsqyKIFcTof9EleUsj6I7WvvlvD1AJOVQWTwulQzyOqs91EXC323+k5enKo71s87Ti9wWTsER1U3wJ43vRX1yVYoSUIOJeRZKHdeNbzmEVItCCkyDIHcYeMhEBNg+rvpEBj6wTduaGHYcAjspI2L0bkwnAybDYEUwemdc91m/yOQSp3O/EuJrYbY2UWdxVoeDB7Zh1Q7r2/8l4cnmBhyD+mu7n3IF9dIoOzDxZB5SPGvEEjXB+fFcg/58NFq2g6fO8q+iepeToasQ+zs9Luxo2pDVL2ViCHnkO+/foGy9VFHzl8M+YbIrST4dxfEdB9z5biTjEOmI4p37u2IkuxjNu0k35Dk0JjuYzLvJN+Q5Bif7mMy7yTfkOTGKt3H+51kHJJI9vFxJ9mHAA/28XknmYegqwRf7SPdSdYhKPrp3U73ke4k5xBUbRMGM6T7SHeScQiqc+O02Zth3sdDzSHfkFvHtAl/K5n38ZA/WK4h6NrGzT8VFOM+thky7iPqXbM/N3GjIfd9zJyLus2QeR+zqNsMmffxZpsh931sP+S+j+2HwMZrxi8IEds7/RUh3ZUhDGHItyF7736qyTHEDvryU3GX4/0InpD3Pfu2n3x4Wl4hF3veZQw5rh8SVKOeX/886/WPRtUaAlnX4FRdExYYXyBcVu6AjTchS8XQrv7JErmGuLjjuvpTpgIp+jr4JUK9W79DBCiq826JtiokC4AVS1g2D8cL/kvuz/gTEREREREREREREREREREREREREREREREREdHa/gKrrUWVgnSBWwAAAABJRU5ErkJggg=="}}]);
//# sourceMappingURL=account-pos-products.61d00fef.js.map