{"version":3,"sources":["webpack:///./src/views/Shop.vue","webpack:///./src/views/Shop.vue?7dcc","webpack:///./src/components/ProductSkeleton.vue","webpack:///./src/components/ProductSkeleton.vue?44ac"],"names":["class","_createElementVNode","value","_hoisted_16","_hoisted_17","_createBlock","_component_centered_layout","_ctx","_component_product_skeleton","counter","_createElementBlock","_Fragment","key","_hoisted_1","_hoisted_2","_createVNode","_component_router_link","to","name","params","id","$setup","tag","Avatar","src","alt","onClick","ShopTitle","_hoisted_6","aria-label","_hoisted_7","cat","index","_hoisted_9","_component_icon","classes","placeholder","type","_hoisted_10","product","shopId","imageUri","_hoisted_12","itemName","_hoisted_13","price","_hoisted_14","_component_star_rating","increment","max-rating","rating","sku","read-only","show-rating","star-size","active-color","inactive-color","length","totalPages","_hoisted_19","disabled","currentPage","_hoisted_21","components","CenteredLayout","ProductSkeleton","StarRating","Icon","setup","toast","inject","store","useStore","route","useRoute","router","useRouter","saveNotification","formatPrice","copyToClipboard","compositionUtils","state","reactive","shop","category","keyword","selectedShop","meta","limit","offset","ratings","isProcessing","computed","shopsList","productsFilters","altCoins","currency","PayoutCurrencyShortName","altCoin","_","ShortName","LongName","productCategories","categories","filter","self","findIndex","t","products","categoryID","filteredProducts","trim","toLowerCase","description","Number","stock","paginatedProducts","slice","selectedCategory","watch","newVal","oldVal","ID","toString","Math","ceil","updateProductsFilters","isAvatar","img","fetchProducts","dispatch","FETCH_SHOP_DATA","then","response","warning","push","Object","keys","query","page","catch","error","console","log","fetchRatings","FETCH_RATINGS","resetShopItems","commit","SET_SHOP_DATA","filters","SET_PRODUCTS_FILTERS","getProductRatings","map","SKU","ReviewStars","paginate","window","location","href","onBeforeMount","FETCH_SHOPS_LIST","SET_SHOP_ID","categoryId","setTimeout","toRefs","__exports__","render","$props","count","props"],"mappings":"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","file":"assets/js/shop-detail.380bfac7.js","sourcesContent":["<template>\r\n  <centered-layout>\r\n    <template v-if=\"isProcessing\">\r\n      <product-skeleton :counter=\"8\"></product-skeleton>\r\n    </template>\r\n    <template v-else>\r\n      <div class=\"mb-3 flex items-center justify-between flex-col lg:flex-row\">\r\n        <p class=\"flex items-center\" v-if=\"selectedShop\">\r\n          <router-link :to=\"{name: 'shop-detail', params: {id: shopId}}\" tag=\"a\" class=\"flex items-center mr-2\">\r\n            <img v-if=\"isAvatar(selectedShop.Avatar)\" :src=\"selectedShop.Avatar\"\r\n                 alt=\"\" class=\"w-8 h-8 rounded-full mr-2\"/>\r\n            <span @click=\"category = ''\">{{ selectedShop.ShopTitle }}</span>\r\n          </router-link>\r\n          <span v-if=\"selectedCategory\"> > Category > {{ selectedCategory.name }}</span>\r\n          <span v-else> > Category > all</span>\r\n        </p>\r\n        <div class=\"flex items-center justify-between flex-col lg:flex-row\">\r\n          <select v-model=\"category\" aria-label=\"Filter\" class=\"form-select w-full lg:w-auto mr-0 lg:mr-3 mb-3 lg:mb-0\">\r\n            <option value=\"\">Filter Products</option>\r\n            <option v-for=\"(cat, index) of productCategories\" :key=\"index\" :value=\"cat.id\">\r\n              {{ cat.name }}\r\n            </option>\r\n          </select>\r\n          <div class=\"relative w-full lg:w-auto\">\r\n            <icon classes=\"absolute w-5 h-5 top-3 left-3 dark:text-gray-300\" name=\"search\"></icon>\r\n            <input v-model=\"keyword\" aria-label=\"Search...\" placeholder=\"Search...\"\r\n                   class=\"form-input px-10 w-full lg:w-auto\" type=\"text\"/>\r\n            <span v-if=\"keyword !== ''\" class=\"absolute top-3 right-3 dark:text-gray-400 cursor-pointer\"\r\n                  @click=\"keyword = ''\">\r\n              <icon classes=\"w-5 h-5\" name=\"close\"></icon>\r\n            </span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"grid grid-cols-4 gap-2 xl:gap-3\">\r\n        <div :key=\"index\"\r\n             class=\"h-72 shadow bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-900 rounded col-span-4 md:col-span-2 lg:col-span-1 p-4\"\r\n             v-for=\"(product, index) in paginatedProducts\">\r\n          <router-link :to=\"{name: 'product-detail', params: {shopId: shopId, id: product.id}}\" tag=\"a\">\r\n            <img :src=\"product.imageUri\" alt=\"\" class=\"w-32 h-32 mx-auto object-contain\"/>\r\n          </router-link>\r\n          <h5 class=\"text-center py-1 font-semibold\">{{ product.itemName }}</h5>\r\n          <p class=\"text-center font-semibold mb-3\">{{ formatPrice(product.price, currency) }}</p>\r\n          <div class=\"flex items-center justify-center mb-3\">\r\n            <star-rating :increment=\"0.1\" :max-rating=\"5\" :rating=\"getProductRatings(product.sku)\"\r\n                         :read-only=\"true\" :show-rating=\"true\" :star-size=\"20\"\r\n                         active-color=\"#ffd200\" inactive-color=\"#d0d0d0\"></star-rating>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div v-if=\"shopId && shop && paginatedProducts.length === 0\">\r\n        <hr class=\"border-gray-300 dark:border-gray-600\"/>\r\n        <div class=\"w-full rounded shadow px-4 py-3 bg-yellow-500 mb-4 text-yellow-900 font-semibold mt-3\">\r\n          No products found\r\n        </div>\r\n      </div>\r\n      <!-- Pagination -->\r\n      <div v-if=\"meta.totalPages > 1\" class=\"flex items-center justify-center mt-3\">\r\n        <button :disabled=\"meta.currentPage === 1\" @click=\"paginate('prev')\" class=\"btn btn-default mr-2\">\r\n          <icon name=\"chevron-left\"></icon>\r\n        </button>\r\n        <span class=\"mr-2\">{{ `${meta.currentPage} of ${meta.totalPages}` }}</span>\r\n        <button :disabled=\"meta.currentPage === meta.totalPages\" @click=\"paginate('next')\" class=\"btn btn-default\">\r\n          <icon name=\"chevron-right\"></icon>\r\n        </button>\r\n      </div>\r\n    </template>\r\n  </centered-layout>\r\n</template>\r\n\r\n<script>\r\nimport CenteredLayout from '@/components/layouts/CenteredLayout'\r\nimport ProductSkeleton from '@/components/ProductSkeleton'\r\nimport Icon from '@/components/Icon'\r\nimport { computed, inject, onBeforeMount, reactive, toRefs, watch } from 'vue'\r\nimport { useStore } from 'vuex'\r\nimport {\r\n  FETCH_RATINGS,\r\n  FETCH_SHOP_DATA,\r\n  FETCH_SHOPS_LIST,\r\n  SET_PRODUCTS_FILTERS,\r\n  SET_SHOP_DATA,\r\n  SET_SHOP_ID\r\n} from '@/store/keys'\r\nimport { useRoute, useRouter } from 'vue-router'\r\nimport * as _ from 'lodash'\r\nimport compositionUtils from '@/compositionUtils'\r\nimport StarRating from 'vue-star-rating'\r\n\r\nexport default {\r\n  name: 'Shop',\r\n  components: {\r\n    CenteredLayout,\r\n    ProductSkeleton,\r\n    StarRating,\r\n    Icon\r\n  },\r\n  setup () {\r\n    const toast = inject('toast')\r\n    // Store\r\n    const store = useStore()\r\n    const route = useRoute()\r\n    const router = useRouter()\r\n\r\n    const {\r\n      saveNotification,\r\n      formatPrice,\r\n      copyToClipboard\r\n    } = compositionUtils()\r\n    // State\r\n    const state = reactive({\r\n      shop: null,\r\n      category: '',\r\n      keyword: '',\r\n      selectedShop: null,\r\n      meta: {\r\n        currentPage: 1,\r\n        totalPages: 0,\r\n        limit: 12,\r\n        offset: 0\r\n      },\r\n      ratings: [],\r\n      isProcessing: false\r\n    })\r\n    // Computed\r\n    const shopId = computed(() => store.state.shopId)\r\n    const shopsList = computed(() => store.state.shopsList)\r\n    const productsFilters = computed(() => store.state.productsFilters)\r\n    const altCoins = computed(() => store.state.altCoins)\r\n    const currency = computed(() => {\r\n      let currency = 'EUR'\r\n      if (state.shop) {\r\n        currency = state.selectedShop.PayoutCurrencyShortName\r\n        const altCoin = _.find(altCoins.value, { ShortName: currency })\r\n        if (altCoin) {\r\n          currency = altCoin.LongName\r\n        }\r\n      }\r\n      return currency\r\n    })\r\n    const productCategories = computed(() => {\r\n      let categories = _.cloneDeep(state.shop.categories)\r\n      if(categories != 'nothing found' && categories.length > 0){\r\n        categories = categories.filter((value, index, self) =>\r\n          index === self.findIndex((t) => (\r\n            t.id === value.id\r\n          ))\r\n        )\r\n      }\r\n      if (state.shop.products.length > 0 && categories != 'nothing found') {\r\n        return categories.filter(category => {\r\n          return _.findIndex(state.shop.products, { categoryID: category.id }) !== -1\r\n        })\r\n      } else {\r\n        return []\r\n      }\r\n    })\r\n    const filteredProducts = computed(() => {\r\n      if (state.shop) {\r\n        return state.shop.products.filter(product => {\r\n          const keyword = state.keyword.trim().toLowerCase()\r\n          if (state.category && keyword) {\r\n            return (product.categoryID === state.category &&\r\n              (_.includes(product.itemName.toLowerCase(), keyword) ||\r\n                _.includes(product.sku.toLowerCase(), keyword) ||\r\n                _.includes(product.description.toLowerCase(), keyword)) && Number(product.stock) > 0\r\n            )\r\n          } else if (state.category) {\r\n            return product.categoryID === state.category && Number(product.stock) > 0\r\n          } else if (keyword) {\r\n            return (_.includes(product.itemName.toLowerCase(), keyword) ||\r\n                _.includes(product.sku.toLowerCase(), keyword) ||\r\n                _.includes(product.description.toLowerCase(), keyword)) &&\r\n              Number(product.stock) > 0\r\n          } else {\r\n            return Number(product.stock) > 0\r\n          }\r\n        })\r\n      }\r\n      return []\r\n    })\r\n    const paginatedProducts = computed(() => {\r\n      if (filteredProducts.value.length > 0) {\r\n        return filteredProducts.value.slice(state.meta.offset, state.meta.currentPage * state.meta.limit)\r\n      }\r\n      return filteredProducts.value\r\n    })\r\n    const selectedCategory = computed(() => {\r\n      if (state.category) {\r\n        return _.find(state.shop.categories, { id: state.category })\r\n      }\r\n      return null\r\n    })\r\n\r\n    // Watch\r\n    watch(() => shopId.value,\r\n      (newVal, oldVal) => {\r\n        if (newVal) {\r\n          state.selectedShop = _.find(shopsList.value, { ID: newVal.toString() })\r\n        }\r\n      })\r\n    watch(() => state.keyword,\r\n      (newVal, oldVal) => {\r\n        state.meta = {\r\n          ...state.meta,\r\n          currentPage: 1,\r\n          totalPages: filteredProducts.value ? Math.ceil(filteredProducts.value.length / state.meta.limit) : 0,\r\n          offset: 0\r\n        }\r\n        updateProductsFilters({\r\n          currentPage: 1,\r\n          keyword: newVal,\r\n          category: state.category\r\n        })\r\n      })\r\n    watch(() => state.category,\r\n      (newVal, oldVal) => {\r\n        state.meta = {\r\n          ...state.meta,\r\n          currentPage: 1,\r\n          totalPages: filteredProducts.value ? Math.ceil(filteredProducts.value.length / state.meta.limit) : 0,\r\n          offset: 0\r\n        }\r\n        updateProductsFilters({\r\n          currentPage: 1,\r\n          keyword: state.keyword,\r\n          category: newVal\r\n        })\r\n      })\r\n\r\n    // Methods\r\n    const isAvatar = (img) => {\r\n      return _.startsWith(img, 'https://cointopay.com/M_Images')\r\n    }\r\n    const fetchProducts = () => {\r\n      state.isProcessing = true\r\n      store.dispatch(FETCH_SHOP_DATA, {\r\n        shopId: shopId.value\r\n      }).then(response => {\r\n        state.isProcessing = false\r\n        if (response.products === 'nothing found') {\r\n          toast.warning('Store for this merchant is not enabled')\r\n          saveNotification('Store for this merchant is not enabled')\r\n          router.push({ name: 'shop' })\r\n        } else {\r\n          state.shop = response\r\n          const totalPages = state.shop.products ? Math.ceil(state.shop.products.length / state.meta.limit) : 0\r\n          // Check if page parameter is present\r\n          if (Object.keys(route.query).length > 0) {\r\n            if (typeof route.query.page !== 'undefined') {\r\n              const page = route.query.page\r\n              if (page > 0 && page <= totalPages) {\r\n                updateProductsFilters({\r\n                  currentPage: page,\r\n                  keyword: state.keyword,\r\n                  category: state.category\r\n                })\r\n              }\r\n            }\r\n          }\r\n          state.meta = {\r\n            currentPage: productsFilters.value ? productsFilters.value.currentPage : 1,\r\n            totalPages: state.shop.products ? totalPages : 0,\r\n            limit: 12,\r\n            offset: productsFilters.value ? (productsFilters.value.currentPage - 1) * state.meta.limit : 0\r\n          }\r\n        }\r\n      }).catch(error => {\r\n        state.isProcessing = false\r\n        console.log(error)\r\n      })\r\n    }\r\n    const fetchRatings = (shopId) => {\r\n      store.dispatch(FETCH_RATINGS, shopId).then(ratings => {\r\n        state.ratings = ratings\r\n      })\r\n    }\r\n    const resetShopItems = () => {\r\n      store.commit(SET_SHOP_DATA, {\r\n        categories: [],\r\n        products: []\r\n      })\r\n    }\r\n    const updateProductsFilters = (filters = null) => {\r\n      if (!filters) {\r\n        filters = {\r\n          currentPage: state.meta.currentPage,\r\n          keyword: state.keyword,\r\n          category: state.category\r\n        }\r\n      }\r\n      store.commit(SET_PRODUCTS_FILTERS, filters)\r\n    }\r\n    const getProductRatings = (sku) => {\r\n      let ratings = 0\r\n      let counter = 0\r\n      state.ratings.map(rating => {\r\n        if (rating.SKU === sku) {\r\n          counter += 1\r\n          ratings = Number(ratings) + Number(rating.ReviewStars)\r\n        }\r\n      })\r\n      return (counter > 0) ? ratings / counter : 0\r\n    }\r\n    const paginate = (type) => {\r\n      let page = state.meta.currentPage\r\n      if (type === 'next') {\r\n        page = state.meta.currentPage < state.meta.totalPages ? state.meta.currentPage + 1 : state.meta.totalPages\r\n      } else {\r\n        page = state.meta.currentPage > 0 ? state.meta.currentPage - 1 : state.meta.totalPages\r\n      }\r\n      state.meta = {\r\n        ...state.meta,\r\n        currentPage: page,\r\n        offset: (page - 1) * state.meta.limit\r\n      }\r\n      router.push({\r\n        name: 'shop-detail',\r\n        params: { id: shopId.value },\r\n        query: { page: page }\r\n      })\r\n      updateProductsFilters()\r\n      copyToClipboard(window.location.href, false)\r\n    }\r\n\r\n    onBeforeMount(() => {\r\n      state.isProcessing = true\r\n      if (shopId.value) {\r\n        state.selectedShop = _.find(shopsList.value, { ID: shopId.value })\r\n      }\r\n      store.dispatch(FETCH_SHOPS_LIST).then(() => {\r\n        if (Object.keys(route.params).length > 0) {\r\n          if (typeof route.params.id !== 'undefined') {\r\n            store.commit(SET_SHOP_ID, route.params.id)\r\n            updateProductsFilters()\r\n          } else {\r\n            store.commit(SET_SHOP_ID, null)\r\n          }\r\n          if (route.params.categoryId) {\r\n            state.category = route.params.categoryId\r\n          }\r\n\r\n          setTimeout(() => {\r\n            if (shopId.value && state.selectedShop) {\r\n              fetchProducts()\r\n              fetchRatings(shopId.value)\r\n            } else {\r\n              toast.warning('Store for this merchant is not enabled')\r\n              store.commit(SET_SHOP_ID, null)\r\n              router.push({ name: 'shop' })\r\n            }\r\n          }, 50)\r\n        } else {\r\n          updateProductsFilters({\r\n            currentPage: 1,\r\n            keyword: '',\r\n            category: ''\r\n          })\r\n          store.commit(SET_SHOP_ID, null)\r\n          resetShopItems()\r\n        }\r\n      }).catch((error) => {\r\n        console.log(error)\r\n      })\r\n\r\n    \r\n    })\r\n\r\n    return {\r\n      ...toRefs(state),\r\n      currency,\r\n      shopId,\r\n      isAvatar,\r\n      selectedCategory,\r\n      productCategories,\r\n      paginatedProducts,\r\n      formatPrice,\r\n      getProductRatings,\r\n      paginate\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>\r\n","import { render } from \"./Shop.vue?vue&type=template&id=09ca523c\"\nimport script from \"./Shop.vue?vue&type=script&lang=js\"\nexport * from \"./Shop.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"C:\\\\Users\\\\zeesh\\\\OneDrive\\\\Desktop\\\\Cointopay\\\\cointopay.com.frontend.vuejs3.paymentfocus\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<template>\r\n  <div class=\"grid grid-cols-4 gap-2 xl:gap-3\">\r\n    <div v-for=\"count in counter\" :key=\"count\"\r\n      class=\"animate-pulse h-72 shadow bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-900 rounded col-span-4 md:col-span-2 lg:col-span-1 p-4\">\r\n      <div class=\"bg-gray-200 dark:bg-gray-500 rounded w-32 h-32 mx-auto\"></div>\r\n      <div class=\"mt-3 h-2 bg-gray-200 dark:bg-gray-500 rounded\"></div>\r\n      <div class=\"mt-3 h-2 bg-gray-200 dark:bg-gray-500 rounded w-2/5 mx-auto\"></div>\r\n      <div class=\"flex items-center justify-center mt-3\">\r\n        <div class=\"w-8 h-8 bg-gray-200 dark:bg-gray-500 rounded mr-3\"></div>\r\n        <div class=\"w-8 h-8 bg-gray-200 dark:bg-gray-500 rounded mr-3\"></div>\r\n        <div class=\"w-8 h-8 bg-gray-200 dark:bg-gray-500 rounded mr-3\"></div>\r\n        <div class=\"w-8 h-8 bg-gray-200 dark:bg-gray-500 rounded mr-3\"></div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: 'Product',\r\n  props: ['counter']\r\n}\r\n</script>\r\n\r\n<style scoped></style>\r\n","import { render } from \"./ProductSkeleton.vue?vue&type=template&id=42d5307c\"\nimport script from \"./ProductSkeleton.vue?vue&type=script&lang=js\"\nexport * from \"./ProductSkeleton.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"C:\\\\Users\\\\zeesh\\\\OneDrive\\\\Desktop\\\\Cointopay\\\\cointopay.com.frontend.vuejs3.paymentfocus\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"sourceRoot":""}