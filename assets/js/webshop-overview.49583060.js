"use strict";(self["webpackChunkcointopay"]=self["webpackChunkcointopay"]||[]).push([[170],{9069:function(e,t,a){a.d(t,{Z:function(){return d}});var r=a(821);const o=(0,r.createStaticVNode)('<div class="p-2 w-full mx-auto"><div class="animate-pulse"><div class="flex-1 space-y-3 py-1"><div class="h-2 bg-gray-200 dark:bg-gray-500 rounded"></div><div class="space-y-3"><div class="grid grid-cols-3 gap-4"><div class="h-2 bg-gray-200 dark:bg-gray-500 rounded col-span-2"></div><div class="h-2 bg-gray-200 dark:bg-gray-500 rounded col-span-1"></div></div><div class="h-2 bg-gray-200 dark:bg-gray-500 rounded"></div></div></div></div></div><div class="p-2 w-full mx-auto"><div class="animate-pulse"><div class="flex-1 space-y-3 py-1"><div class="h-2 bg-gray-200 dark:bg-gray-500 rounded"></div><div class="space-y-3"><div class="grid grid-cols-3 gap-4"><div class="h-2 bg-gray-200 dark:bg-gray-500 rounded col-span-1"></div><div class="h-2 bg-gray-200 dark:bg-gray-500 rounded col-span-2"></div></div><div class="h-2 bg-gray-200 dark:bg-gray-500 rounded"></div></div></div></div></div>',2);function n(e,t,a,r,n,l){return o}var l={name:"PulseSkeleton"},c=a(3744);const s=(0,c.Z)(l,[["render",n]]);var d=s},7199:function(e,t,a){a.d(t,{Z:function(){return v}});var r=a(821);const o={key:0,"aria-label":"pagination",class:"mt-3"},n={class:"inline-flex -space-x-px text-sm md:text-base"},l=(0,r.createElementVNode)("span",{"aria-hidden":"true"},"«",-1),c=[l],s={key:0,class:"px-1 py-2 md:px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:text-blue-500 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:text-blue-500",href:"javascript:void(0)"},d=["onClick"],i={key:0,class:"sr-only"},m=(0,r.createElementVNode)("span",{"aria-hidden":"true"},"»",-1),u=[m];function p(e,t,a,l,m,p){return a.meta.totalPages>1?((0,r.openBlock)(),(0,r.createElementBlock)("nav",o,[(0,r.createElementVNode)("ul",n,[(0,r.createElementVNode)("li",null,[(0,r.createElementVNode)("a",{class:(0,r.normalizeClass)([{"cursor-not-allowed bg-gray-200 dark:bg-gray-900 dark:hover:text-gray-400":!e.isPrev},"px-2 py-2 md:px-3 ml-0 leading-tight text-gray-500 dark:text-gray-400 bg-white rounded-l border border-gray-300 hover:text-blue-500 dark:bg-gray-800 dark:border-gray-700 dark:hover:text-blue-500"]),href:"javascript:void(0)",onClick:t[0]||(t[0]=e=>l.prev())},c,2)]),((0,r.openBlock)(!0),(0,r.createElementBlock)(r.Fragment,null,(0,r.renderList)(l.pageRange,((t,a)=>((0,r.openBlock)(),(0,r.createElementBlock)("li",{key:a},["..."===t?((0,r.openBlock)(),(0,r.createElementBlock)("a",s,(0,r.toDisplayString)(t),1)):((0,r.openBlock)(),(0,r.createElementBlock)("a",{key:1,class:(0,r.normalizeClass)(`px-2 py-2 md:px-3 leading-tight bg-white border border-gray-300 dark:bg-gray-800 dark:border-gray-700 ${t===e.currentPage?"text-blue-500 font-semibold":"text-gray-500 dark:text-gray-400"} hover:text-blue-500 dark:hover:text-blue-500`),href:"javascript:void(0)",onClick:e=>l.updatePage(t)},[(0,r.createTextVNode)((0,r.toDisplayString)(t)+" ",1),t===e.currentPage?((0,r.openBlock)(),(0,r.createElementBlock)("span",i,"(current)")):(0,r.createCommentVNode)("",!0)],10,d))])))),128)),(0,r.createElementVNode)("li",null,[(0,r.createElementVNode)("a",{class:(0,r.normalizeClass)([{"cursor-not-allowed bg-gray-200 dark:bg-gray-900 dark:hover:bg-text-400":!e.isNext},"px-2 py-2 md:px-3 leading-tight text-gray-500 bg-white rounded-r border border-gray-300 hover:text-blue-500 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:text-blue-500"]),href:"javascript:void(0)",onClick:t[1]||(t[1]=e=>l.next())},u,2)])])])):(0,r.createCommentVNode)("",!0)}var g={name:"Pagination",props:["meta"],emits:["page"],setup(e,{emit:t}){const a=(0,r.reactive)({isPrev:!1,isNext:!1,pagesLimit:5,currentPage:e.meta.currentPage,delta:3}),o=(0,r.computed)((()=>{const t=e.meta.currentPage,r=e.meta.totalPages,o=t-a.delta,n=t+a.delta+1,l=[],c=[];let s;for(let e=1;e<=r;e++)(1===e||e===r||e>=o&&e<n)&&l.push(e);return l.forEach((function(e){s&&(e-s===2?c.push(s+1):e-s!==1&&c.push("...")),c.push(e),s=e})),c})),n=e=>{e!==a.currentPage&&(a.currentPage=e,s(),t("page",a.currentPage))},l=()=>{a.currentPage>1?a.currentPage--:a.currentPage=1,s(),t("page",a.currentPage)},c=()=>{a.currentPage<e.meta.totalPages?a.currentPage++:a.currentPage=e.meta.totalPages,s(),t("page",a.currentPage)},s=()=>{a.isPrev=a.currentPage>1,a.isNext=a.currentPage<e.meta.totalPages},d=()=>{a.delta=3,/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&(a.delta=1)};return(0,r.onBeforeMount)((()=>{s(),window.addEventListener("resize",d)})),(0,r.onBeforeUnmount)((()=>{window.removeEventListener("resize",d)})),{...(0,r.toRefs)(a),pageRange:o,prev:l,next:c,updatePage:n}}},h=a(3744);const y=(0,h.Z)(g,[["render",p]]);var v=y},784:function(e,t,a){a.d(t,{Z:function(){return u}});var r=a(821);const o={class:"p-4"},n={class:"max-w-7xl 3xl:max-w-8xl mx-auto"},l={class:"flex flex-col md:flex-row space-x-0 md:space-x-4"},c={class:"w-full mb-4 md:mb-0 bg-white dark:bg-gray-800 rounded shadow p-4",style:{"min-height":"calc(100vh - 351px)"}};function s(e,t,a,s,d,i){return(0,r.openBlock)(),(0,r.createElementBlock)("div",o,[(0,r.createElementVNode)("div",n,[(0,r.createElementVNode)("div",l,[(0,r.createElementVNode)("div",c,[(0,r.renderSlot)(e.$slots,"default")])])])])}var d={name:"CenteredLayout"},i=a(3744);const m=(0,i.Z)(d,[["render",s]]);var u=m},7255:function(e,t,a){a.r(t),a.d(t,{default:function(){return Y}});var r=a(821);const o={class:"flex items-center justify-between flex-col md:flex-row mb-3"},n=(0,r.createTextVNode)("Export to CSV"),l={class:"flex items-center space-x-2 flex-col md:flex-row"},c=(0,r.createElementVNode)("label",{class:"whitespace-nowrap mb-1 md:mb-0"},"From Date",-1),s=(0,r.createElementVNode)("label",{class:"whitespace-nowrap mb-1 md:mb-0"},"To Date",-1),d={class:"relative w-full md:w-auto"},i=(0,r.createElementVNode)("hr",{class:"border-gray-300 dark:border-gray-600"},null,-1),m={class:"w-full scrollbar scrollbar-thin scrollbar-thumb-gray-400 scrollbar-track-gray-200 dark:scrollbar-track-gray-900 dark:scrollbar-thumb-gray-600"},u={class:"table-sm mb-2"},p=(0,r.createElementVNode)("thead",null,[(0,r.createElementVNode)("tr",null,[(0,r.createElementVNode)("th",null,"ID"),(0,r.createElementVNode)("th",{style:{"min-width":"180px"}},"Direction"),(0,r.createElementVNode)("th",{class:"whitespace-nowrap"},"Created On"),(0,r.createElementVNode)("th",{class:"whitespace-nowrap"},"Confirmed On"),(0,r.createElementVNode)("th",{style:{"min-width":"70px"}},"Time"),(0,r.createElementVNode)("th",{class:"whitespace-nowrap"},"Customer Reference Nr"),(0,r.createElementVNode)("th",null,"Original"),(0,r.createElementVNode)("th",null,"Received"),(0,r.createElementVNode)("th",{class:"whitespace-nowrap"},"Fee Paid"),(0,r.createElementVNode)("th",{style:{"min-width":"70px"}},"Input"),(0,r.createElementVNode)("th",{class:"whitespace-nowrap"},"Crypto Amount"),(0,r.createElementVNode)("th",{class:"whitespace-nowrap"},"Crypto Name"),(0,r.createElementVNode)("th",{class:"whitespace-nowrap"},"Coin Address Used")])],-1),g={class:"whitespace-nowrap"},h={class:"whitespace-nowrap"},y={class:"break-all whitespace-normal",style:{"max-width":"600px"}},v={class:"flex items-center"},b=["onClick"],f={class:"flex items-center"},k=["onClick"],C={class:"whitespace-nowrap"},N={class:"break-all"},w={key:0},x=(0,r.createElementVNode)("td",{colspan:"13"},"No record found!",-1),V=[x];function E(e,t,a,x,E,D){const P=(0,r.resolveComponent)("j-button"),B=(0,r.resolveComponent)("litepie-datepicker"),I=(0,r.resolveComponent)("icon"),A=(0,r.resolveComponent)("pagination"),S=(0,r.resolveComponent)("pulse-skeleton"),F=(0,r.resolveComponent)("centered-layout");return(0,r.openBlock)(),(0,r.createBlock)(F,null,{default:(0,r.withCtx)((()=>[e.isProcessing?(0,r.createCommentVNode)("",!0):((0,r.openBlock)(),(0,r.createElementBlock)(r.Fragment,{key:0},[(0,r.createElementVNode)("div",o,[(0,r.createVNode)(P,{onClick:x.exportToCSV,class:"mb-3 md:mb-0"},{default:(0,r.withCtx)((()=>[n])),_:1},8,["onClick"]),(0,r.createElementVNode)("div",l,[c,(0,r.createVNode)(B,{"as-single":"",modelValue:e.searchForm.fromDate,"onUpdate:modelValue":t[0]||(t[0]=t=>e.searchForm.fromDate=t),class:"mb-3 md:mb-0",formatter:{date:"YYYY-MM-DD",month:"MMM"}},null,8,["modelValue"]),s,(0,r.createVNode)(B,{"as-single":"",modelValue:e.searchForm.toDate,"onUpdate:modelValue":t[1]||(t[1]=t=>e.searchForm.toDate=t),class:"mb-3 md:mb-0",formatter:{date:"YYYY-MM-DD",month:"MMM"}},null,8,["modelValue"]),(0,r.createElementVNode)("div",d,[(0,r.createVNode)(I,{classes:"absolute w-5 h-5 top-3 left-3 dark:text-gray-300",name:"search"}),(0,r.withDirectives)((0,r.createElementVNode)("input",{"onUpdate:modelValue":t[2]||(t[2]=t=>e.keyword=t),"aria-label":"Search...",class:"form-input w-full px-10",type:"text",style:{"min-width":"220px"}},null,512),[[r.vModelText,e.keyword]]),""!==e.keyword?((0,r.openBlock)(),(0,r.createElementBlock)("span",{key:0,class:"absolute top-3 right-3 dark:text-gray-400 cursor-pointer",onClick:t[3]||(t[3]=t=>e.keyword="")},[(0,r.createVNode)(I,{classes:"w-5 h-5",name:"close"})])):(0,r.createCommentVNode)("",!0)])])]),i,(0,r.createElementVNode)("div",m,[(0,r.createElementVNode)("table",u,[p,(0,r.createElementVNode)("tbody",null,[((0,r.openBlock)(!0),(0,r.createElementBlock)(r.Fragment,null,(0,r.renderList)(x.paginatedReports,((e,t)=>((0,r.openBlock)(),(0,r.createElementBlock)("tr",{key:t},[(0,r.createElementVNode)("td",null,(0,r.toDisplayString)(e.ID),1),(0,r.createElementVNode)("td",null,(0,r.toDisplayString)(e.Incoming),1),(0,r.createElementVNode)("td",g,(0,r.toDisplayString)(x.formatDT(e.CreatedOn)),1),(0,r.createElementVNode)("td",h,(0,r.toDisplayString)(x.formatDT(e.ConfirmedOn)),1),(0,r.createElementVNode)("td",null,(0,r.toDisplayString)(e.ConfirmationTime),1),(0,r.createElementVNode)("td",y,(0,r.toDisplayString)(e.CustomerReferenceNr),1),(0,r.createElementVNode)("td",null,(0,r.toDisplayString)(e.OriginalAmount),1),(0,r.createElementVNode)("td",null,[(0,r.createElementVNode)("span",v,[(0,r.createTextVNode)((0,r.toDisplayString)(e.AmountReceived)+" ",1),(0,r.createElementVNode)("span",{class:"ml-3 cursor-pointer hover:text-blue-500",onClick:t=>x.toConverter(e,"ic")},[(0,r.createVNode)(I,{name:"clipboard",classes:"w-5 h-5"})],8,b)])]),(0,r.createElementVNode)("td",null,(0,r.toDisplayString)(e.FeePaidByCustomer),1),(0,r.createElementVNode)("td",null,(0,r.toDisplayString)(e.InputCurrency),1),(0,r.createElementVNode)("td",null,[(0,r.createElementVNode)("span",f,[(0,r.createTextVNode)((0,r.toDisplayString)(e.CryptoCurrencyAmount)+" ",1),(0,r.createElementVNode)("span",{class:"ml-3 cursor-pointer hover:text-blue-500",onClick:t=>x.toConverter(e,"c")},[(0,r.createVNode)(I,{name:"clipboard",classes:"w-5 h-5"})],8,k)])]),(0,r.createElementVNode)("td",C,(0,r.toDisplayString)(e.Name),1),(0,r.createElementVNode)("td",N,(0,r.toDisplayString)(e.CoinAddressUsed),1)])))),128)),0===x.paginatedReports.length?((0,r.openBlock)(),(0,r.createElementBlock)("tr",w,V)):(0,r.createCommentVNode)("",!0)])])]),x.filteredReports.length>0?((0,r.openBlock)(),(0,r.createBlock)(A,{key:0,meta:e.meta,onPage:x.updatePage},null,8,["meta","onPage"])):(0,r.createCommentVNode)("",!0)],64)),e.isProcessing?((0,r.openBlock)(),(0,r.createElementBlock)(r.Fragment,{key:1},[(0,r.createVNode)(S),(0,r.createVNode)(S)],64)):(0,r.createCommentVNode)("",!0)])),_:1})}var D=a(784),P=a(9069),B=a(7983),I=a(3164),A=a(7199),S=a(7377),F=a(4729),R=a(8637),T=a(6486),M=a(9783),O=a(381),L={name:"WebshopOverview",components:{CenteredLayout:D.Z,PulseSkeleton:P.Z,Icon:B.Z,JButton:I.Z,Pagination:A.Z,LitepieDatepicker:S.Z},setup(){const e=(0,r.inject)("http"),t=(0,r.inject)("toast"),a=(0,R.oR)(),{formatDT:o,copyToClipboard:n}=(0,F.Z)(),l=(0,r.reactive)({reports:[],isProcessing:!1,keyword:"",searchForm:{fromDate:"",toDate:""},meta:{currentPage:1,totalPages:0,limit:25,offset:0}}),c=(0,r.computed)((()=>a.state.user)),s=(0,r.computed)((()=>a.state.converter)),d=(0,r.computed)((()=>l.reports.filter((e=>{let t=l.keyword?l.keyword.toString().trim():"";return!t||(t=t.toLowerCase(),T.includes(e.ID.toLowerCase(),t)||T.includes(e.CustomerReferenceNr.toLowerCase(),t)||T.includes(e.InputCurrency&&e.InputCurrency.toLowerCase(),t)||T.includes(e.Incoming.toLowerCase(),t)||T.includes(e.Name.toLowerCase(),t)||T.includes(e.CreatedOn,t)||T.includes(e.ConfirmedOn,t)||T.includes(e.CoinAddressUsed.toLowerCase(),t))})))),i=(0,r.computed)((()=>d.value.length>0?[...d.value].slice(l.meta.offset,l.meta.offset+l.meta.limit):[...d.value])),m=(0,r.computed)((()=>a.state.allAltCoins));(0,r.watch)((()=>({...l.searchForm})),((e,a)=>{const r=l.searchForm.fromDate,o=l.searchForm.toDate;let n=!0;new Date(r).getTime()>(new Date).getTime()?(n=!1,l.searchForm.fromDate="",t.error("From date cannot be greater than today")):""!==r&&""!==o?new Date(r).getTime()>new Date(o).getTime()&&(n=!1,l.searchForm.fromDate="",t.error("From date should be less than to date")):""===l.searchForm.toDate&&(l.searchForm.toDate=O().format("YYYY-MM-DD")),!n||""===l.searchForm.fromDate&&""===l.searchForm.toDate||setTimeout((()=>{p(l.searchForm)}),50)})),(0,r.watch)((()=>l.keyword),((e,t)=>{l.meta={...l.meta,currentPage:1,totalPages:Math.ceil(d.value.length/l.meta.limit),offset:0}}));const u="https://app.cointopay.com",p=(t=null)=>{l.isProcessing=!0;const a={MerchantID:c.value.ID,APIKey:c.value.APIKey};null!==t&&(""!==t.fromDate&&Object.assign(a,{fromdate:t.fromDate}),""!==t.todate&&Object.assign(a,{todate:t.toDate})),e.get(`${u}/V2Processor?WebShopReport`,{params:a}).then((e=>{l.isProcessing=!1,l.reports=[],200===e.status&&Object.keys(e.data.data[0]).length>0&&(l.reports=e.data.data,l.meta={...l.meta,currentPage:1,totalPages:Math.ceil(l.reports.length/l.meta.limit),offset:0})})).catch((e=>{l.isProcessing=!1,console.log(e)}))},g=(e,t)=>{if("ic"===t){const t=T.find(m.value,{ShortName:e.InputCurrency}),r=T.find(m.value,{Name:e.Name.split(" ")[0]});if(t){const o=t.ID,n={...s.value,source:e.AmountReceived,sourceAltCoinId:o};r&&(n.targetAltCoinId=r.ID),a.commit(M.K9,n)}n(e.AmountReceived)}else{const t=T.find(m.value,{Name:e.Name.split(" ")[0]}),r=T.find(m.value,{ShortName:e.InputCurrency});if(t){const o=t.ID,n={...s.value,source:e.CryptoCurrencyAmount,sourceAltCoinId:o};r&&(n.targetAltCoinId=r.ID),a.commit(M.K9,n)}n(e.CryptoCurrencyAmount)}},h=e=>{l.meta={...l.meta,currentPage:e,offset:(e-1)*l.meta.limit}},y=()=>{const e=[["ID","Direction","CreatedOn","ConfirmedOn","ConfirmationTime","CustomerReferenceNr","OriginalAmount","AmountReceived","FeePaidByCustomer","InputCurrency","CryptoAmount","CryptoName","CoinAddressUsed"]];l.reports.length>0&&l.reports.forEach((t=>{e.push([t.ID,t.Incoming,o(t.CreatedOn),o(t.ConfirmedOn),t.ConfirmationTime,t.CustomerReferenceNr,t.OriginalAmount,t.AmountReceived,t.FeePaidByCustomer,t.InputCurrency,t.CryptoCurrencyAmount,t.Name,t.CoinAddressUsed])}));const t=e.map((e=>e.join(";"))).join("\n"),a=encodeURIComponent(t),r=document.createElement("a");r.setAttribute("href","data:text/csv;charset=utf-8,"+a),r.setAttribute("download","webshop-overview.csv"),document.body.appendChild(r),r.click()};return(0,r.onBeforeMount)((()=>{p()})),{...(0,r.toRefs)(l),filteredReports:d,paginatedReports:i,formatDT:o,toConverter:g,updatePage:h,exportToCSV:y}}},Z=a(3744);const j=(0,Z.Z)(L,[["render",E]]);var Y=j}}]);
//# sourceMappingURL=webshop-overview.49583060.js.map