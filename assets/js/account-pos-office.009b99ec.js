"use strict";(self["webpackChunkcointopay"]=self["webpackChunkcointopay"]||[]).push([[345],{7199:function(e,t,o){o.d(t,{Z:function(){return v}});var a=o(821);const n={key:0,"aria-label":"pagination",class:"mt-3"},r={class:"inline-flex -space-x-px text-sm md:text-base"},s=(0,a.createElementVNode)("span",{"aria-hidden":"true"},"«",-1),l=[s],c={key:0,class:"px-1 py-2 md:px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:text-blue-500 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:text-blue-500",href:"javascript:void(0)"},i=["onClick"],d={key:0,class:"sr-only"},p=(0,a.createElementVNode)("span",{"aria-hidden":"true"},"»",-1),u=[p];function m(e,t,o,s,p,m){return o.meta.totalPages>1?((0,a.openBlock)(),(0,a.createElementBlock)("nav",n,[(0,a.createElementVNode)("ul",r,[(0,a.createElementVNode)("li",null,[(0,a.createElementVNode)("a",{class:(0,a.normalizeClass)([{"cursor-not-allowed bg-gray-200 dark:bg-gray-900 dark:hover:text-gray-400":!e.isPrev},"px-2 py-2 md:px-3 ml-0 leading-tight text-gray-500 dark:text-gray-400 bg-white rounded-l border border-gray-300 hover:text-blue-500 dark:bg-gray-800 dark:border-gray-700 dark:hover:text-blue-500"]),href:"javascript:void(0)",onClick:t[0]||(t[0]=e=>s.prev())},l,2)]),((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(s.pageRange,((t,o)=>((0,a.openBlock)(),(0,a.createElementBlock)("li",{key:o},["..."===t?((0,a.openBlock)(),(0,a.createElementBlock)("a",c,(0,a.toDisplayString)(t),1)):((0,a.openBlock)(),(0,a.createElementBlock)("a",{key:1,class:(0,a.normalizeClass)(`px-2 py-2 md:px-3 leading-tight bg-white border border-gray-300 dark:bg-gray-800 dark:border-gray-700 ${t===e.currentPage?"text-blue-500 font-semibold":"text-gray-500 dark:text-gray-400"} hover:text-blue-500 dark:hover:text-blue-500`),href:"javascript:void(0)",onClick:e=>s.updatePage(t)},[(0,a.createTextVNode)((0,a.toDisplayString)(t)+" ",1),t===e.currentPage?((0,a.openBlock)(),(0,a.createElementBlock)("span",d,"(current)")):(0,a.createCommentVNode)("",!0)],10,i))])))),128)),(0,a.createElementVNode)("li",null,[(0,a.createElementVNode)("a",{class:(0,a.normalizeClass)([{"cursor-not-allowed bg-gray-200 dark:bg-gray-900 dark:hover:bg-text-400":!e.isNext},"px-2 py-2 md:px-3 leading-tight text-gray-500 bg-white rounded-r border border-gray-300 hover:text-blue-500 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:text-blue-500"]),href:"javascript:void(0)",onClick:t[1]||(t[1]=e=>s.next())},u,2)])])])):(0,a.createCommentVNode)("",!0)}var g={name:"Pagination",props:["meta"],emits:["page"],setup(e,{emit:t}){const o=(0,a.reactive)({isPrev:!1,isNext:!1,pagesLimit:5,currentPage:e.meta.currentPage,delta:3}),n=(0,a.computed)((()=>{const t=e.meta.currentPage,a=e.meta.totalPages,n=t-o.delta,r=t+o.delta+1,s=[],l=[];let c;for(let e=1;e<=a;e++)(1===e||e===a||e>=n&&e<r)&&s.push(e);return s.forEach((function(e){c&&(e-c===2?l.push(c+1):e-c!==1&&l.push("...")),l.push(e),c=e})),l})),r=e=>{e!==o.currentPage&&(o.currentPage=e,c(),t("page",o.currentPage))},s=()=>{o.currentPage>1?o.currentPage--:o.currentPage=1,c(),t("page",o.currentPage)},l=()=>{o.currentPage<e.meta.totalPages?o.currentPage++:o.currentPage=e.meta.totalPages,c(),t("page",o.currentPage)},c=()=>{o.isPrev=o.currentPage>1,o.isNext=o.currentPage<e.meta.totalPages},i=()=>{o.delta=3,/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&(o.delta=1)};return(0,a.onBeforeMount)((()=>{c(),window.addEventListener("resize",i)})),(0,a.onBeforeUnmount)((()=>{window.removeEventListener("resize",i)})),{...(0,a.toRefs)(o),pageRange:n,prev:s,next:l,updatePage:r}}},h=o(3744);const y=(0,h.Z)(g,[["render",m]]);var v=y},823:function(e,t,o){o.r(t),o.d(t,{default:function(){return mt}});var a=o(821),n=o(459),r=o(7327);const s={class:"card"},l={class:"title"},c=(0,a.createElementVNode)("hr",{class:"border-gray-300 dark:border-gray-600"},null,-1),i={class:"body"},d={class:"text-center w-full md:w-4/5 3xl:w-3/5 mx-auto"},p=(0,a.createElementVNode)("a",{href:"https://cointopay.com/examplePOS_CSV.csv",target:"_blank",class:"text-blue-500 hover:underline"},"Example Import Data",-1),u={class:"flex items-center justify-center my-2"},m={class:"btn btn-success w-32 lbl-file",for:"importCSV"},g={key:0,class:"mr-3"},h={class:"mb-2"},y={class:"flex items-center"},v=["placeholder"],f={key:0,class:"mr-3"},b=(0,a.createElementVNode)("p",{class:"mt-2 text-left text-gray-500 text-sm"},"https://3sixteen.myshopify.com/products.json?limit=1000",-1),N={key:0,class:"card"},V={class:"title"},E=(0,a.createElementVNode)("hr",{class:"border-gray-300 dark:border-gray-600"},null,-1),k={class:"body"},x={class:"text-center"},C={class:"card"},w={class:"title"},P=(0,a.createElementVNode)("hr",{class:"border-gray-300 dark:border-gray-600"},null,-1),S={class:"body"},D={class:"row"},B={class:"col-md-12 text-center"},M={key:0,class:"w-full rounded shadow px-4 py-3 bg-yellow-500 mb-4 text-yellow-900 font-semibold"},I={key:1,class:"mt-3"},_=(0,a.createElementVNode)("h5",{class:"font-bold text-lg mb-3"},"Shop Link",-1),j={class:"flex items-center justify-center"},A={key:2,class:"mt-3"},T={class:"card"},Z={class:"title"},K=(0,a.createElementVNode)("hr",{class:"border-gray-300 dark:border-gray-600"},null,-1),R={class:"body"},O={class:"card"},U={class:"title"},L=(0,a.createElementVNode)("hr",{class:"border-gray-300 dark:border-gray-600"},null,-1),q={class:"body"},F=(0,a.createElementVNode)("div",{class:"card"},[(0,a.createElementVNode)("div",{class:"title"},"POS Apps"),(0,a.createElementVNode)("hr",{class:"border-gray-300 dark:border-gray-600"}),(0,a.createElementVNode)("div",{class:"body"},[(0,a.createElementVNode)("div",{class:"flex items-center justify-center"},[(0,a.createElementVNode)("a",{href:"https://play.google.com/store/apps/details?id=com.cointopay.pos",target:"_blank"},[(0,a.createElementVNode)("img",{alt:"Play store",src:n,class:"h-10"})]),(0,a.createElementVNode)("a",{href:"https://apps.apple.com/us/app/c-pos/id1459100341",target:"_blank"},[(0,a.createElementVNode)("img",{alt:"App store",src:r,class:"h-10 ml-2"})])])])],-1);function W(e,t,o,n,r,W){const J=(0,a.resolveComponent)("icon"),$=(0,a.resolveComponent)("j-button"),z=(0,a.resolveComponent)("router-link"),Y=(0,a.resolveComponent)("Coupons"),Q=(0,a.resolveComponent)("Shipping-methods"),H=(0,a.resolveComponent)("pos-layout"),G=(0,a.resolveDirective)("tippy");return(0,a.openBlock)(),(0,a.createBlock)(H,null,{content:(0,a.withCtx)((()=>[(0,a.createElementVNode)("div",s,[(0,a.createElementVNode)("div",l,[(0,a.createElementVNode)("h5",null,(0,a.toDisplayString)(n.translate("pos.office.product_catalog")),1)]),c,(0,a.createElementVNode)("div",i,[(0,a.createElementVNode)("div",d,[p,(0,a.createElementVNode)("div",u,[(0,a.createElementVNode)("input",{onChange:t[0]||(t[0]=e=>n.importFromCSV(e)),class:"hidden",id:"importCSV",type:"file"},null,32),(0,a.createElementVNode)("label",m,[e.isProcessing?((0,a.openBlock)(),(0,a.createElementBlock)("span",g,[(0,a.createVNode)(J,{name:"spinner",classes:"w-4 h-4 text-white"})])):(0,a.createCommentVNode)("",!0),(0,a.createElementVNode)("span",null,(0,a.toDisplayString)(n.translate("pos.office.import")),1)]),(0,a.createVNode)($,{onClick:t[1]||(t[1]=e=>n.exportToCSV()),buttonStyle:"success",size:"w-32",class:"ml-3"},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(n.translate("pos.office.export")),1)])),_:1})]),(0,a.createElementVNode)("p",h,(0,a.toDisplayString)(n.translate("pos.office.import_from_shopify")),1),(0,a.createElementVNode)("form",{onSubmit:t[3]||(t[3]=(0,a.withModifiers)((e=>n.importFromShopify()),["prevent"])),class:"flex-space-between"},[(0,a.createElementVNode)("div",y,[(0,a.withDirectives)((0,a.createElementVNode)("input",{placeholder:n.translate("pos.office.shopify_link"),"aria-label":"url",class:"form-input w-full",type:"url","onUpdate:modelValue":t[2]||(t[2]=t=>e.form.url=t)},null,8,v),[[a.vModelText,e.form.url]]),(0,a.createVNode)($,{disabled:e.isProcessing||!n.isValidShopifyURL(e.form.url),buttonStyle:"success",size:"w-32",class:"ml-3"},{default:(0,a.withCtx)((()=>[e.isProcessing?((0,a.openBlock)(),(0,a.createElementBlock)("span",f,[(0,a.createVNode)(J,{name:"spinner",classes:"w-4 h-4 text-white"})])):(0,a.createCommentVNode)("",!0),(0,a.createElementVNode)("span",null,(0,a.toDisplayString)(n.translate("pos.office.import")),1)])),_:1},8,["disabled"])])],32),b])])]),n.products.length>0?((0,a.openBlock)(),(0,a.createElementBlock)("div",N,[(0,a.createElementVNode)("div",V,[(0,a.createElementVNode)("h5",null,(0,a.toDisplayString)(n.translate("pos.delete_catalog")),1)]),E,(0,a.createElementVNode)("div",k,[(0,a.createElementVNode)("div",x,[(0,a.createVNode)($,{onClick:t[4]||(t[4]=e=>n.deleteAllProducts()),buttonStyle:"danger"},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(n.translate("pos.btn_delete_all_products")),1)])),_:1})])])])):(0,a.createCommentVNode)("",!0),(0,a.createElementVNode)("div",C,[(0,a.createElementVNode)("div",w,[(0,a.createElementVNode)("h5",null,(0,a.toDisplayString)(n.translate("pos.e_commerce")),1)]),P,(0,a.createElementVNode)("div",S,[(0,a.createElementVNode)("div",D,[(0,a.createElementVNode)("div",B,[n.showShippingWarning?((0,a.openBlock)(),(0,a.createElementBlock)("div",M,(0,a.toDisplayString)(n.translate("pos.shipping_warning_msg")),1)):(0,a.createCommentVNode)("",!0),(0,a.createVNode)($,{onClick:t[5]||(t[5]=t=>n.togglePOS(e.isPosEnabled?0:1)),buttonStyle:""+(e.isPosEnabled?"danger":"success"),class:"mr-2"},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(n.translate(""+(e.isPosEnabled?"pos.btn_disable":"pos.btn_enable"))),1)])),_:1},8,["buttonStyle"]),e.isPosEnabled?((0,a.openBlock)(),(0,a.createElementBlock)("div",I,[_,(0,a.createElementVNode)("div",j,[(0,a.createVNode)(z,{to:{name:"shop",params:{id:n.user.ID}},class:"mr-3",tag:"a"},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(e.siteUrl+"/shop/"+n.user.ID),1)])),_:1},8,["to"]),(0,a.withDirectives)(((0,a.openBlock)(),(0,a.createElementBlock)("button",null,[(0,a.createVNode)(J,{name:"question-mark",classes:"w-6 h-6 text-yellow-500"})])),[[G,{content:n.translate("pos.office.help")}]])])])):(0,a.createCommentVNode)("",!0),e.isPosEnabled?((0,a.openBlock)(),(0,a.createElementBlock)("div",A,[(0,a.withDirectives)((0,a.createElementVNode)("textarea",{class:"form-input w-full md:w-3/5",rows:"4",readonly:"","aria-label":"","onUpdate:modelValue":t[6]||(t[6]=e=>n.iframe=e)},null,512),[[a.vModelText,n.iframe]])])):(0,a.createCommentVNode)("",!0)])])])]),(0,a.createElementVNode)("div",T,[(0,a.createElementVNode)("div",Z,[(0,a.createElementVNode)("h5",null,(0,a.toDisplayString)(n.translate("pos.coupons.list_title")),1)]),K,(0,a.createElementVNode)("div",R,[(0,a.createVNode)(Y)])]),(0,a.createElementVNode)("div",O,[(0,a.createElementVNode)("div",U,[(0,a.createElementVNode)("h5",null,(0,a.toDisplayString)(n.translate("pos.shipping.title")),1)]),L,(0,a.createElementVNode)("div",q,[(0,a.createVNode)(Q)])]),F])),_:1})}var J=o(2630),$=o(3164),z=o(7983);const Y={class:"text-right mb-3"},Q={class:"w-full scrollbar scrollbar-thin scrollbar-thumb-gray-400 scrollbar-track-gray-200 dark:scrollbar-track-gray-900 dark:scrollbar-thumb-gray-600"},H={class:"table-sm"},G={class:"whitespace-nowrap"},X={class:"w-32"},ee=["onClick"],te=["onClick"],oe={key:0},ae={colspan:"3"};function ne(e,t,o,n,r,s){const l=(0,a.resolveComponent)("j-button"),c=(0,a.resolveComponent)("icon"),i=(0,a.resolveComponent)("save-coupon-modal");return(0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,null,[(0,a.createElementVNode)("div",Y,[(0,a.createVNode)(l,{onClick:t[0]||(t[0]=e=>n.launchSaveCouponModal())},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(n.translate("pos.coupons.btn_add")),1)])),_:1})]),(0,a.createElementVNode)("div",Q,[(0,a.createElementVNode)("table",H,[(0,a.createElementVNode)("thead",null,[(0,a.createElementVNode)("tr",null,[(0,a.createElementVNode)("th",G,(0,a.toDisplayString)(n.translate("pos.coupons.headings.coupon_code")),1),(0,a.createElementVNode)("th",null,(0,a.toDisplayString)(n.translate("pos.coupons.headings.discount")),1),(0,a.createElementVNode)("th",X,(0,a.toDisplayString)(n.translate("pos.coupons.headings.actions")),1)])]),(0,a.createElementVNode)("tbody",null,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(n.coupons,((e,t)=>((0,a.openBlock)(),(0,a.createElementBlock)("tr",{key:t},[(0,a.createElementVNode)("td",null,(0,a.toDisplayString)(n.formatCode(e.KeyData)),1),(0,a.createElementVNode)("td",null,(0,a.toDisplayString)(`${e.ValueData}%`),1),(0,a.createElementVNode)("td",null,[(0,a.createElementVNode)("button",{onClick:t=>n.launchSaveCouponModal(e),class:"hover:text-blue-500 mr-2"},[(0,a.createVNode)(c,{name:"edit"})],8,ee),(0,a.createElementVNode)("button",{onClick:t=>n.deleteCoupon(e),class:"hover:text-red-500",type:"button"},[(0,a.createVNode)(c,{name:"trash"})],8,te)])])))),128)),0===n.coupons.length?((0,a.openBlock)(),(0,a.createElementBlock)("tr",oe,[(0,a.createElementVNode)("td",ae,(0,a.toDisplayString)(n.translate("pos.coupons.no_data")),1)])):(0,a.createCommentVNode)("",!0)])])]),(0,a.createVNode)(i)],64)}const re={class:"flex items-center justify-between"},se={class:"mb-2"},le={class:"flex items-center justify-between mb-1"},ce={class:"text-red-700 dark:text-red-400 text-sm"},ie=["readonly"],de={class:"mb-2"},pe={class:"flex items-center justify-between mb-1"},ue={class:"text-red-700 dark:text-red-400 text-sm"},me={class:"mt-4 text-right"},ge={key:0,class:"mr-3"};function he(e,t,o,n,r,s){const l=(0,a.resolveComponent)("icon"),c=(0,a.resolveComponent)("j-button"),i=(0,a.resolveComponent)("modal");return(0,a.openBlock)(),(0,a.createBlock)(i,{maxWidth:e.maxWidth,show:e.show,onClose:t[4]||(t[4]=e=>n.closeModal())},{title:(0,a.withCtx)((()=>[(0,a.createElementVNode)("div",re,[(0,a.createElementVNode)("span",null,(0,a.toDisplayString)(n.translate("pos.coupons.title")),1),(0,a.createElementVNode)("span",{class:"text-gray-500 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-200 cursor-pointer",onClick:t[0]||(t[0]=e=>n.closeModal())},[(0,a.createVNode)(l,{name:"close"})])])])),content:(0,a.withCtx)((()=>[(0,a.createElementVNode)("form",{onSubmit:t[3]||(t[3]=(0,a.withModifiers)((e=>n.submit()),["prevent"]))},[(0,a.createElementVNode)("div",se,[(0,a.createElementVNode)("div",le,[(0,a.createElementVNode)("label",null,(0,a.toDisplayString)(n.translate("pos.coupons.coupon_code")),1),(0,a.createElementVNode)("div",ce,(0,a.toDisplayString)(n.showError(e.errorBag,"couponCode")),1)]),(0,a.withDirectives)((0,a.createElementVNode)("input",{class:"form-input w-full",readonly:e.coupon,type:"text","onUpdate:modelValue":t[1]||(t[1]=t=>e.form.couponCode=t)},null,8,ie),[[a.vModelText,e.form.couponCode]])]),(0,a.createElementVNode)("div",de,[(0,a.createElementVNode)("div",pe,[(0,a.createElementVNode)("label",null,(0,a.toDisplayString)(n.translate("pos.coupons.discount")+" (%)"),1),(0,a.createElementVNode)("div",ue,(0,a.toDisplayString)(n.showError(e.errorBag,"discount")),1)]),(0,a.withDirectives)((0,a.createElementVNode)("input",{class:"form-input w-full",type:"text","onUpdate:modelValue":t[2]||(t[2]=t=>e.form.discount=t)},null,512),[[a.vModelText,e.form.discount]])]),(0,a.createElementVNode)("div",me,[(0,a.createVNode)(c,{disabled:e.isProcessing},{default:(0,a.withCtx)((()=>[e.isProcessing?((0,a.openBlock)(),(0,a.createElementBlock)("div",ge,[(0,a.createVNode)(l,{name:"spinner",classes:"w-4 h-4 text-white"})])):(0,a.createCommentVNode)("",!0),(0,a.createElementVNode)("span",null,(0,a.toDisplayString)(n.translate("pos.coupons.btn_save")),1)])),_:1},8,["disabled"])])],32)])),_:1},8,["maxWidth","show"])}var ye=o(9099),ve=o(6232),fe=o(8637),be=o(6486),Ne=o(4729),Ve=o(9783),Ee={name:"SaveCouponModal",components:{Modal:ye.Z,Icon:z.Z,JButton:$.Z},setup(){const e=(0,a.inject)("translate"),t=(0,a.inject)("emitter"),o=(0,a.inject)("toast"),n=(0,a.inject)("http"),r=(0,fe.oR)(),{showError:s,validate:l}=(0,ve.Z)(),{saveNotification:c}=(0,Ne.Z)(),i=(0,a.reactive)({show:!1,maxWidth:"2xl",closeable:!0,coupon:null,form:{couponCode:"",discount:""},errorBag:{},rules:{couponCode:["required","regex:/^[a-zA-Z0-9]+$/"],discount:["required","between:1,60"]},messages:{couponCode:{required:"Coupon code is required",regex:"Only alphabets and numbers are allowed"},discount:{required:"Please enter a valid discount",between:"Discount should be a number between 1 and 60"}},isProcessing:!1}),d=(0,a.computed)((()=>r.state.user)),p=(0,a.computed)((()=>r.state.coupons));(0,a.watch)((()=>({...i.form})),((e,t)=>{Object.keys(i.errorBag).length>0&&(i.errorBag=l(e,i.rules,i.messages))}));const u="https://app.cointopay.com",m=()=>{i.show=!1},g=()=>{if(i.errorBag=l(i.form,i.rules,i.messages),0===Object.keys(i.errorBag).length){i.isProcessing=!0;const e=i.form;let t=!0,a=null;const s=`${d.value.ID}_coupon${e.couponCode}`;if(i.coupon?-1===be.findIndex(p.value,(e=>e.KeyData.toLowerCase()===s.toLowerCase()&&e.ID.toString()!==i.coupon.ID.toString()))?a={...i.coupon,KeyData:s,ValueData:e.discount}:(t=!1,i.isProcessing=!1,o.error("Coupon code already exists!"),c("Coupon code already exists!")):-1===be.findIndex(p.value,{KeyData:s})?a={KeyData:s,ValueData:e.discount}:(t=!1,i.isProcessing=!1,o.error("Coupon code already exists!"),c("Coupon code already exists!")),t){const e={POSDATA:"",Call:i.coupon?"UPDATE":"INSERT",KeyData:a.KeyData,ValueData:a.ValueData,MerchantID:d.value.ID,APIKey:d.value.APIKey,output:"json"};n.get(`${u}/MarketAPI`,{params:e}).then((e=>{if(i.isProcessing=!1,200===e.status){r.dispatch(Ve.MQ,{MerchantID:d.value.ID,APIKey:d.value.APIKey});const e=i.coupon?"Coupon updated successfully":"Coupon added successfully";o.success(e),c(e),m()}})).catch((e=>{i.isProcessing=!1,console.log(e)}))}}};return(0,a.onBeforeMount)((()=>{t.on("saveCouponModal",(e=>{i.coupon=e.coupon||null,i.form={couponCode:i.coupon?i.coupon.KeyData.split("coupon")[1]:"",discount:i.coupon?Number(i.coupon.ValueData):""},i.show=!0}))})),{translate:e,...(0,a.toRefs)(i),showError:s,closeModal:m,submit:g}}},ke=o(3744);const xe=(0,ke.Z)(Ee,[["render",he]]);var Ce=xe,we={name:"Coupons",components:{Icon:z.Z,JButton:$.Z,SaveCouponModal:Ce},setup(){const e=(0,a.inject)("translate"),t=(0,a.inject)("http"),o=(0,a.inject)("swal"),n=(0,a.inject)("toast"),r=(0,a.inject)("emitter"),s=(0,fe.oR)(),l=(0,a.computed)((()=>s.state.user)),c=(0,a.computed)((()=>s.state.coupons)),i="https://app.cointopay.com",d=e=>e.split("coupon")[1],p=e=>{o.fire({title:"Coupon",text:"Are you sure, want to delete this coupon?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"Yes",cancelButtonText:"No",focusCancel:!0,customClass:{container:"swal2-tailwind"}}).then((({value:o})=>{o&&!0===o&&t.get(`${i}/MarketAPI`,{params:{POSDATA:"",Call:"DELETE",KeyData:e.KeyData,MerchantID:l.value.ID,APIKey:l.value.APIKey,output:"json"}}).then((e=>{200===e.status&&(n.success("Coupon deleted successfully"),s.dispatch(Ve.MQ,{MerchantID:l.value.ID,APIKey:l.value.APIKey}))})).catch((e=>{console.log(e)}))}))},u=(e=null)=>{r.emit("saveCouponModal",{coupon:e})};return(0,a.onBeforeMount)((()=>{s.dispatch(Ve.MQ,{MerchantID:l.value.ID,APIKey:l.value.APIKey})})),{translate:e,coupons:c,formatCode:d,deleteCoupon:p,launchSaveCouponModal:u}}};const Pe=(0,ke.Z)(we,[["render",ne],["__scopeId","data-v-4c952beb"]]);var Se=Pe;const De={class:"text-right mb-3"},Be={class:"w-full scrollbar scrollbar-thin scrollbar-thumb-gray-400 scrollbar-track-gray-200 dark:scrollbar-track-gray-900 dark:scrollbar-thumb-gray-600"},Me={class:"table-sm"},Ie={class:"whitespace-nowrap"},_e={class:"whitespace-nowrap"},je={class:"whitespace-nowrap"},Ae={class:"w-32"},Te=["onClick"],Ze=["onClick"],Ke={key:0},Re={colspan:"4"};function Oe(e,t,o,n,r,s){const l=(0,a.resolveComponent)("j-button"),c=(0,a.resolveComponent)("icon"),i=(0,a.resolveComponent)("pagination"),d=(0,a.resolveComponent)("save-shipping-method-modal");return(0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,null,[(0,a.createElementVNode)("div",De,[(0,a.createVNode)(l,{onClick:t[0]||(t[0]=e=>n.launchSaveShippingMethodModal())},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(n.translate("pos.shipping.btn_add")),1)])),_:1})]),(0,a.createElementVNode)("div",Be,[(0,a.createElementVNode)("table",Me,[(0,a.createElementVNode)("thead",null,[(0,a.createElementVNode)("tr",null,[(0,a.createElementVNode)("th",Ie,(0,a.toDisplayString)(n.translate("pos.shipping.headings.country")),1),(0,a.createElementVNode)("th",_e,(0,a.toDisplayString)(n.translate("pos.shipping.headings.shipping_method")),1),(0,a.createElementVNode)("th",je,(0,a.toDisplayString)(n.translate("pos.shipping.headings.shipping_cost")),1),(0,a.createElementVNode)("th",Ae,(0,a.toDisplayString)(n.translate("pos.shipping.headings.actions")),1)])]),(0,a.createElementVNode)("tbody",null,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(n.paginatedShippingMethods,((e,t)=>((0,a.openBlock)(),(0,a.createElementBlock)("tr",{key:t},[(0,a.createElementVNode)("td",null,(0,a.toDisplayString)(e.countryName),1),(0,a.createElementVNode)("td",null,(0,a.toDisplayString)(e.shippingMethod),1),(0,a.createElementVNode)("td",null,(0,a.toDisplayString)(n.formatPrice(e.shippingCost,n.currency)),1),(0,a.createElementVNode)("td",null,[(0,a.createElementVNode)("button",{onClick:t=>n.launchSaveShippingMethodModal(e),class:"hover:text-blue-500 mr-2"},[(0,a.createVNode)(c,{name:"edit"})],8,Te),(0,a.createElementVNode)("button",{onClick:e=>n.deleteShippingMethod(t),class:"hover:text-red-500",type:"button"},[(0,a.createVNode)(c,{name:"trash"})],8,Ze)])])))),128)),0===n.shippingMethods.length?((0,a.openBlock)(),(0,a.createElementBlock)("tr",Ke,[(0,a.createElementVNode)("td",Re,(0,a.toDisplayString)(n.translate("pos.shipping.no_data")),1)])):(0,a.createCommentVNode)("",!0)])])]),n.shippingMethods.length>0?((0,a.openBlock)(),(0,a.createBlock)(i,{key:0,meta:e.meta,onPage:n.updatePage},null,8,["meta","onPage"])):(0,a.createCommentVNode)("",!0),(0,a.createVNode)(d)],64)}var Ue=o(7199);const Le={class:"flex items-center justify-between"},qe={class:"mb-2"},Fe={class:"flex items-center justify-between mb-1"},We={class:"text-red-700 dark:text-red-400 text-sm"},Je=["value"],$e={class:"mb-2"},ze={class:"flex items-center justify-between mb-1"},Ye={class:"text-red-700 dark:text-red-400 text-sm"},Qe={class:"mb-2"},He={class:"flex items-center justify-between mb-1"},Ge={class:"text-red-700 dark:text-red-400 text-sm"},Xe={class:"mt-4 text-right"},et={key:0,class:"mr-3"};function tt(e,t,o,n,r,s){const l=(0,a.resolveComponent)("icon"),c=(0,a.resolveComponent)("j-button"),i=(0,a.resolveComponent)("modal");return(0,a.openBlock)(),(0,a.createBlock)(i,{maxWidth:e.maxWidth,show:e.show,onClose:t[6]||(t[6]=e=>n.closeModal())},{title:(0,a.withCtx)((()=>[(0,a.createElementVNode)("div",Le,[(0,a.createElementVNode)("span",null,(0,a.toDisplayString)(n.translate("pos.shipping.title")),1),(0,a.createElementVNode)("span",{class:"text-gray-500 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-200 cursor-pointer",onClick:t[0]||(t[0]=e=>n.closeModal())},[(0,a.createVNode)(l,{name:"close"})])])])),content:(0,a.withCtx)((()=>[(0,a.createElementVNode)("form",{onSubmit:t[5]||(t[5]=(0,a.withModifiers)((e=>n.submit()),["prevent"]))},[(0,a.createElementVNode)("div",qe,[(0,a.createElementVNode)("div",Fe,[(0,a.createElementVNode)("label",null,(0,a.toDisplayString)(n.translate("pos.shipping.country")),1),(0,a.createElementVNode)("div",We,(0,a.toDisplayString)(n.showError(e.errorBag,"countryId")),1)]),(0,a.withDirectives)((0,a.createElementVNode)("select",{onChange:t[1]||(t[1]=e=>n.updateCountryName()),class:"form-select w-full","onUpdate:modelValue":t[2]||(t[2]=t=>e.form.countryId=t)},[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(n.countries,((e,t)=>((0,a.openBlock)(),(0,a.createElementBlock)("option",{key:t,value:e.id},(0,a.toDisplayString)(e.name),9,Je)))),128))],544),[[a.vModelSelect,e.form.countryId]])]),(0,a.createElementVNode)("div",$e,[(0,a.createElementVNode)("div",ze,[(0,a.createElementVNode)("label",null,(0,a.toDisplayString)(n.translate("pos.shipping.shipping_method")),1),(0,a.createElementVNode)("div",Ye,(0,a.toDisplayString)(n.showError(e.errorBag,"shippingMethod")),1)]),(0,a.withDirectives)((0,a.createElementVNode)("input",{class:"form-input w-full",type:"text","onUpdate:modelValue":t[3]||(t[3]=t=>e.form.shippingMethod=t)},null,512),[[a.vModelText,e.form.shippingMethod]])]),(0,a.createElementVNode)("div",Qe,[(0,a.createElementVNode)("div",He,[(0,a.createElementVNode)("label",null,(0,a.toDisplayString)(n.translate("pos.shipping.shipping_cost")),1),(0,a.createElementVNode)("div",Ge,(0,a.toDisplayString)(n.showError(e.errorBag,"shippingCost")),1)]),(0,a.withDirectives)((0,a.createElementVNode)("input",{class:"form-input w-full",type:"text","onUpdate:modelValue":t[4]||(t[4]=t=>e.form.shippingCost=t)},null,512),[[a.vModelText,e.form.shippingCost]])]),(0,a.createElementVNode)("div",Xe,[(0,a.createVNode)(c,{disabled:e.isProcessing},{default:(0,a.withCtx)((()=>[e.isProcessing?((0,a.openBlock)(),(0,a.createElementBlock)("div",et,[(0,a.createVNode)(l,{name:"spinner",classes:"w-4 h-4 text-white"})])):(0,a.createCommentVNode)("",!0),(0,a.createElementVNode)("span",null,(0,a.toDisplayString)(n.translate("pos.shipping.btn_save")),1)])),_:1},8,["disabled"])])],32)])),_:1},8,["maxWidth","show"])}var ot={name:"SaveShippingMethodModal",components:{Modal:ye.Z,Icon:z.Z,JButton:$.Z},setup(){const e=(0,a.inject)("translate"),t=(0,a.inject)("emitter"),o=(0,a.inject)("toast"),n=(0,fe.oR)(),{showError:r,validate:s}=(0,ve.Z)(),{generateId:l}=(0,Ne.Z)(),c=(0,a.reactive)({show:!1,maxWidth:"2xl",closeable:!0,shippingMethod:null,form:{countryId:"",countryName:"",shippingCost:"",shippingMethod:""},errorBag:{},rules:{countryId:["required"],countryName:["required"],shippingCost:["required"],shippingMethod:["required"]},messages:{countryId:{required:"Please select country"},countryName:{required:"Please select country"},shippingCost:{required:"Please provide a shipping cost"},shippingMethod:{required:"Please provide a shipping method"}},isProcessing:!1}),i=(0,a.computed)((()=>n.state.countries)),d=(0,a.computed)((()=>n.state.shippingMethods));(0,a.watch)((()=>({...c.form})),((e,t)=>{Object.keys(c.errorBag).length>0&&(c.errorBag=s(e,c.rules,c.messages))}));const p=()=>{c.show=!1},u=()=>{const e=be.find(i.value,{id:Number(c.form.countryId)});e&&(c.form.countryName=e.name)},m=()=>{if(c.errorBag=s(c.form,c.rules,c.messages),0===Object.keys(c.errorBag).length){c.isProcessing=!0;const e=c.form,t=be.cloneDeep(d.value);if(c.shippingMethod){const o=be.findIndex(d.value,{id:c.shippingMethod.id});t[o]={id:t[o].id,...e}}else t.push({id:l(t,"id"),...e});n.dispatch(Ve.qJ,t).then((e=>{c.isProcessing=!1,o.success("Shipping options saved successfully"),p()})).catch((e=>{c.isProcessing=!1}))}};return(0,a.onBeforeMount)((()=>{t.on("saveShippingMethodModal",(e=>{c.shippingMethod=e.shippingMethod||null,c.form={countryId:c.shippingMethod?c.shippingMethod.countryId:"",countryName:c.shippingMethod?c.shippingMethod.countryName:"",shippingCost:c.shippingMethod?c.shippingMethod.shippingCost:"",shippingMethod:c.shippingMethod?c.shippingMethod.shippingMethod:""},c.show=!0}))})),{translate:e,...(0,a.toRefs)(c),countries:i,showError:r,closeModal:p,updateCountryName:u,submit:m}}};const at=(0,ke.Z)(ot,[["render",tt]]);var nt=at,rt={name:"ShippingMethods",components:{Icon:z.Z,JButton:$.Z,Pagination:Ue.Z,SaveShippingMethodModal:nt},setup(){const e=(0,a.inject)("translate"),t=(0,a.inject)("swal"),o=(0,a.inject)("toast"),n=(0,a.inject)("emitter"),r=(0,fe.oR)(),{formatPrice:s}=(0,Ne.Z)(),l=(0,a.reactive)({meta:{currentPage:1,totalPages:0,limit:25,offset:0}}),c=(0,a.computed)((()=>r.state.accountInfo)),i=(0,a.computed)((()=>r.state.altCoins)),d=(0,a.computed)((()=>r.state.shippingMethods)),p=(0,a.computed)((()=>{let e="EUR";if(c.value){e=c.value.PayoutCurrencyShortName;const t=be.find(i.value,{ShortName:c.value.PayoutCurrencyShortName});t&&(e=t.LongName)}return e})),u=(0,a.computed)((()=>d.value.length>0?d.value.slice(l.meta.offset,l.meta.currentPage*l.meta.limit):d.value)),m=e=>{l.meta={...l.meta,currentPage:e,offset:(e-1)*l.meta.limit}},g=e=>{t.fire({title:"Delivery Option",text:"Are you sure, want to delete this delivery option?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"Yes",cancelButtonText:"No",focusCancel:!0,customClass:{container:"swal2-tailwind"}}).then((({value:t})=>{if(t&&!0===t){const t=be.cloneDeep(d.value);t.splice(e,1),r.dispatch(Ve.qJ,t).then((e=>{o.success("Shipping options deleted successfully")})).catch((e=>{o.warning("Internal Server Error")}))}}))},h=(e=null)=>{n.emit("saveShippingMethodModal",{shippingMethod:e})};return(0,a.onBeforeMount)((()=>{r.dispatch(Ve.fv)})),{translate:e,...(0,a.toRefs)(l),currency:p,shippingMethods:d,paginatedShippingMethods:u,formatPrice:s,updatePage:m,deleteShippingMethod:g,launchSaveShippingMethodModal:h}}};const st=(0,ke.Z)(rt,[["render",Oe],["__scopeId","data-v-80a5e5b0"]]);var lt=st,ct=o(381),it=o(9669),dt=o.n(it),pt={name:"Office",components:{"pos-layout":J.Z,Icon:z.Z,JButton:$.Z,Coupons:Se,ShippingMethods:lt},setup(){const e=(0,a.inject)("translate"),t=(0,a.inject)("toast"),o=(0,a.inject)("http"),n=(0,a.inject)("swal"),r=(0,fe.oR)(),{saveNotification:s,generateId:l}=(0,Ne.Z)(),c=(0,a.reactive)({form:{url:""},siteUrl:window.location.protocol+"//"+window.location.host,isProcessing:!1,isPosEnabled:!1}),i=(0,a.computed)((()=>r.state.shippingMethods)),d=(0,a.computed)((()=>r.state.pos)),p=(0,a.computed)((()=>r.state.posCalls)),u=(0,a.computed)((()=>r.state.user)),m=(0,a.computed)((()=>d.value.products)),g=(0,a.computed)((()=>0===i.value.length&&!0===c.isPosEnabled)),h=(0,a.computed)((()=>'<iframe src="https://cointopay.com/shop/17170" frameborder="0" height="550" name="Framename" scrolling="yes" style="width: 100%;" width="550"></iframe>')),y="https://app.cointopay.com",v=e=>{c.isProcessing=!0;const o=e.target.files[0];if(o&&be.endsWith(o.name,".csv")){const e=new FileReader;e.readAsText(o,"UTF-8"),e.onload=e=>{const o=e.target.result,a=o.split(/\r\n|\n/);let n=[],l=null;if(a.map((e=>{const t=e.split(",");if(t.length>1){if("categories"===l.toLowerCase())n.push({id:t[0],name:t[1],categoryColourCode:t[2]});else if(n){n=JSON.parse(JSON.stringify(n));const e=be.findIndex(n,{id:t[2]});"undefined"===typeof n[e].products&&(n[e].products=[]),n[e].products.push({id:t[0],itemName:t[1],categoryID:t[2],description:t[3],stock:t[4],sku:t[5],price:t[6],imageUri:t[7]})}}else{const e=t[0].toLowerCase();"products"!==e&&"categories"!==e||(l=t[0])}})),n.length>0){const e=be.cloneDeep(d.value.categories),o=be.cloneDeep(d.value.products);n.map((t=>{const a=be.findIndex(e,{id:t.id}),n={id:t.id,name:t.name,categoryColourCode:t.categoryColourCode};-1===a?e.push(n):e.splice(a,1,n),t.products&&t.products.length>0&&t.products.map((e=>{const t=be.findIndex(o,{sku:e.sku});-1===t?o.push(e):o.splice(t,1,e)}))})),r.dispatch(Ve.gB,{call:p.value.categories,data:e}),r.dispatch(Ve.Rb,{call:p.value.products,data:o}),c.isProcessing=!1,t.success("Products imported successfully!"),s("Products imported successfully!")}else c.isProcessing=!1,t.error("Please provide a valid csv file"),s("Please provide a valid csv file")},e.onerror=e=>{c.isProcessing=!1,console.log(e)}}else c.isProcessing=!1,t.error("Please provide a valid csv file"),s("Please provide a valid csv file")},f=()=>{const e=ct().format("DD-MM-YYYY_H_m_A")+"_Cointopay_"+u.value.ID+"_catalog_export.csv",t=[];d.value.categories.length>0&&(t.push(["Categories"]),d.value.categories.forEach((e=>{t.push([e.id,e.name,e.categoryColourCode])}))),d.value.products.length>0&&(t.push(["Products"]),d.value.products.forEach((e=>{t.push([e.id,e.itemName,e.categoryID,e.description,e.stock,e.sku,e.price,e.imageUri])})));const o="data:text/csv;charset=utf-8,"+t.map((e=>e.join(","))).join("\n"),a=encodeURI(o),n=document.createElement("a");n.setAttribute("href",a),n.setAttribute("download",e),document.body.appendChild(n),n.click()},b=()=>{const e=c.form.url;e&&(c.isProcessing=!0,dt().get(`${e}`).then((e=>{const o=e.data.products,a=be.cloneDeep(d.value.categories),n=be.find(a,{name:"Shopify"});let i=null,p=be.cloneDeep(d.value.products);n?i=n.id:(i=l(a),a.push({id:i,name:"Shopify",categoryColourCode:Math.floor(16777215*Math.random()).toString(16)}),r.dispatch(Ve.gB,{call:"UPDATE",data:a}));const u=[];o.map((e=>{e.variants&&e.variants.map((t=>{const o=e.images[0];u.push({id:t.id.toString(),categoryID:i,itemName:e.title,description:"",sku:t.sku,price:t.price,stock:"9999999",imageUri:o?o.src:""})}))})),p.length>0?u.map((e=>{const t=be.findIndex(p,{sku:e.sku});-1!==t?p[t]=e:p.push(e)})):p=u,r.dispatch(Ve.Rb,{call:"UPDATE",data:p}).then((e=>{c.isProcessing=!1,c.form.url="",t.success("Products imported successfully!"),s("Products imported successfully!")})).catch((e=>{c.isProcessing=!1,"update failed"===e.toLowerCase()&&(t.warning("Import failed due to unsupported encoding"),s("Import failed due to unsupported encoding"))}))}),(e=>{c.isProcessing=!1,console.log(e)})))},N=e=>{const t=e.match(/(http(s)?):\/\/[^.\s]+(.myshopify)?\.com\/products.json/);return null!==t},V=()=>{n.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!",customClass:{container:"swal2-tailwind"}}).then((e=>{e.value&&(r.dispatch(Ve.Rb,{call:p.value.products,data:[]}),t.success("Products deleted successfully"),s("Products deleted successfully"))}))},E=e=>{const a={Call:"SHOWPOS",MerchantID:u.value.ID,APIKey:u.value.APIKey,showpos:e,output:"json"};o.get(`${y}/v2REAPI`,{params:a}).then((o=>{200===o.data.status_code?(t.success(1===e?"POS enabled successfully":"POS disabled successfully"),c.isPosEnabled=1===e):(t.warning(o.data.message),s(o.data.message))})).catch((e=>{t.warning(e.message),s(e.message)}))};return(0,a.onBeforeMount)((()=>{r.dispatch(Ve.d7,{shopId:u.value.ID}).then((e=>{"nothing found"!==e.categories&&(c.isPosEnabled=!0)})).catch((e=>{console.log(e)})),r.dispatch(Ve.fv)})),{translate:e,...(0,a.toRefs)(c),isValidShopifyURL:N,user:u,importFromCSV:v,exportToCSV:f,importFromShopify:b,deleteAllProducts:V,products:m,showShippingWarning:g,togglePOS:E,iframe:h}}};const ut=(0,ke.Z)(pt,[["render",W]]);var mt=ut}}]);
//# sourceMappingURL=account-pos-office.009b99ec.js.map